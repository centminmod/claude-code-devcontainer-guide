<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Claude Code DevContainers - Complete Setup Guide</title>

    <!-- Tailwind CSS for utility classes (sidebar, overlay, responsive layout) -->
    <script src="https://cdn.tailwindcss.com"></script>

    <style>
        /* ===================================
           Design Tokens (CSS Custom Properties)
           =================================== */
        :root {
            /* Color Palette - Material Design 3 Inspired */
            --color-primary: #6366f1;
            --color-primary-light: #818cf8;
            --color-primary-dark: #4f46e5;
            --color-secondary: #8b5cf6;
            --color-accent: #06b6d4;

            /* Semantic Colors */
            --color-success: #10b981;
            --color-warning: #f59e0b;
            --color-error: #ef4444;
            --color-info: #3b82f6;

            /* Neutral Palette */
            --color-bg: #ffffff;
            --color-surface: #f9fafb;
            --color-surface-hover: #f3f4f6;
            --color-border: #e5e7eb;
            --color-text: #111827;
            --color-text-muted: #6b7280;
            --color-text-light: #9ca3af;

            /* Code Colors - Tokyo Night Dark Theme */
            --color-code-bg: #1a1b26;
            --color-code-text: #a9b1d6;
            --color-code-comment: #565f89;
            --color-code-warning: #e0af68;

            /* Spacing Scale */
            --space-xs: 0.25rem;
            --space-sm: 0.5rem;
            --space-md: 1rem;
            --space-lg: 1.5rem;
            --space-xl: 2rem;
            --space-2xl: 3rem;
            --space-3xl: 4rem;

            /* Typography Scale */
            --font-sans: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            --font-mono: "SF Mono", Monaco, "Cascadia Code", "Roboto Mono", Consolas, "Courier New", monospace;

            --text-xs: 0.75rem;
            --text-sm: 0.875rem;
            --text-base: 1rem;
            --text-lg: 1.125rem;
            --text-xl: 1.25rem;
            --text-2xl: 1.5rem;
            --text-3xl: 1.875rem;
            --text-4xl: 2.25rem;

            /* Shadows */
            --shadow-sm: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
            --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
            --shadow-xl: 0 20px 25px -5px rgba(0, 0, 0, 0.1);

            /* Border Radius */
            --radius-sm: 0.25rem;
            --radius-md: 0.5rem;
            --radius-lg: 0.75rem;
            --radius-xl: 1rem;

            /* Transitions */
            --transition-fast: 150ms ease;
            --transition-base: 250ms ease;
            --transition-slow: 350ms ease;
        }

        /* Dark Mode */
        @media (prefers-color-scheme: dark) {
            :root {
                --color-bg: #0f172a;
                --color-surface: #1e293b;
                --color-surface-hover: #334155;
                --color-border: #334155;
                --color-text: #f1f5f9;
                --color-text-muted: #cbd5e1;
                --color-text-light: #94a3b8;
            }
        }

        /* Manual Dark Mode Toggle (overrides system preference) */
        .dark {
            --color-bg: #0f172a;
            --color-surface: #1e293b;
            --color-surface-hover: #334155;
            --color-border: #334155;
            --color-text: #f1f5f9;
            --color-text-muted: #cbd5e1;
            --color-text-light: #94a3b8;
        }

        /* ===================================
           Base Styles
           =================================== */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html {
            scroll-behavior: smooth;
            scroll-padding-top: 12rem; /* 192px - accounts for sticky header height + breathing room */
            overflow-x: hidden;
        }

        body {
            font-family: var(--font-sans);
            font-size: var(--text-base);
            line-height: 1.6;
            color: var(--color-text);
            background-color: var(--color-bg);
            overflow-x: hidden;
        }

        /* ===================================
           Typography
           =================================== */
        h1, h2, h3, h4, h5, h6 {
            font-weight: 700;
            line-height: 1.2;
            margin-bottom: var(--space-md);
        }

        h1 { font-size: var(--text-4xl); }
        h2 { font-size: var(--text-3xl); }
        h3 { font-size: var(--text-2xl); }
        h4 { font-size: var(--text-xl); }
        h5 { font-size: var(--text-lg); }
        h6 { font-size: var(--text-base); }

        p {
            margin-bottom: var(--space-md);
        }

        a {
            color: var(--color-primary);
            text-decoration: none;
            transition: color var(--transition-fast);
        }

        a:hover {
            color: var(--color-primary-dark);
            text-decoration: underline;
        }

        code {
            font-family: var(--font-mono);
            font-size: 0.9em;
            background-color: var(--color-surface);
            padding: 0.125rem 0.375rem;
            border-radius: var(--radius-sm);
        }

        pre {
            font-family: var(--font-mono);
            font-size: var(--text-sm);
            background-color: var(--color-code-bg);
            color: var(--color-code-text);
            padding: var(--space-lg);
            border-radius: var(--radius-lg);
            overflow-x: auto;
            max-width: 100%;
            width: 100%;
            box-sizing: border-box;
            margin-bottom: var(--space-lg);
        }

        pre code {
            background-color: transparent;
            padding: 0;
            color: inherit;
            display: block;
            max-width: 100%;
            overflow-x: auto;
        }

        /* ===================================
           Layout Components
           =================================== */
        .header {
            background: linear-gradient(135deg, var(--color-primary) 0%, var(--color-secondary) 100%);
            color: white;
            padding: var(--space-2xl) var(--space-lg);
            text-align: center;
            position: sticky;
            top: 0;
            z-index: 100;
            box-shadow: var(--shadow-lg);
        }

        .header h1 {
            margin: 0;
            font-size: var(--text-3xl);
        }

        .header p {
            margin: var(--space-sm) 0 0 0;
            opacity: 0.95;
            font-size: var(--text-lg);
        }

        /* Horizontal nav removed - using vertical sidebar instead */

        .container {
            max-width: 1280px;
            margin: 0 auto;
            padding: var(--space-xl) var(--space-lg);
        }

        main {
            max-width: 900px;
        }

        .section {
            margin-bottom: var(--space-3xl);
            scroll-margin-top: 12rem; /* Match scroll-padding-top for consistent anchor positioning */
        }

        /* ===================================
           Component: Card
           =================================== */
        .card {
            background-color: var(--color-surface);
            border: 1px solid var(--color-border);
            border-radius: var(--radius-lg);
            padding: var(--space-xl);
            margin-bottom: var(--space-lg);
            transition: all var(--transition-base);
        }

        .card:hover {
            box-shadow: var(--shadow-md);
            transform: translateY(-2px);
        }

        .card-header {
            display: flex;
            align-items: center;
            gap: var(--space-md);
            margin-bottom: var(--space-lg);
            border-bottom: 2px solid var(--color-border);
            padding-bottom: var(--space-md);
        }

        .card-icon {
            font-size: var(--text-3xl);
        }

        .card-title {
            font-size: var(--text-2xl);
            margin: 0;
            flex: 1;
        }

        .card-body {
            color: var(--color-text);
        }

        /* ===================================
           Component: Badge
           =================================== */
        .badge {
            display: inline-block;
            padding: var(--space-xs) var(--space-md);
            border-radius: var(--radius-xl);
            font-size: var(--text-xs);
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        .badge-beginner {
            background-color: #d1fae5;
            color: #065f46;
        }

        .badge-intermediate {
            background-color: #dbeafe;
            color: #1e40af;
        }

        .badge-advanced {
            background-color: #fce7f3;
            color: #9f1239;
        }

        @media (prefers-color-scheme: dark) {
            .badge-beginner {
                background-color: #064e3b;
                color: #6ee7b7;
            }
            .badge-intermediate {
                background-color: #1e3a8a;
                color: #93c5fd;
            }
            .badge-advanced {
                background-color: #831843;
                color: #fbcfe8;
            }
        }

        /* ===================================
           Component: Callout (Alert)
           =================================== */
        .callout {
            padding: var(--space-lg);
            border-radius: var(--radius-lg);
            border-left: 4px solid;
            margin-bottom: var(--space-lg);
        }

        .callout-icon {
            display: inline-block;
            margin-right: var(--space-sm);
            font-size: var(--text-xl);
        }

        .callout-info {
            background-color: #dbeafe;
            border-color: var(--color-info);
            color: #1e3a8a;
        }

        .callout-success {
            background-color: #d1fae5;
            border-color: var(--color-success);
            color: #065f46;
        }

        .callout-warning {
            background-color: #fef3c7;
            border-color: var(--color-warning);
            color: #92400e;
        }

        .callout-error {
            background-color: #fee2e2;
            border-color: var(--color-error);
            color: #991b1b;
        }

        @media (prefers-color-scheme: dark) {
            .callout-info {
                background-color: #1e3a8a;
                color: #bfdbfe;
            }
            .callout-success {
                background-color: #065f46;
                color: #a7f3d0;
            }
            .callout-warning {
                background-color: #92400e;
                color: #fde68a;
            }
            .callout-error {
                background-color: #991b1b;
                color: #fecaca;
            }
        }

        /* ===================================
           Component: Code Block
           =================================== */
        .code-block {
            position: relative;
            margin-bottom: var(--space-lg);
            max-width: 100%;
            overflow: hidden;
        }

        .code-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background-color: var(--color-code-bg);
            color: var(--color-code-text);
            padding: var(--space-sm) var(--space-lg);
            border-radius: var(--radius-lg) var(--radius-lg) 0 0;
            font-family: var(--font-mono);
            font-size: var(--text-sm);
        }

        .code-filename {
            color: var(--color-accent);
            font-weight: 600;
        }

        .copy-btn {
            background-color: transparent;
            border: 1px solid var(--color-border);
            color: var(--color-code-text);
            padding: var(--space-xs) var(--space-md);
            border-radius: var(--radius-sm);
            cursor: pointer;
            font-size: var(--text-xs);
            transition: all var(--transition-fast);
        }

        .copy-btn:hover {
            background-color: var(--color-primary);
            border-color: var(--color-primary);
        }

        .copy-btn.copied {
            background-color: var(--color-success);
            border-color: var(--color-success);
            color: white;
        }

        .code-block pre,
        .code-block.has-header pre {
            margin: 0;
            border-radius: 0 0 var(--radius-lg) var(--radius-lg);
        }

        /* ===================================
           Component: Details/Summary (Progressive Disclosure)
           =================================== */
        details {
            background-color: var(--color-surface);
            border: 1px solid var(--color-border);
            border-radius: var(--radius-lg);
            padding: var(--space-lg);
            margin-bottom: var(--space-lg);
        }

        details[open] {
            background-color: var(--color-bg);
        }

        summary {
            cursor: pointer;
            font-weight: 600;
            font-size: var(--text-lg);
            color: var(--color-primary);
            list-style: none;
            display: flex;
            align-items: center;
            gap: var(--space-sm);
            transition: color var(--transition-fast);
        }

        summary:hover {
            color: var(--color-primary-dark);
        }

        summary::before {
            content: "‚ñ∂";
            display: inline-block;
            transition: transform var(--transition-base);
        }

        details[open] summary::before {
            transform: rotate(90deg);
        }

        details[open] summary {
            margin-bottom: var(--space-lg);
            padding-bottom: var(--space-md);
            border-bottom: 2px solid var(--color-border);
        }

        /* ===================================
           Component: TL;DR
           =================================== */
        .tldr {
            background: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%);
            border-left: 4px solid var(--color-primary);
            padding: var(--space-lg);
            border-radius: var(--radius-lg);
            margin-bottom: var(--space-xl);
        }

        @media (prefers-color-scheme: dark) {
            .tldr {
                background: linear-gradient(135deg, #0c4a6e 0%, #075985 100%);
            }
        }

        .tldr-header {
            display: flex;
            align-items: center;
            gap: var(--space-sm);
            font-weight: 700;
            font-size: var(--text-xl);
            margin-bottom: var(--space-md);
            color: var(--color-primary-dark);
        }

        .tldr-list {
            list-style: none;
            padding-left: 0;
        }

        .tldr-list li {
            padding-left: var(--space-lg);
            position: relative;
            margin-bottom: var(--space-sm);
        }

        .tldr-list li::before {
            content: "‚úì";
            position: absolute;
            left: 0;
            color: var(--color-success);
            font-weight: bold;
        }

        /* ===================================
           Component: Grid
           =================================== */
        .grid {
            display: grid;
            gap: var(--space-lg);
        }

        .grid-2 {
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
        }

        .grid-3 {
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        }

        /* ===================================
           Component: Table
           =================================== */
        .table-wrapper {
            overflow-x: auto;
            margin-bottom: var(--space-lg);
        }

        table {
            width: 100%;
            border-collapse: collapse;
            background-color: var(--color-surface);
            border-radius: var(--radius-lg);
            overflow: hidden;
        }

        th, td {
            padding: var(--space-md);
            text-align: left;
            border-bottom: 1px solid var(--color-border);
        }

        th {
            background-color: var(--color-primary);
            color: white;
            font-weight: 600;
        }

        tr:last-child td {
            border-bottom: none;
        }

        tr:hover {
            background-color: var(--color-surface-hover);
        }

        /* ===================================
           Utility Classes
           =================================== */
        .text-center { text-align: center; }
        .text-muted { color: var(--color-text-muted); }
        .mb-lg { margin-bottom: var(--space-lg); }
        .mb-xl { margin-bottom: var(--space-xl); }
        .mt-lg { margin-top: var(--space-lg); }
        .flex { display: flex; }
        .items-center { align-items: center; }
        .gap-md { gap: var(--space-md); }

        /* ===================================
           Footer
           =================================== */
        .footer {
            background-color: var(--color-surface);
            border-top: 1px solid var(--color-border);
            padding: var(--space-xl) var(--space-lg);
            text-align: center;
            color: var(--color-text-muted);
        }

        /* ===================================
           Responsive Design
           =================================== */
        @media (max-width: 768px) {
            .header h1 {
                font-size: var(--text-2xl);
            }

            .container {
                padding: var(--space-lg) var(--space-md);
            }

            .card {
                padding: var(--space-lg);
            }
        }

        /* ===================================
           Accessibility: Skip Links
           =================================== */
        #skip-to-content {
            position: absolute;
            top: -100px;
            left: 0;
            background: #6366f1;
            color: white;
            padding: 0.5rem 1rem;
            text-decoration: none;
            z-index: 100;
            border-radius: 0.25rem;
        }

        #skip-to-content:focus {
            top: 0;
        }

        /* ===================================
           Accessibility: Focus States
           =================================== */
        button:focus-visible,
        a:focus-visible {
            outline: 2px solid var(--color-primary);
            outline-offset: 2px;
            border-radius: var(--radius-sm);
        }

        .copy-btn:focus {
            outline: 2px solid var(--color-primary);
            outline-offset: 2px;
        }

        .toc-link:focus-visible {
            outline: 2px solid var(--color-primary);
            outline-offset: 2px;
        }

        /* ===================================
           Print Styles
           =================================== */
        @media print {
            /* Hide interactive elements for print */
            #scrollProgress,
            #backToTop,
            #mobileMenuToggle,
            #tocSidebar,
            #tocOverlay,
            #skip-to-content,
            .copy-btn {
                display: none !important;
            }

            /* Ensure main content displays properly */
            body,
            body > div,
            main {
                display: block !important;
                position: relative !important;
            }

            /* Force print-friendly colors */
            body {
                background: white !important;
                color: black !important;
            }

            /* Simplify header for print */
            .header {
                background: white !important;
                color: black !important;
                position: static !important;
                box-shadow: none !important;
                border-bottom: 2px solid black;
            }

            /* Remove decorative backgrounds from components */
            .tldr,
            .callout,
            .card {
                background: white !important;
                border: 1px solid black !important;
                box-shadow: none !important;
                page-break-inside: avoid;
            }

            /* Expand all collapsible sections for print */
            details {
                display: block !important;
            }

            details summary {
                display: block !important;
                font-weight: bold;
                margin-bottom: 0.5rem;
            }

            details summary::before {
                display: none !important;
            }

            details[open] summary {
                border-bottom: none !important;
                padding-bottom: 0 !important;
            }

            /* Code blocks - maintain readability */
            pre,
            pre code {
                background: #f5f5f5 !important;
                color: #333 !important;
                border: 1px solid #ccc !important;
                page-break-inside: avoid;
                white-space: pre-wrap !important;
                word-wrap: break-word !important;
            }

            .code-header {
                background: #e0e0e0 !important;
                color: black !important;
                border-bottom: 1px solid #ccc !important;
            }

            /* Tables - optimize for print */
            table {
                page-break-inside: avoid;
                border-collapse: collapse;
            }

            th {
                background: #f0f0f0 !important;
                color: black !important;
                border: 1px solid black !important;
            }

            td {
                border: 1px solid black !important;
            }

            /* Show URLs for external links */
            a[href^="http"]:after {
                content: " (" attr(href) ")";
                font-size: 0.8em;
                color: #666;
                word-wrap: break-word;
            }

            /* Optimize page breaks */
            h2, h3, h4, h5, h6 {
                page-break-after: avoid;
                page-break-inside: avoid;
            }

            .section {
                page-break-inside: avoid;
            }

            /* Remove hover effects */
            .card:hover,
            tr:hover {
                transform: none !important;
                background: white !important;
            }

            /* Footer */
            .footer {
                background: white !important;
                border-top: 2px solid black !important;
            }

            /* Simplify layout for print */
            main {
                max-width: 100% !important;
                margin: 0 !important;
                padding: 0 !important;
            }

            .container {
                padding: 0 !important;
                max-width: 100% !important;
            }
        }
    </style>
</head>
<body>
    <a href="#main" id="skip-to-content">Skip to main content</a>

    <!-- Header -->
    <header class="header">
        <!-- Mobile Menu Toggle Button -->
        <button
            id="mobileMenuToggle"
            class="md:hidden absolute left-4 top-1/2 -translate-y-1/2 p-2 rounded-lg bg-white/20 hover:bg-white/30 transition-colors"
            aria-label="Toggle navigation menu"
            aria-expanded="false"
            style="z-index: 10;"
        >
            <svg
                class="w-6 h-6 text-white"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
                aria-hidden="true"
            >
                <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="2"
                    d="M4 6h16M4 12h16M4 18h16"
                />
            </svg>
        </button>

        <h1>üöÄ Claude Code DevContainers</h1>
        <p>Complete setup guide for professional AI-assisted development environments</p>

        <!-- Scroll Progress Bar -->
        <div id="scrollProgress" style="position: absolute; bottom: 0; left: 0; height: 3px; background: linear-gradient(90deg, var(--color-accent), var(--color-primary)); width: 0%; transition: width 0.1s ease;"></div>
    </header>

    <!-- Mobile TOC Overlay -->
    <div
      id="tocOverlay"
      class="fixed inset-0 z-40 bg-black/30 opacity-0 pointer-events-none transition-opacity duration-300 lg:hidden"
      aria-hidden="true"
    ></div>

    <!-- Main Container -->
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
      <div class="flex flex-col md:flex-row gap-8">
        <!-- Table of Contents Sidebar -->
        <aside
          id="tocSidebar"
          class="fixed inset-y-0 left-0 z-50 w-72 md:w-64 bg-white dark:bg-gray-800 border-r border-gray-200 dark:border-gray-700 p-6 transform -translate-x-full transition-transform duration-300 md:sticky md:top-24 md:translate-x-0 md:block flex-shrink-0 overflow-y-auto"
          style="max-height: calc(100vh - 96px);"
        >
          <nav
            class="rounded-lg"
            aria-label="Table of contents"
          >
            <h2
              class="font-semibold text-sm uppercase tracking-wider text-gray-500 dark:text-gray-400 mb-4"
            >
              Table of Contents
            </h2>
            <ul class="space-y-2 text-sm">
              <li>
                <a
                  href="#introduction"
                  class="toc-link block py-1 px-2 rounded hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors"
                  >Introduction</a
                >
              </li>
              <li>
                <a
                  href="#quick-start"
                  class="toc-link block py-1 px-2 rounded hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors"
                  >Quick Start</a
                >
              </li>
              <li>
                <a
                  href="#what-are-devcontainers"
                  class="toc-link block py-1 px-2 rounded hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors"
                  >What Are Dev Containers?</a
                >
              </li>
              <li>
                <a
                  href="#why-use-devcontainers"
                  class="toc-link block py-1 px-2 rounded hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors"
                  >Why Use Them?</a
                >
              </li>
              <li>
                <a
                  href="#when-not-to-use"
                  class="toc-link block py-1 px-2 rounded hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors"
                  >When NOT to Use</a
                >
              </li>
              <li>
                <a
                  href="#prerequisites"
                  class="toc-link block py-1 px-2 rounded hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors"
                  >Prerequisites</a
                >
              </li>
              <li>
                <a
                  href="#architecture"
                  class="toc-link block py-1 px-2 rounded hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors"
                  >Architecture</a
                >
              </li>
              <li>
                <a
                  href="#security-firewall"
                  class="toc-link block py-1 px-2 rounded hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors"
                  >Security & Firewall</a
                >
              </li>
              <li>
                <a
                  href="#git-safety"
                  class="toc-link block py-1 px-2 rounded hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors"
                  >Git Safety & Branch Protection</a
                >
              </li>
              <li>
                <a
                  href="#init-scripts"
                  class="toc-link block py-1 px-2 rounded hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors"
                  >Init Scripts</a
                >
              </li>
              <li>
                <a
                  href="#session-start-hook"
                  class="toc-link block py-1 px-2 rounded hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors"
                  >Session Start Hook</a
                >
              </li>
              <li>
                <a
                  href="#claude-config"
                  class="toc-link block py-1 px-2 rounded hover:bg-gray-100 dark:border-gray-700 transition-colors"
                  >Claude Code Configuration & MCP</a
                >
              </li>
              <li>
                <a
                  href="#templates"
                  class="toc-link block py-1 px-2 rounded hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors"
                  >Configuration Templates</a
                >
              </li>
              <li>
                <a
                  href="#examples"
                  class="toc-link block py-1 px-2 rounded hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors"
                  >Example Configurations</a
                >
              </li>
              <li>
                <a
                  href="#multi-ai-collaboration"
                  class="toc-link block py-1 px-2 rounded hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors"
                  >Multi-AI Collaboration</a
                >
              </li>
              <li>
                <a
                  href="#react-example"
                  class="toc-link block py-1 px-2 rounded hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors"
                  >React Project Setup</a
                >
              </li>
              <li>
                <a
                  href="#nextjs-example"
                  class="toc-link block py-1 px-2 rounded hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors"
                  >Next.js with MCP</a
                >
              </li>
              <li>
                <a
                  href="#python-basic-example"
                  class="toc-link block py-1 px-2 rounded hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors"
                  >Basic Python Setup</a
                >
              </li>
              <li>
                <a
                  href="#python-advanced-example"
                  class="toc-link block py-1 px-2 rounded hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors"
                  >Advanced Python Setup</a
                >
              </li>
              <li>
                <a
                  href="#launching-container"
                  class="toc-link block py-1 px-2 rounded hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors"
                  >Launching Your Dev Container</a
                >
              </li>
              <li>
                <a
                  href="#ai-cli-auth"
                  class="toc-link block py-1 px-2 rounded hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors"
                  >AI CLI Authentication</a
                >
              </li>
              <li>
                <a
                  href="#github-cli-auth"
                  class="toc-link block py-1 px-2 rounded hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors"
                  >GitHub CLI Authentication</a
                >
              </li>
              <li>
                <a
                  href="#troubleshooting"
                  class="toc-link block py-1 px-2 rounded hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors"
                  >Troubleshooting</a
                >
              </li>
              <li>
                <a
                  href="#resources"
                  class="toc-link block py-1 px-2 rounded hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors"
                  >Resources</a
                >
              </li>
            </ul>
          </nav>
        </aside>

        <!-- Main Content -->
        <main class="flex-1 max-w-4xl" id="main">

        <!-- Introduction Section (RESTORED) -->
        <section id="introduction" class="section">
            <h2>üëã Welcome!</h2>

            <p>This guide will teach you everything you need to know about development containers (devcontainers) for Claude Code. Whether you're a complete beginner or looking to refine your setup, you're in the right place. The guide was created from all my own experiences and collected context documentation used to create my own dev containers and will be continually updated as my development and experience progresses. If you like this guide and find it useful, consider <a href="https://www.buymeacoffee.com/georgeliu" target="_blank" rel="noopener noreferrer">buying me a coffee</a> to support my work.</p>

            <div class="callout callout-info">
                <div class="callout-header">
                    <span class="callout-icon">üìö</span>
                    <span>What You'll Learn</span>
                </div>
                <ul style="margin-top: 0.5rem;">
                    <li>What dev containers are and how they work</li>
                    <li>Setting up a React project with dev containers</li>
                    <li>Setting up a Python project with dev containers</li>
                    <li>Setting up a Next.js application with dev containers</li>
                    <li>Configuring multiple AI assistants in one container</li>
                    <li>Troubleshooting common issues</li>
                </ul>
            </div>

            <div class="callout callout-success">
                <div class="callout-header">
                    <span class="callout-icon">üí°</span>
                    <span>Pro Tip for AI Users</span>
                </div>
                <p>You can provide <a href="https://claude-devcontainers.centminmod.com/llms.txt" target="_blank" rel="noopener noreferrer">this comprehensive llms.txt guide</a> to AI assistants like Claude to help with dev container creation and usage. It contains detailed examples and best practices!</p>
            </div>
        </section>

        <!-- Quick Start Section -->
        <section id="quick-start" class="section">
            <h2>‚ö° Quick Start</h2>

            <div class="tldr">
                <div class="tldr-header">
                    <span>üìã</span>
                    <span>TL;DR - Get Started in 5 Minutes</span>
                </div>
                <ul class="tldr-list">
                    <li>Install Docker Desktop and VS Code</li>
                    <li>Add the Dev Containers extension to VS Code</li>
                    <li>Clone this repository and open it in VS Code</li>
                    <li>Click "Reopen in Container" when prompted</li>
                    <li>Wait for the container to build (first time takes 5-10 minutes)</li>
                    <li>Start coding with Claude Code already configured!</li>
                </ul>
            </div>

            <div class="card">
                <div class="card-header">
                    <span class="card-icon">üéØ</span>
                    <h3 class="card-title">30-Second Setup</h3>
                    <span class="badge badge-beginner">üå± Beginner</span>
                </div>
                <div class="card-body">
                    <p>Follow these steps to get your development environment running:</p>

                    <div class="code-block has-header">
                        <div class="code-header">
                            <span class="code-filename">terminal</span>
                            <button class="copy-btn" onclick="copyCode(this)" aria-label="Copy code">Copy</button>
                        </div>
                        <pre><code># 1. Clone the repository
git clone https://github.com/YOUR_USERNAME/claude-devcontainer.git
cd claude-devcontainer

# 2. Open in VS Code
code .

# 3. Press F1 and select: "Dev Containers: Reopen in Container"
# That's it! The container will build automatically.</code></pre>
                    </div>

                    <div class="callout callout-info">
                        <span class="callout-icon">üí°</span>
                        <strong>First-time build:</strong> The initial container build takes 5-10 minutes as it downloads and configures all tools. Subsequent startups take less than 30 seconds.
                    </div>
                </div>
            </div>

            <div class="card">
                <div class="card-header">
                    <span class="card-icon">‚úÖ</span>
                    <h3 class="card-title">Verify Your Setup</h3>
                </div>
                <div class="card-body">
                    <p>After the container builds, verify everything works:</p>

                    <div class="code-block has-header">
                        <div class="code-header">
                            <span class="code-filename">terminal</span>
                            <button class="copy-btn" onclick="copyCode(this)" aria-label="Copy code">Copy</button>
                        </div>
                        <pre><code># Check Claude Code version
claude --version

# Check Docker
docker --version

# Check Git
git --version

# Test Claude Code
claude "Hello! Can you confirm you're running?"</code></pre>
                    </div>

                    <div class="callout callout-success">
                        <span class="callout-icon">üéâ</span>
                        <strong>Success!</strong> If all commands work, you're ready to start developing with Claude Code.
                    </div>
                </div>
            </div>
        </section>

        <!-- What Are DevContainers Section -->
        <section id="what-are-devcontainers" class="section">
            <h2>üì¶ What Are DevContainers?</h2>

            <div class="tldr">
                <div class="tldr-header">
                    <span>üìã</span>
                    <span>TL;DR</span>
                </div>
                <ul class="tldr-list">
                    <li>Containerized development environments that run inside Docker</li>
                    <li>Ensure consistent setup across all team members</li>
                    <li>Include all tools, dependencies, and configurations pre-installed</li>
                    <li>Eliminate "works on my machine" problems</li>
                    <li>Integrate seamlessly with VS Code</li>
                </ul>
            </div>

            <div class="card">
                <div class="card-header">
                    <span class="card-icon">ü§î</span>
                    <h3 class="card-title">The Problem DevContainers Solve</h3>
                </div>
                <div class="card-body">
                    <p>Traditional development environments create several challenges:</p>

                    <ul>
                        <li><strong>Inconsistent setups:</strong> Each developer has different tool versions and configurations</li>
                        <li><strong>Time-consuming onboarding:</strong> New team members spend hours or days setting up their environment</li>
                        <li><strong>Conflicts:</strong> Multiple projects require different versions of the same tools</li>
                        <li><strong>Documentation drift:</strong> Setup instructions become outdated as tools evolve</li>
                    </ul>

                    <div class="callout callout-warning">
                        <span class="callout-icon">‚ö†Ô∏è</span>
                        Without DevContainers, you might spend more time configuring your environment than actually coding.
                    </div>
                </div>
            </div>

            <div class="card">
                <div class="card-header">
                    <span class="card-icon">‚ú®</span>
                    <h3 class="card-title">How DevContainers Work</h3>
                </div>
                <div class="card-body">
                    <p>DevContainers package your entire development environment into a Docker container:</p>

                    <div class="grid grid-3">
                        <div class="card">
                            <h4>1Ô∏è‚É£ Define</h4>
                            <p>Specify your environment in <code>devcontainer.json</code> and <code>Dockerfile</code></p>
                        </div>
                        <div class="card">
                            <h4>2Ô∏è‚É£ Build</h4>
                            <p>VS Code builds a Docker container with all your tools pre-installed</p>
                        </div>
                        <div class="card">
                            <h4>3Ô∏è‚É£ Develop</h4>
                            <p>Work inside the container as if it were your local machine</p>
                        </div>
                    </div>

                    <div class="callout callout-info">
                        <span class="callout-icon">üí°</span>
                        Your code lives on your host machine, but runs inside the container. This gives you the best of both worlds: file persistence and environment isolation.
                    </div>
                </div>
            </div>

            <div class="card">
                <div class="card-header">
                    <span class="card-icon">üéÅ</span>
                    <h3 class="card-title">Key Benefits</h3>
                </div>
                <div class="card-body">
                    <div class="grid grid-2">
                        <div>
                            <h4>üë• For Teams</h4>
                            <ul>
                                <li>Everyone uses identical environments</li>
                                <li>New developers start coding in minutes</li>
                                <li>No more "works on my machine" issues</li>
                                <li>Easy to update tools across the team</li>
                            </ul>
                        </div>
                        <div>
                            <h4>üßë‚Äçüíª For Individuals</h4>
                            <ul>
                                <li>Keep your host system clean</li>
                                <li>Switch between projects instantly</li>
                                <li>No version conflicts between projects</li>
                                <li>Replicate environments across machines</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Why Use DevContainers Section (RESTORED) -->
        <section id="why-use-devcontainers" class="section">
            <h2>‚úÖ Why Use Development Containers?</h2>

            <div class="card" style="margin-top: 1.5rem;">
                <h3 class="card-title">For Individual Developers</h3>
                <ul style="list-style: none; padding-left: 0;">
                    <li style="display: flex; align-items: start; gap: 1rem; margin-bottom: 1rem;">
                        <span style="color: var(--color-success); font-size: 1.5rem; flex-shrink: 0;">‚úì</span>
                        <span><strong>Clean Host System:</strong> Your computer stays clean - no installing dozens of tools globally</span>
                    </li>
                    <li style="display: flex; align-items: start; gap: 1rem; margin-bottom: 1rem;">
                        <span style="color: var(--color-success); font-size: 1.5rem; flex-shrink: 0;">‚úì</span>
                        <span><strong>Multiple Environments:</strong> Work on Python 3.9 and Python 3.14 projects simultaneously without conflicts</span>
                    </li>
                    <li style="display: flex; align-items: start; gap: 1rem;">
                        <span style="color: var(--color-success); font-size: 1.5rem; flex-shrink: 0;">‚úì</span>
                        <span><strong>Consistency:</strong> Same setup works perfectly on Mac, Windows, and Linux</span>
                    </li>
                </ul>
            </div>

            <div class="card" style="margin-top: 1.5rem;">
                <h3 class="card-title">For Teams</h3>
                <ul style="list-style: none; padding-left: 0;">
                    <li style="display: flex; align-items: start; gap: 1rem; margin-bottom: 1rem;">
                        <span style="color: var(--color-primary); font-size: 1.5rem; flex-shrink: 0;">‚úì</span>
                        <span><strong>Fast Onboarding:</strong> New team members coding in minutes instead of hours/days</span>
                    </li>
                    <li style="display: flex; align-items: start; gap: 1rem; margin-bottom: 1rem;">
                        <span style="color: var(--color-primary); font-size: 1.5rem; flex-shrink: 0;">‚úì</span>
                        <span><strong>Standardization:</strong> Everyone uses the exact same tool versions</span>
                    </li>
                    <li style="display: flex; align-items: start; gap: 1rem;">
                        <span style="color: var(--color-primary); font-size: 1.5rem; flex-shrink: 0;">‚úì</span>
                        <span><strong>Documentation as Code:</strong> Setup is version-controlled and documented automatically</span>
                    </li>
                </ul>
            </div>
        </section>

        <!-- When NOT to Use Section (RESTORED) -->
        <section id="when-not-to-use" class="section section-alt">
            <h2>‚ö†Ô∏è When NOT to Use Dev Containers</h2>

            <div class="callout callout-danger">
                <div class="callout-header">
                    <span class="callout-icon">‚ö†Ô∏è</span>
                    <span>Dev containers aren't always the best solution</span>
                </div>
                <p style="margin-top: 0.5rem;">Here's when to skip them:</p>
            </div>

            <div class="card" style="margin-top: 1.5rem;">
                <ul style="list-style: none; padding-left: 0;">
                    <li style="display: flex; align-items: start; gap: 1rem; margin-bottom: 1rem; padding-bottom: 1rem; border-bottom: 1px solid var(--color-border);">
                        <span style="color: var(--color-danger); font-size: 1.5rem; flex-shrink: 0;">‚úó</span>
                        <div>
                            <strong>Simple Scripts:</strong>
                            <span style="color: var(--color-text-secondary);">For a single Python script or small Node.js file, just run it locally</span>
                        </div>
                    </li>
                    <li style="display: flex; align-items: start; gap: 1rem; margin-bottom: 1rem; padding-bottom: 1rem; border-bottom: 1px solid var(--color-border);">
                        <span style="color: var(--color-danger); font-size: 1.5rem; flex-shrink: 0;">‚úó</span>
                        <div>
                            <strong>GUI Applications:</strong>
                            <span style="color: var(--color-text-secondary);">Desktop apps requiring native UI don't work well in containers</span>
                        </div>
                    </li>
                    <li style="display: flex; align-items: start; gap: 1rem; margin-bottom: 1rem; padding-bottom: 1rem; border-bottom: 1px solid var(--color-border);">
                        <span style="color: var(--color-danger); font-size: 1.5rem; flex-shrink: 0;">‚úó</span>
                        <div>
                            <strong>Hardware Access:</strong>
                            <span style="color: var(--color-text-secondary);">USB devices, GPUs, specialized hardware need complex setup</span>
                        </div>
                    </li>
                    <li style="display: flex; align-items: start; gap: 1rem;">
                        <span style="color: var(--color-danger); font-size: 1.5rem; flex-shrink: 0;">‚úó</span>
                        <div>
                            <strong>Resource-Constrained Machines:</strong>
                            <span style="color: var(--color-text-secondary);">Docker overhead (1-2GB RAM) may be too much for older computers</span>
                        </div>
                    </li>
                </ul>
            </div>

            <div class="callout callout-info" style="margin-top: 1.5rem;">
                <div class="callout-header">
                    <span class="callout-icon">üí°</span>
                    <span>Better Alternatives</span>
                </div>
                <p>For simple projects, use <code>nvm</code>, <code>pyenv</code>, or <code>rbenv</code> for version management.</p>
            </div>
        </section>

        <!-- Prerequisites Section -->
        <section id="prerequisites" class="section">
            <h2>üìã Prerequisites</h2>

            <div class="tldr">
                <div class="tldr-header">
                    <span>üìã</span>
                    <span>TL;DR - What You Need</span>
                </div>
                <ul class="tldr-list">
                    <li>Docker Desktop installed and running</li>
                    <li>Visual Studio Code installed</li>
                    <li>Dev Containers extension for VS Code</li>
                    <li>Claude API key from console.anthropic.com</li>
                    <li>At least 8GB RAM available (16GB recommended)</li>
                </ul>
            </div>

            <div class="card">
                <div class="card-header">
                    <span class="card-icon">üê≥</span>
                    <h3 class="card-title">1. Install Docker Desktop</h3>
                    <span class="badge badge-beginner">üå± Required</span>
                </div>
                <div class="card-body">
                    <p>Docker Desktop provides the container runtime that powers DevContainers.</p>

                    <div class="grid grid-3">
                        <div class="card">
                            <h4>üçé macOS</h4>
                            <a href="https://www.docker.com/products/docker-desktop" target="_blank">Download for Mac</a>
                            <p class="text-muted">Supports Intel and Apple Silicon</p>
                        </div>
                        <div class="card">
                            <h4>ü™ü Windows</h4>
                            <a href="https://www.docker.com/products/docker-desktop" target="_blank">Download for Windows</a>
                            <p class="text-muted">Requires WSL 2</p>
                        </div>
                        <div class="card">
                            <h4>üêß Linux</h4>
                            <a href="https://docs.docker.com/engine/install/" target="_blank">Install Docker Engine</a>
                            <p class="text-muted">Use your package manager</p>
                        </div>
                    </div>

                    <details>
                        <summary>Verify Docker installation</summary>
                        <div class="code-block has-header">
                            <div class="code-header">
                                <span class="code-filename">terminal</span>
                                <button class="copy-btn" onclick="copyCode(this)" aria-label="Copy code">Copy</button>
                            </div>
                            <pre><code># Check Docker version
docker --version
# Should output: Docker version 24.x.x or higher

# Verify Docker is running
docker ps
# Should show running containers (or empty list if none running)

# Test with hello-world
docker run hello-world
# Should download and run a test container</code></pre>
                        </div>
                    </details>

                    <div class="callout callout-warning">
                        <span class="callout-icon">‚ö†Ô∏è</span>
                        <strong>Windows users:</strong> Enable WSL 2 before installing Docker Desktop. Follow the <a href="https://docs.microsoft.com/en-us/windows/wsl/install" target="_blank">WSL installation guide</a>.
                    </div>
                </div>
            </div>

            <div class="card">
                <div class="card-header">
                    <span class="card-icon">üíª</span>
                    <h3 class="card-title">2. Install Visual Studio Code</h3>
                    <span class="badge badge-beginner">üå± Required</span>
                </div>
                <div class="card-body">
                    <p>Download VS Code from <a href="https://code.visualstudio.com/" target="_blank">code.visualstudio.com</a></p>

                    <div class="code-block has-header">
                        <div class="code-header">
                            <span class="code-filename">terminal</span>
                            <button class="copy-btn" onclick="copyCode(this)" aria-label="Copy code">Copy</button>
                        </div>
                        <pre><code># Verify VS Code installation
code --version
# Should output version number (e.g., 1.85.0)</code></pre>
                    </div>
                </div>
            </div>

            <div class="card">
                <div class="card-header">
                    <span class="card-icon">üîå</span>
                    <h3 class="card-title">3. Install Dev Containers Extension</h3>
                    <span class="badge badge-beginner">üå± Required</span>
                </div>
                <div class="card-body">
                    <p>This extension enables VS Code to work with DevContainers.</p>

                    <ol>
                        <li>Open VS Code</li>
                        <li>Press <code>Ctrl+Shift+X</code> (Windows/Linux) or <code>Cmd+Shift+X</code> (Mac)</li>
                        <li>Search for "Dev Containers"</li>
                        <li>Click "Install" on the extension by Microsoft</li>
                    </ol>

                    <div class="callout callout-info">
                        <span class="callout-icon">üí°</span>
                        Alternative: Install via command line with <code>code --install-extension ms-vscode-remote.remote-containers</code>
                    </div>
                </div>
            </div>

            <div class="card">
                <div class="card-header">
                    <span class="card-icon">üîë</span>
                    <h3 class="card-title">4. Get Your Claude API Key</h3>
                    <span class="badge badge-beginner">üå± Required</span>
                </div>
                <div class="card-body">
                    <p>You'll need an API key to use Claude Code:</p>

                    <ol>
                        <li>Visit <a href="https://console.anthropic.com/" target="_blank">console.anthropic.com</a></li>
                        <li>Sign in or create an account</li>
                        <li>Navigate to "API Keys"</li>
                        <li>Click "Create Key"</li>
                        <li>Copy the key (you'll only see it once!)</li>
                    </ol>

                    <div class="callout callout-warning">
                        <span class="callout-icon">‚ö†Ô∏è</span>
                        <strong>Keep your API key secure:</strong> Never commit it to version control. We'll store it safely in the next section.
                    </div>
                </div>
            </div>

            <div class="card">
                <div class="card-header">
                    <span class="card-icon">üíæ</span>
                    <h3 class="card-title">5. System Requirements</h3>
                </div>
                <div class="card-body">
                    <div class="table-wrapper">
                        <table>
                            <thead>
                                <tr>
                                    <th>Component</th>
                                    <th>Minimum</th>
                                    <th>Recommended</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>RAM</td>
                                    <td>8GB</td>
                                    <td>16GB or more</td>
                                </tr>
                                <tr>
                                    <td>Disk Space</td>
                                    <td>10GB free</td>
                                    <td>20GB+ free</td>
                                </tr>
                                <tr>
                                    <td>CPU</td>
                                    <td>Dual-core</td>
                                    <td>Quad-core or better</td>
                                </tr>
                                <tr>
                                    <td>OS</td>
                                    <td>macOS 10.15+, Windows 10+, Ubuntu 20.04+</td>
                                    <td>Latest versions</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <div class="callout callout-info">
                        <span class="callout-icon">üí°</span>
                        More RAM improves container performance, especially when running multiple containers simultaneously.
                    </div>
                </div>
            </div>
        </section>

        <!-- Architecture Overview Section (RESTORED) -->
        <section id="architecture" class="section">
            <h2>üèóÔ∏è Architecture Overview</h2>

            <p>A dev container consists of three main components working together:</p>

            <div style="display: grid; gap: 1.5rem; margin-top: 2rem;">
                <div style="border-left: 4px solid var(--color-primary); padding-left: 1.5rem;">
                    <h3>üìÑ devcontainer.json</h3>
                    <p style="color: var(--color-text-secondary); margin-top: 0.5rem; margin-bottom: 0.5rem;">The configuration file that tells VS Code how to connect to your container.</p>
                    <ul style="color: var(--color-text-secondary); font-size: 0.875rem;">
                        <li>Defines which extensions to install</li>
                        <li>Sets environment variables</li>
                        <li>Configures port forwarding</li>
                        <li>Specifies post-creation commands</li>
                    </ul>
                </div>

                <div style="border-left: 4px solid var(--color-secondary); padding-left: 1.5rem;">
                    <h3>üê≥ Dockerfile</h3>
                    <p style="color: var(--color-text-secondary); margin-top: 0.5rem; margin-bottom: 0.5rem;">The blueprint that defines what's installed inside your container.</p>
                    <ul style="color: var(--color-text-secondary); font-size: 0.875rem;">
                        <li>Specifies base image (e.g., Node.js 22, Python 3.14)</li>
                        <li>Installs system packages and tools</li>
                        <li>Sets up users and permissions</li>
                        <li>Configures the shell environment</li>
                    </ul>
                </div>

                <div style="border-left: 4px solid var(--color-warning); padding-left: 1.5rem;">
                    <h3>‚öôÔ∏è Init Scripts (Optional)</h3>
                    <p style="color: var(--color-text-secondary); margin-top: 0.5rem; margin-bottom: 0.5rem;">Automation scripts that run after the container starts.</p>
                    <ul style="color: var(--color-text-secondary); font-size: 0.875rem;">
                        <li>Initialize tool configurations</li>
                        <li>Set up security policies</li>
                        <li>Prepare the development environment</li>
                    </ul>
                </div>
            </div>

            <div class="card" style="margin-top: 2rem;">
                <h3 class="card-title">üìÅ File Structure Example</h3>
                <div class="code-block">
                    <div class="code-header">
                        <span class="code-filename">Typical project structure</span>
                        <button class="copy-btn" onclick="copyCode(this)" aria-label="Copy code">Copy</button>
                    </div>
                    <pre><code>your-project/
‚îú‚îÄ‚îÄ .devcontainer/
‚îÇ   ‚îú‚îÄ‚îÄ devcontainer.json           # VS Code configuration
‚îÇ   ‚îú‚îÄ‚îÄ Dockerfile                  # Container blueprint
‚îÇ   ‚îú‚îÄ‚îÄ init-claude-config.sh       # Claude Code auto-config
‚îÇ   ‚îú‚îÄ‚îÄ init-claude-hooks.sh        # Hook deployment script
‚îÇ   ‚îú‚îÄ‚îÄ init-codex-config.sh        # Codex CLI auto-config
‚îÇ   ‚îú‚îÄ‚îÄ init-firewall.sh            # Network security
‚îÇ   ‚îú‚îÄ‚îÄ session-start.sh.template   # Session hook template
‚îÇ   ‚îú‚îÄ‚îÄ settings.json.template      # Claude settings
‚îÇ   ‚îú‚îÄ‚îÄ mcp.json.template           # MCP servers
‚îÇ   ‚îî‚îÄ‚îÄ config.toml.template        # Codex configuration
‚îú‚îÄ‚îÄ .gitignore
‚îú‚îÄ‚îÄ README.md
‚îî‚îÄ‚îÄ [your project files]</code></pre>
                </div>
            </div>
        </section>

        <!-- Security & Firewall Section (RESTORED) -->
        <section id="security-firewall" class="section">
            <h2>üîí Security & Firewall Setup</h2>

            <div class="tldr">
                <div class="tldr-header">
                    <span>üìã</span>
                    <span>TL;DR - Network Security</span>
                </div>
                <ul class="tldr-list">
                    <li>Three-layer IPv6 security architecture for maximum compatibility</li>
                    <li>Default-deny firewall with IP range allowlisting</li>
                    <li>Dynamic IP fetching from GitHub, Anthropic, Google, Cloudflare, AWS</li>
                    <li>100+ AI service domains pre-configured</li>
                    <li>Docker-aware to preserve inter-container communication</li>
                    <li>Self-testing with graceful degradation</li>
                </ul>
            </div>

            <div class="callout callout-warning">
                <span class="callout-icon">‚ö†Ô∏è</span>
                <strong>Advanced Section:</strong> If you're new to dev containers, you can skip this section initially. Return here when you need production-grade security.
            </div>

            <div class="card">
                <div class="card-header">
                    <span class="card-icon">üõ°Ô∏è</span>
                    <h3 class="card-title">Why Firewall for Dev Containers?</h3>
                </div>
                <div class="card-body">
                    <p>According to <a href="https://www.anthropic.com/engineering/claude-code-sandboxing" target="_blank">Claude's official documentation on sandboxing</a>, network isolation is a core security layer. The firewall provides:</p>

                    <ul>
                        <li>Protection against data exfiltration to untrusted domains</li>
                        <li>Controlled access to package registries and AI APIs</li>
                        <li>Defense-in-depth alongside other security measures</li>
                        <li>Audit trail of allowed network destinations</li>
                    </ul>
                </div>
            </div>

            <div class="card">
                <div class="card-header">
                    <span class="card-icon">üèóÔ∏è</span>
                    <h3 class="card-title">Three-Layer Security Architecture</h3>
                    <span class="badge badge-advanced">‚ö° Advanced</span>
                </div>
                <div class="card-body">
                    <p>This implementation provides maximum compatibility across Docker environments through defense-in-depth:</p>

                    <div class="grid grid-3">
                        <div class="card">
                            <h4>Layer 1</h4>
                            <p><strong>Container Creation:</strong> Disable IPv6 via sysctl flags at container startup (most reliable)</p>
                        </div>
                        <div class="card">
                            <h4>Layer 2</h4>
                            <p><strong>Runtime:</strong> Attempt IPv6 disable in init script with graceful degradation (warning, not failure)</p>
                        </div>
                        <div class="card">
                            <h4>Layer 3</h4>
                            <p><strong>Firewall Backup:</strong> ip6tables DROP rules block all IPv6 traffic if still enabled</p>
                        </div>
                    </div>

                    <div class="callout callout-success">
                        <span class="callout-icon">‚úÖ</span>
                        <strong>Result:</strong> Container starts successfully in any environment while maintaining security through at least one layer.
                    </div>
                </div>
            </div>

            <div class="card">
                <div class="card-header">
                    <span class="card-icon">üîß</span>
                    <h3 class="card-title">Implementation - Docker Capabilities</h3>
                </div>
                <div class="card-body">
                    <p>Add these <code>runArgs</code> to <code>devcontainer.json</code> to grant minimal capabilities needed for firewall management:</p>

                    <div class="code-block has-header">
                        <div class="code-header">
                            <span class="code-filename">devcontainer.json</span>
                            <button class="copy-btn" onclick="copyCode(this)" aria-label="Copy code">Copy</button>
                        </div>
                        <pre><code>"runArgs": [
  "--cap-drop=ALL",                              // Drop all capabilities first
  "--cap-add=NET_ADMIN",                         // Required for iptables/sysctl
  "--cap-add=NET_RAW",                           // Required for packet filtering
  "--cap-add=SETUID",                            // Required for sudo operations
  "--cap-add=SETGID",                            // Required for group switching
  "--cap-add=SYS_ADMIN",                         // Required for kernel parameters
  "--sysctl=net.ipv6.conf.all.disable_ipv6=1",   // Layer 1: IPv6 at creation
  "--sysctl=net.ipv6.conf.default.disable_ipv6=1",
  "--sysctl=net.ipv6.conf.lo.disable_ipv6=1"
],
"postStartCommand": "sudo /usr/local/bin/init-firewall.sh"</code></pre>
                    </div>

                    <details>
                        <summary>Explanation of each capability</summary>
                        <ul>
                            <li><strong>--cap-drop=ALL:</strong> Start with minimal privileges (principle of least privilege)</li>
                            <li><strong>--cap-add=NET_ADMIN:</strong> Required to configure iptables and modify sysctl network parameters</li>
                            <li><strong>--cap-add=NET_RAW:</strong> Required for ipset and packet filtering operations</li>
                            <li><strong>--cap-add=SETUID/SETGID:</strong> Required for sudo operations (switching between users)</li>
                            <li><strong>--cap-add=SYS_ADMIN:</strong> Required to modify kernel parameters via sysctl</li>
                            <li><strong>--sysctl flags:</strong> Layer 1 of IPv6 security - disable at container creation time</li>
                        </ul>
                    </details>
                </div>
            </div>
        </section>

        <!-- Git Safety & Branch Protection Section (RESTORED) -->
        <section id="git-safety" class="section">
            <h2>üõ°Ô∏è Git Safety & Branch Protection</h2>

            <div class="tldr">
                <div class="tldr-header">
                    <span>üìã</span>
                    <span>TL;DR - Git Workflow Safety</span>
                </div>
                <ul class="tldr-list">
                    <li>Pre-commit hook blocks direct commits to main/master branches</li>
                    <li>MANDATORY pre-work sync check ensures master is up-to-date</li>
                    <li>Feature branch workflow prevents data loss</li>
                    <li>Hooks reinstall automatically via postStartCommand</li>
                    <li>Defense-in-depth: 5 safety layers (hook, CLAUDE.md, git-pr-helper, volumes, user review)</li>
                </ul>
            </div>

            <div class="card">
                <h3 class="card-title">Why Git Safety Matters</h3>
                <p>Accidental data loss during refactoring or destructive operations is a common problem. This project implements a defense-in-depth approach to protect your work:</p>
                <ul>
                    <li><strong>Layer 1 - Git Hook (Technical Enforcement):</strong> Blocks commits to main/master automatically</li>
                    <li><strong>Layer 2 - CLAUDE.md Instructions (Guidance):</strong> Protocols guide safe workflows</li>
                    <li><strong>Layer 3 - git-pr-helper Skill (Workflow Assistance):</strong> Helps with PR/merge operations</li>
                    <li><strong>Layer 4 - Docker Volumes (Data Persistence):</strong> Configs survive container rebuilds</li>
                    <li><strong>Layer 5 - User Review (Final Check):</strong> Never merge without user confirmation</li>
                </ul>
            </div>

            <div class="card">
                <h3 class="card-title">‚ö†Ô∏è MANDATORY: Pre-Work Sync Check</h3>
                <div class="callout callout-danger">
                    <div class="callout-header">
                        <span class="callout-icon">üö®</span>
                        <span>Critical Workflow Step</span>
                    </div>
                    <p><strong>Before creating any new branch or starting work, ALWAYS ensure master is up-to-date:</strong></p>
                </div>

                <details>
                    <summary>View Pre-Work Sync Check Protocol</summary>
                    <div class="code-block">
                        <div class="code-header">
                            <span class="code-filename">Step 1: Check sync status</span>
                            <button class="copy-btn" onclick="copyCode(this)" aria-label="Copy code">Copy</button>
                        </div>
                        <pre><code class="language-bash"># 1. Switch to master (if not already there)
git checkout master

# 2. Fetch latest changes from remote (safe, doesn't merge)
git fetch origin

# 3. Check sync status
git status</code></pre>
                    </div>

                    <div class="callout callout-info" style="margin-top: 1rem;">
                        <div class="callout-header">
                            <span class="callout-icon">‚úÖ</span>
                            <span>Scenario 1: Up to date (SAFE TO PROCEED)</span>
                        </div>
                        <p><strong>Status shows:</strong> "Your branch is up to date with 'origin/master'"</p>
                        <p><strong>Action:</strong> Proceed to create feature branch</p>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyCode(this)" aria-label="Copy code">Copy</button>
                            <pre><code class="language-bash">git checkout -b feature/new-api
git branch --show-current  # Verify: "feature/new-api"
# ‚úÖ Now safe to start work!</code></pre>
                        </div>
                    </div>

                    <div class="callout callout-warning" style="margin-top: 1rem;">
                        <div class="callout-header">
                            <span class="callout-icon">‚ö†Ô∏è</span>
                            <span>Scenario 2: Behind remote (PULL FIRST)</span>
                        </div>
                        <p><strong>Status shows:</strong> "Your branch is behind 'origin/master' by X commits"</p>
                        <p><strong>Action:</strong> Pull changes before creating feature branch</p>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyCode(this)" aria-label="Copy code">Copy</button>
                            <pre><code class="language-bash">git pull origin master     # Update master
git status                 # Verify: "up to date"
git checkout -b feature/new-api
# ‚úÖ Now safe to start work!</code></pre>
                        </div>
                    </div>

                    <div class="callout callout-danger" style="margin-top: 1rem;">
                        <div class="callout-header">
                            <span class="callout-icon">üö®</span>
                            <span>Scenario 3: Diverged (RESOLVE FIRST)</span>
                        </div>
                        <p><strong>Status shows:</strong> "Your branch and 'origin/master' have diverged"</p>
                        <p><strong>Action:</strong> Resolve divergence before creating feature branch</p>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyCode(this)" aria-label="Copy code">Copy</button>
                            <pre><code class="language-bash"># Option 1: If you have no local commits on master, force update
git reset --hard origin/master

# Option 2: If you have local commits, merge or rebase
git pull origin master     # Creates merge commit
# OR
git rebase origin/master   # Replays your commits on top

# Then verify and create feature branch
git status                 # Verify: "up to date"
git checkout -b feature/new-api
# ‚úÖ Now safe to start work!</code></pre>
                        </div>
                    </div>

                    <div class="callout callout-info" style="margin-top: 1rem;">
                        <div class="callout-header">
                            <span class="callout-icon">üí°</span>
                            <span>Why This Matters</span>
                        </div>
                        <p>Ensures your feature branch is based on the latest code, preventing:</p>
                        <ul>
                            <li>Work on outdated master</li>
                            <li>Future merge conflicts</li>
                            <li>Building features on old foundation</li>
                        </ul>
                    </div>
                </details>
            </div>

            <div class="card">
                <h3 class="card-title">Git Hook Installation</h3>
                <p>Git hooks are stored in <code>.git/hooks/</code> and are NOT committed to the repository. They must be installed after cloning or container rebuilds.</p>

                <details>
                    <summary>View setup-git-hooks.sh (automatic installation script)</summary>
                    <div class="code-block">
                        <div class="code-header">
                            <span class="code-filename">.devcontainer/setup-git-hooks.sh</span>
                            <button class="copy-btn" onclick="copyCode(this)" aria-label="Copy code">Copy</button>
                        </div>
                        <pre><code class="language-bash">#!/bin/bash
#
# Setup Git Hooks
#
# Installs git hooks for branch protection and safety.
# Run this after cloning the repository or rebuilding the container.
#

# Strict error handling
set -euo pipefail

# Dynamically resolve repository root
SCRIPT_DIR="$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)"
REPO_ROOT="$(cd "$SCRIPT_DIR/.." && pwd)"
HOOKS_DIR="$REPO_ROOT/.git/hooks"

# Validate git repository
if [ ! -d "$REPO_ROOT/.git" ]; then
    echo "‚ùå ERROR: Not a git repository"
    echo "Current directory: $(pwd)"
    echo "Expected .git at: $REPO_ROOT/.git"
    exit 1
fi

# Validate hooks directory is writable
if [ -d "$HOOKS_DIR" ] && [ ! -w "$HOOKS_DIR" ]; then
    echo "‚ùå ERROR: Hooks directory is not writable: $HOOKS_DIR"
    exit 1
fi

echo "=== Git Hooks Setup ==="
echo ""

# Create hooks directory if it doesn't exist
if [ ! -d "$HOOKS_DIR" ]; then
    echo "Creating hooks directory..."
    mkdir -p "$HOOKS_DIR"
fi

# Install pre-commit hook
echo "Installing pre-commit hook..."
cat > "$HOOKS_DIR/pre-commit" << 'EOF'
#!/bin/bash
#
# Git Pre-Commit Hook: Branch Protection
#
# Prevents direct commits to main/master branches.
# Encourages feature branch workflow for safety.
#

BRANCH=$(git branch --show-current)

# Block commits to protected branches
if [ "$BRANCH" = "main" ] || [ "$BRANCH" = "master" ]; then
    echo ""
    echo "‚ùå ERROR: Direct commits to '$BRANCH' are not allowed"
    echo ""
    echo "This is a safety measure to protect your work."
    echo ""
    echo "üìù Create a feature branch instead:"
    echo "   git checkout -b feature/your-feature-name"
    echo ""
    echo "Or for session-based work:"
    echo "   git checkout -b session/$(date +%Y%m%d-%H%M)-description"
    echo ""
    exit 1
fi

# Success - allow commit
echo "‚úÖ Committing to branch: $BRANCH"
exit 0
EOF

chmod +x "$HOOKS_DIR/pre-commit"

echo "‚úÖ Pre-commit hook installed"
echo ""

# Verify installation
if [ -x "$HOOKS_DIR/pre-commit" ]; then
    echo "‚úÖ Hook is executable"
else
    echo "‚ùå Hook is not executable!"
    exit 1
fi

echo ""
echo "=== Setup Complete ==="
echo ""
echo "Git hooks have been installed successfully."
echo ""</code></pre>
                    </div>
                </details>

                <details>
                    <summary>View pre-commit hook (installed by setup script)</summary>
                    <div class="code-block">
                        <div class="code-header">
                            <span class="code-filename">.git/hooks/pre-commit</span>
                            <button class="copy-btn" onclick="copyCode(this)" aria-label="Copy code">Copy</button>
                        </div>
                        <pre><code class="language-bash">#!/bin/bash
#
# Git Pre-Commit Hook: Branch Protection
#
# Prevents direct commits to main/master branches.
# Encourages feature branch workflow for safety.
#

BRANCH=$(git branch --show-current)

# Block commits to protected branches
if [ "$BRANCH" = "main" ] || [ "$BRANCH" = "master" ]; then
    echo ""
    echo "‚ùå ERROR: Direct commits to '$BRANCH' are not allowed"
    echo ""
    echo "This is a safety measure to protect your work."
    echo ""
    echo "üìù Create a feature branch instead:"
    echo "   git checkout -b feature/your-feature-name"
    echo ""
    echo "Or for session-based work:"
    echo "   git checkout -b session/$(date +%Y%m%d-%H%M)-description"
    echo ""
    exit 1
fi

# Success - allow commit
echo "‚úÖ Committing to branch: $BRANCH"
exit 0</code></pre>
                    </div>
                </details>

                <h4 style="margin-top: 2rem;">Automatic Installation</h4>
                <p>Add to <code>devcontainer.json</code> for automatic installation on container startup:</p>
                <div class="code-block">
                    <div class="code-header">
                        <span class="code-filename">devcontainer.json</span>
                        <button class="copy-btn" onclick="copyCode(this)" aria-label="Copy code">Copy</button>
                    </div>
                    <pre><code class="language-json">{
  "postStartCommand": "bash /workspaces/your-project/.devcontainer/setup-git-hooks.sh"
}</code></pre>
                </div>

                <p style="margin-top: 1rem;">Or install manually:</p>
                <div class="code-block">
                    <pre><code class="language-bash">bash .devcontainer/setup-git-hooks.sh</code></pre>
                </div>
            </div>

            <div class="card">
                <h3 class="card-title">Safe Workflow Protocol</h3>
                <p>Follow this protocol BEFORE any destructive operation (rm, major refactors, rewrites):</p>

                <details open>
                    <summary>Step-by-step safe workflow</summary>
                    <ol style="margin-top: 1rem; padding-left: 1.5rem;">
                        <li style="margin-bottom: 0.5rem;"><strong>Verify clean state:</strong> Run <code>git status</code> - must show clean working tree or committed changes</li>
                        <li style="margin-bottom: 0.5rem;"><strong>Create feature branch:</strong> Use descriptive naming:
                            <ul style="margin-top: 0.5rem; padding-left: 1.5rem;">
                                <li><code>feature/description</code> - for new features</li>
                                <li><code>fix/description</code> - for bug fixes</li>
                                <li><code>session/YYYYMMDD-HHMM-description</code> - for session-based work</li>
                                <li><code>refactor/description</code> - for refactoring work</li>
                            </ul>
                        </li>
                        <li style="margin-bottom: 0.5rem;"><strong>Confirm branch:</strong> Run <code>git branch --show-current</code> - must NOT be main/master</li>
                        <li style="margin-bottom: 0.5rem;"><strong>Proceed with changes</strong> - now safe to make destructive edits</li>
                        <li style="margin-bottom: 0.5rem;"><strong>Commit frequently:</strong> After each logical unit of work</li>
                        <li style="margin-bottom: 0.5rem;"><strong>Use git-pr-helper skill:</strong> When ready to create PR or merge</li>
                    </ol>
                </details>

                <div class="callout callout-danger" style="margin-top: 1rem;">
                    <div class="callout-header">
                        <span class="callout-icon">‚õî</span>
                        <span>NEVER Do These</span>
                    </div>
                    <ul>
                        <li>Delete files while on main/master branch</li>
                        <li>Run <code>rm -rf</code> without verifying you're on a feature branch</li>
                        <li>Skip commits during long refactors</li>
                        <li>Force-push to main/master</li>
                        <li>Bypass pre-commit hook without explicit user request</li>
                    </ul>
                </div>

                <div class="callout callout-warning" style="margin-top: 1rem;">
                    <div class="callout-header">
                        <span class="callout-icon">‚ö†Ô∏è</span>
                        <span>If You Need to Abandon Work</span>
                    </div>
                    <ul>
                        <li><code>git stash</code> - preserve uncommitted changes</li>
                        <li><code>git reset --hard origin/main</code> - discard all local changes (WARNING: destructive)</li>
                        <li>Always verify with user before discarding work</li>
                    </ul>
                </div>
            </div>

            <div class="card">
                <h3 class="card-title">Branch Naming Conventions</h3>
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 1rem;">
                    <div class="callout callout-info">
                        <div class="callout-header">
                            <span class="callout-icon">üåø</span>
                            <span>Feature Branches (long-term work)</span>
                        </div>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyCode(this)" aria-label="Copy code">Copy</button>
                            <pre><code>feature/add-authentication
feature/update-api
fix/broken-login
refactor/clean-up-code</code></pre>
                        </div>
                    </div>

                    <div class="callout callout-warning">
                        <div class="callout-header">
                            <span class="callout-icon">üî¨</span>
                            <span>Session Branches (exploratory work)</span>
                        </div>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyCode(this)" aria-label="Copy code">Copy</button>
                            <pre><code>session/20251029-1045-add-firewall
session/20251029-1430-fix-bug
session/20251029-1600-update-docs</code></pre>
                        </div>
                        <p style="margin-top: 0.5rem; font-size: 0.875rem; font-style: italic;">Format: session/YYYYMMDD-HHMM-description</p>
                    </div>
                </div>
            </div>

            <div class="card">
                <h3 class="card-title">Testing Workflows</h3>
                <details>
                    <summary>Test 1: Verify hook blocks commits to main</summary>
                    <div class="code-block">
                        <div class="code-header">
                            <span class="code-filename">Expected: Commit should be blocked</span>
                            <button class="copy-btn" onclick="copyCode(this)" aria-label="Copy code">Copy</button>
                        </div>
                        <pre><code class="language-bash">git checkout master
git branch --show-current  # Verify: "master"
echo "test" > test.txt
git add test.txt
git commit -m "test"

# Expected output:
# ‚ùå ERROR: Direct commits to 'master' are not allowed
# (commit should be blocked)</code></pre>
                    </div>
                </details>

                <details>
                    <summary>Test 2: Verify hook allows commits on feature branch</summary>
                    <div class="code-block">
                        <div class="code-header">
                            <span class="code-filename">Expected: Commit should succeed</span>
                            <button class="copy-btn" onclick="copyCode(this)" aria-label="Copy code">Copy</button>
                        </div>
                        <pre><code class="language-bash">git checkout -b test/hook-check
git branch --show-current  # Verify: "test/hook-check"
echo "test" > test.txt
git add test.txt
git commit -m "test"

# Expected output:
# ‚úÖ Committing to branch: test/hook-check
# (commit should succeed)</code></pre>
                    </div>
                </details>
            </div>

            <div class="card">
                <h3 class="card-title">üîß Troubleshooting</h3>
                <details>
                    <summary>Problem: Hook doesn't block commits</summary>
                    <p><strong>Solution:</strong> Check if hook is installed</p>
                    <div class="code-block">
                        <button class="copy-btn" onclick="copyCode(this)" aria-label="Copy code">Copy</button>
                        <pre><code class="language-bash">test -x .git/hooks/pre-commit && echo "‚úÖ Installed" || echo "‚ùå Missing"</code></pre>
                    </div>
                    <p>If missing, run: <code>bash .devcontainer/setup-git-hooks.sh</code></p>
                </details>

                <details>
                    <summary>Problem: Permission denied error</summary>
                    <p><strong>Solution:</strong> Make hook executable</p>
                    <div class="code-block">
                        <button class="copy-btn" onclick="copyCode(this)" aria-label="Copy code">Copy</button>
                        <pre><code class="language-bash">chmod +x .git/hooks/pre-commit</code></pre>
                    </div>
                </details>

                <details>
                    <summary>Problem: Need to test hook manually</summary>
                    <p><strong>Solution:</strong> Run hook directly</p>
                    <div class="code-block">
                        <button class="copy-btn" onclick="copyCode(this)" aria-label="Copy code">Copy</button>
                        <pre><code class="language-bash">.git/hooks/pre-commit</code></pre>
                    </div>
                </details>

                <details>
                    <summary>Problem: Emergency fix needed on main</summary>
                    <div class="callout callout-success">
                        <p><strong>Better approach:</strong> Create hotfix branch</p>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyCode(this)" aria-label="Copy code">Copy</button>
                            <pre><code class="language-bash">git checkout -b hotfix/critical-fix</code></pre>
                        </div>
                    </div>
                    <div class="callout callout-danger" style="margin-top: 0.5rem;">
                        <p><strong>Bypass (NOT recommended):</strong></p>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyCode(this)" aria-label="Copy code">Copy</button>
                            <pre><code class="language-bash">git commit --no-verify</code></pre>
                        </div>
                    </div>
                </details>
            </div>

            <div class="callout callout-info">
                <div class="callout-header">
                    <span class="callout-icon">üí°</span>
                    <span>How It Works</span>
                </div>
                <ol style="padding-left: 1.5rem; margin-top: 0.5rem;">
                    <li>Git automatically runs <code>.git/hooks/pre-commit</code> before every commit</li>
                    <li>Hook reads current branch name with <code>git branch --show-current</code></li>
                    <li>If branch is <code>main</code> or <code>master</code>, hook exits with code 1 (blocks commit)</li>
                    <li>Users can override with <code>--no-verify</code> flag if absolutely necessary</li>
                </ol>
            </div>
        </section>

        <!-- Init Scripts Section (RESTORED WITH COMPLETE CODE) -->
        <section id="init-scripts" class="section">
            <h2>‚öôÔ∏è Init Scripts</h2>

            <div class="tldr">
                <div class="tldr-header">
                    <span>üìã</span>
                    <span>TL;DR - Automation Scripts</span>
                </div>
                <ul class="tldr-list">
                    <li>6 init scripts automate environment setup</li>
                    <li>init-firewall.sh: 500+ line security script (IP ranges, DNS resolution, Docker preservation)</li>
                    <li>init-claude-config.sh: Deploy Claude Code settings and MCP servers</li>
                    <li>init-codex-config.sh: Configure Codex CLI for Docker</li>
                    <li>init-python.sh: Install Python 3.14 via uv</li>
                    <li>init-claude-hooks.sh: Deploy session start hooks</li>
                    <li>init-opencode-config.sh: Configure OpenCode CLI</li>
                </ul>
            </div>

            <div class="card">
                <div class="card-header">
                    <span class="card-icon">üî•</span>
                    <h3 class="card-title">init-firewall.sh - Complete Network Security</h3>
                    <span class="badge badge-advanced">‚ö° Production</span>
                </div>
                <div class="card-body">
                    <p>The complete firewall script with three-layer IPv6 security, dynamic IP range fetching, and self-testing:</p>

                    <details>
                        <summary>View complete init-firewall.sh (500+ lines)</summary>
                        <div class="code-block has-header">
                            <div class="code-header">
                                <span class="code-filename">.devcontainer/init-firewall.sh</span>
                                <button class="copy-btn" onclick="copyCode(this)" aria-label="Copy code">Copy</button>
                            </div>
                            <pre><code>#!/bin/bash
set -euo pipefail
IFS=$'\n\t'

STATE_FILE="/var/lib/firewall-configured"

# Disable IPv6 to prevent bypass
echo "Disabling IPv6..."
sysctl -w net.ipv6.conf.all.disable_ipv6=1 >/dev/null 2>&1 || true
sysctl -w net.ipv6.conf.default.disable_ipv6=1 >/dev/null 2>&1 || true
sysctl -w net.ipv6.conf.lo.disable_ipv6=1 >/dev/null 2>&1 || true

# Check if already configured
if [ -f "$STATE_FILE" ]; then
    echo "Firewall already configured, skipping..."
    exit 0
fi

echo "Starting firewall configuration..."

# Initialize DNS resolution statistics
TOTAL_DOMAINS=0
RESOLVED_DOMAINS=0
FAILED_DOMAINS=0

# Extract Docker DNS before flushing
DOCKER_DNS_RULES=$(iptables-save -t nat | grep "127\.0\.0\.11" || true)

# Detect Docker networks
echo "Detecting Docker networks..."
DOCKER_NETWORKS=$(ip -o -f inet addr show | grep -v "127.0.0.1" | awk '{print $4}')

if [ -z "$DOCKER_NETWORKS" ]; then
    echo "ERROR: Failed to detect Docker networks"
    exit 1
fi

# Create ipset for allowed domains
ipset destroy allowed-domains 2>/dev/null || true
ipset create allowed-domains hash:net

# Fetch GitHub IP ranges
echo "Fetching GitHub IP ranges..."
gh_ranges=$(curl -s https://api.github.com/meta)
if [ -z "$gh_ranges" ]; then
    echo "ERROR: Failed to fetch GitHub IP ranges"
    exit 1
fi

echo "Processing GitHub IPs..."
while read -r cidr; do
    echo "Adding GitHub range $cidr"
    ipset add allowed-domains "$cidr" -exist
done < <(echo "$gh_ranges" | jq -r '(.web + .api + .git)[]' | aggregate -q)

# Add Anthropic IP ranges (official published ranges)
echo "Adding Anthropic IP ranges..."
echo "Adding Anthropic CIDR range 160.79.104.0/23"
ipset add allowed-domains "160.79.104.0/23" -exist

# Add Anthropic specific IP addresses
for ip in "34.162.46.92" "34.162.102.82" "34.162.136.91" "34.162.142.92" "34.162.183.95"; do
    echo "Adding Anthropic IP $ip"
    ipset add allowed-domains "$ip" -exist
done

# Fetch and add Google Cloud/API IP ranges
echo "Fetching Google Cloud/API IP ranges..."
goog_ranges=$(curl -s https://www.gstatic.com/ipranges/goog.json)
if [ -z "$goog_ranges" ]; then
    echo "ERROR: Failed to fetch Google IP ranges"
    exit 1
fi

echo "Processing Google IPs..."
while read -r cidr; do
    echo "Adding Google range $cidr"
    ipset add allowed-domains "$cidr" -exist
done < <(echo "$goog_ranges" | jq -r '.prefixes[].ipv4Prefix | select(. != null)')

# Fetch and add Cloudflare CDN IP ranges
echo "Fetching Cloudflare CDN IP ranges..."
cf_ranges=$(curl -s https://api.cloudflare.com/client/v4/ips)
if [ -z "$cf_ranges" ]; then
    echo "ERROR: Failed to fetch Cloudflare IP ranges"
    exit 1
fi

echo "Processing Cloudflare IPs..."
while read -r cidr; do
    echo "Adding Cloudflare range $cidr"
    ipset add allowed-domains "$cidr" -exist
done < <(echo "$cf_ranges" | jq -r '.result.ipv4_cidrs[]')

# Fetch and add AWS IP ranges (covers many AI services: Hugging Face, Replicate, etc.)
# Filtered for US East/West regions and EC2/CloudFront services only to limit allowlist size
echo "Fetching AWS IP ranges..."
aws_ranges=$(curl -s https://ip-ranges.amazonaws.com/ip-ranges.json)
if [ -z "$aws_ranges" ]; then
    echo "ERROR: Failed to fetch AWS IP ranges"
    exit 1
fi

echo "Processing AWS IPs (US regions: us-east-1, us-west-2; Services: EC2, CLOUDFRONT)..."
while read -r cidr; do
    echo "Adding AWS range $cidr"
    ipset add allowed-domains "$cidr" -exist
done < <(echo "$aws_ranges" | jq -r '.prefixes[] | select(.region == "us-east-1" or .region == "us-west-2") | select(.service == "EC2" or .service == "CLOUDFRONT") | .ip_prefix' | aggregate -q)

# Resolve and add allowed domains (defense-in-depth: includes DNS backup for services above)
for domain in \
    "dns.google" \
    "1.1.1.1" \
    "8.8.8.8" \
    "8.8.4.4" \
    "auth.openai.com" \
    "chatgpt.com" \
    "context7.com" \
    "unpkg.com" \
    "cdn.jsdelivr.net" \
    "cdnjs.cloudflare.com" \
    "github.com" \
    "api.github.com" \
    "raw.githubusercontent.com" \
    "github.githubassets.com" \
    "collector.github.com" \
    "ghcr.io" \
    "pkg-containers.githubusercontent.com" \
    "nodejs.org" \
    "registry.npmjs.org" \
    "pypi.org" \
    "files.pythonhosted.org" \
    "astral.sh" \
    "bun.sh" \
    "crates.io" \
    "static.crates.io" \
    "index.crates.io" \
    "docker.io" \
    "registry-1.docker.io" \
    "auth.docker.io" \
    "production.cloudflare.docker.com" \
    "api.anthropic.com" \
    "api.openai.com" \
    "aistudio.google.com" \
    "accounts.google.com" \
    "oauth2.googleapis.com" \
    "www.googleapis.com" \
    "storage.googleapis.com" \
    "content.googleapis.com" \
    "generativelanguage.googleapis.com" \
    "sentry.io" \
    "statsig.anthropic.com" \
    "statsig.com" \
    "marketplace.visualstudio.com" \
    "vscode.blob.core.windows.net" \
    "update.code.visualstudio.com" \
    "docs.mcp.cloudflare.com" \
    "mcp.context7.com" \
    "vercel.com" \
    "ui.shadcn.com" \
    "tailwindcss.com" \
    "radix-ui.com" \
    "fonts.googleapis.com" \
    "fonts.gstatic.com" \
    "react.dev" \
    "reactjs.org" \
    "esm.sh" \
    "lucide.dev" \
    "openrouter.ai" \
    "api.cerebras.ai" "inference.cerebras.ai" "cloud.cerebras.ai" "cerebras.ai" \
    "dashscope.aliyuncs.com" "qwen.ai" "qwenlm.ai" "aliyuncs.com" "alibabacloud.com" \
    "cn-hangzhou.aliyuncs.com" "us-west-1.aliyuncs.com" "ap-southeast-1.aliyuncs.com" \
    "api.minimax.chat" "minimax.chat" \
    "z.ai" \
    "api.cohere.ai" "cohere.ai" \
    "api.together.xyz" "together.xyz" \
    "api.replicate.com" "replicate.com" \
    "api-inference.huggingface.co" "huggingface.co" \
    "api.perplexity.ai" "perplexity.ai" \
    "api.mistral.ai" "mistral.ai" \
    "api.deepinfra.com" "deepinfra.com" \
    "api.fireworks.ai" "fireworks.ai" \
    "api.groq.com" "groq.com" \
    "api.lepton.ai" "lepton.ai" \
    "mancer.tech" "api.mancer.tech" \
    "api.deepseek.com" "deepseek.com" \
    "api.lingyiwanwu.com" "platform.lingyiwanwu.com"; do

    # Check if IP address
    if [[ "$domain" =~ ^[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}$ ]]; then
        echo "Adding IP $domain"
        ipset add allowed-domains "$domain" -exist
        continue
    fi

    # Resolve hostname with graceful error handling
    TOTAL_DOMAINS=$((TOTAL_DOMAINS + 1))
    echo "Resolving $domain..."
    ips=$(dig +noall +answer A "$domain" | awk '$4 == "A" {print $5}')
    if [ -z "$ips" ]; then
        echo "WARNING: Failed to resolve $domain (continuing...)"
        FAILED_DOMAINS=$((FAILED_DOMAINS + 1))
        continue
    fi

    # Successfully resolved, add IPs to allowlist
    domain_resolved=false
    while read -r ip; do
        if [[ ! "$ip" =~ ^[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}$ ]]; then
            echo "WARNING: Invalid IP from DNS for $domain: $ip (skipping)"
            continue
        fi
        echo "Adding $ip for $domain"
        ipset add allowed-domains "$ip" -exist
        domain_resolved=true
    done < <(echo "$ips")

    # Count as resolved only if at least one valid IP was added
    if [ "$domain_resolved" = true ]; then
        RESOLVED_DOMAINS=$((RESOLVED_DOMAINS + 1))
    else
        FAILED_DOMAINS=$((FAILED_DOMAINS + 1))
    fi
done

echo ""
echo "IP allowlist built successfully"
echo "DNS Resolution Summary: ${RESOLVED_DOMAINS}/${TOTAL_DOMAINS} domains resolved successfully"
if [ "$FAILED_DOMAINS" -gt 0 ]; then
    echo "  WARNING: ${FAILED_DOMAINS} domains failed to resolve"
fi
echo ""

# Flush iptables
echo "Flushing iptables..."
iptables -F
iptables -X
iptables -t nat -F
iptables -t nat -X
iptables -t mangle -F
iptables -t mangle -X

# Restore Docker DNS
if [ -n "$DOCKER_DNS_RULES" ]; then
    echo "Restoring Docker DNS..."
    iptables -t nat -N DOCKER_OUTPUT 2>/dev/null || true
    iptables -t nat -N DOCKER_POSTROUTING 2>/dev/null || true
    echo "$DOCKER_DNS_RULES" | xargs -L 1 iptables -t nat
fi

# Configure base rules
echo "Configuring base rules..."
iptables -A OUTPUT -p udp --dport 53 -j ACCEPT
iptables -A INPUT -p udp --sport 53 -j ACCEPT
iptables -A OUTPUT -p tcp --dport 22 -j ACCEPT
iptables -A INPUT -p tcp --sport 22 -m state --state ESTABLISHED -j ACCEPT
iptables -A INPUT -i lo -j ACCEPT
iptables -A OUTPUT -o lo -j ACCEPT

# Allow Docker networks
echo "Allowing Docker networks..."
while read -r network; do
    echo "  Allowing: $network"
    iptables -A INPUT -s "$network" -j ACCEPT
    iptables -A OUTPUT -d "$network" -j ACCEPT
done < <(echo "$DOCKER_NETWORKS")

# Set default-deny policies
echo "Setting default-deny policies..."
iptables -P INPUT DROP
iptables -P FORWARD DROP
iptables -P OUTPUT DROP

# Allow established connections
iptables -A INPUT -m state --state ESTABLISHED,RELATED -j ACCEPT
iptables -A OUTPUT -m state --state ESTABLISHED,RELATED -j ACCEPT

# Allow whitelisted domains
iptables -A OUTPUT -m set --match-set allowed-domains dst -j ACCEPT

# Reject all other traffic
iptables -A OUTPUT -j REJECT --reject-with icmp-admin-prohibited

# Configure IPv6 firewall rules (Layer 3 - Defense-in-depth)
echo "Configuring IPv6 firewall rules..."
ip6tables -P INPUT DROP 2>/dev/null || echo "  Note: IPv6 may already be disabled"
ip6tables -P FORWARD DROP 2>/dev/null || true
ip6tables -P OUTPUT DROP 2>/dev/null || true
ip6tables -A INPUT -i lo -j ACCEPT 2>/dev/null || true
ip6tables -A OUTPUT -o lo -j ACCEPT 2>/dev/null || true
ip6tables -A INPUT -m state --state ESTABLISHED,RELATED -j ACCEPT 2>/dev/null || true
ip6tables -A OUTPUT -m state --state ESTABLISHED,RELATED -j ACCEPT 2>/dev/null || true
ip6tables -A INPUT -j REJECT 2>/dev/null || true
ip6tables -A OUTPUT -j REJECT 2>/dev/null || true
echo "IPv6 firewall rules configured"

echo ""
echo "Firewall configuration complete!"
echo ""

# Verify firewall
echo "Verifying firewall..."

# Check IPv6 disabled (warning only, not fatal)
if sysctl net.ipv6.conf.all.disable_ipv6 | grep -q "= 1"; then
    echo "‚úì IPv6 disabled"
else
    echo "‚ö† WARNING: IPv6 is still enabled (container restrictions may prevent disabling)"
    echo "  IPv6 traffic will be blocked by ip6tables rules as a security fallback"
    echo "  This is expected in some Docker environments and does not affect security"
fi

# Check blocked domains
if curl --connect-timeout 5 https://example.com >/dev/null 2>&1; then
    echo "‚úó Firewall failed - can reach example.com"
    exit 1
else
    echo "‚úì Blocked example.com as expected"
fi

# Check allowed domains
if ! curl --connect-timeout 5 https://api.github.com/zen >/dev/null 2>&1; then
    echo "‚úó Cannot reach api.github.com"
    exit 1
else
    echo "‚úì Can reach api.github.com as expected"
fi

# Verify OpenRouter API access
if ! curl --connect-timeout 5 https://openrouter.ai/api/v1/models >/dev/null 2>&1; then
    echo "‚úó Cannot reach OpenRouter"
    exit 1
else
    echo "‚úì Can reach OpenRouter as expected"
fi

# Verify Cerebras API access
if ! curl --connect-timeout 5 https://api.cerebras.ai/v1/models >/dev/null 2>&1; then
    echo "‚úó Cannot reach Cerebras"
    exit 1
else
    echo "‚úì Can reach Cerebras as expected"
fi

# Mark as configured
touch "$STATE_FILE"
echo "Firewall configured successfully!"</code></pre>
                        </div>
                    </details>

                    <div class="callout callout-success">
                        <span class="callout-icon">üîë</span>
                        <strong>Key Features:</strong> Three-layer IPv6 security, dynamic IP range fetching from 5+ APIs, 100+ AI service domains, resilient DNS resolution with statistics, Docker network preservation, self-testing.
                    </div>
                </div>
            </div>

            <div class="card">
                <div class="card-header">
                    <span class="card-icon">‚öôÔ∏è</span>
                    <h3 class="card-title">Other Init Scripts</h3>
                </div>
                <div class="card-body">
                    <details>
                        <summary>init-claude-config.sh - Deploy Claude Code configuration</summary>
                        <div class="code-block has-header">
                            <div class="code-header">
                                <span class="code-filename">.devcontainer/init-claude-config.sh</span>
                                <button class="copy-btn" onclick="copyCode(this)" aria-label="Copy code">Copy</button>
                            </div>
                            <pre><code>#!/bin/bash
# Claude Code configuration deployment script
set -e

echo "=== Claude Code Configuration Setup ==="

TEMPLATE_DIR="/usr/local/share/claude-defaults"
CLAUDE_DIR="/home/node/.claude"

# Create .claude directory if it doesn't exist
mkdir -p "$CLAUDE_DIR"

# Deploy settings.json if it doesn't exist
if [ ! -f "$CLAUDE_DIR/settings.json" ]; then
    cp "$TEMPLATE_DIR/settings.json" "$CLAUDE_DIR/settings.json"
    echo "‚úÖ Deployed settings.json"
else
    echo "‚ÑπÔ∏è  settings.json already exists (skipping)"
fi

# Deploy mcp.json if it doesn't exist
if [ ! -f "$CLAUDE_DIR/mcp.json" ]; then
    cp "$TEMPLATE_DIR/mcp.json" "$CLAUDE_DIR/mcp.json"
    echo "‚úÖ Deployed mcp.json"
else
    echo "‚ÑπÔ∏è  mcp.json already exists (skipping)"
fi

# Ensure proper ownership
chown -R node:node "$CLAUDE_DIR"

echo "=== Claude Code Configuration Complete ==="</code></pre>
                        </div>
                    </details>

                    <details>
                        <summary>init-codex-config.sh - Configure Codex CLI for Docker</summary>
                        <div class="code-block has-header">
                            <div class="code-header">
                                <span class="code-filename">.devcontainer/init-codex-config.sh</span>
                                <button class="copy-btn" onclick="copyCode(this)" aria-label="Copy code">Copy</button>
                            </div>
                            <pre><code>#!/bin/bash
# Codex CLI configuration deployment script
set -e

echo "=== Codex CLI Configuration Setup ==="

TEMPLATE_DIR="/usr/local/share/codex-defaults"
CODEX_DIR="/home/node/.codex"

# Create .codex directory if it doesn't exist
mkdir -p "$CODEX_DIR"

# Deploy config.toml if it doesn't exist
if [ ! -f "$CODEX_DIR/config.toml" ]; then
    cp "$TEMPLATE_DIR/config.toml" "$CODEX_DIR/config.toml"
    echo "‚úÖ Deployed config.toml"
else
    echo "‚ÑπÔ∏è  config.toml already exists (skipping)"
fi

# Ensure proper ownership
chown -R node:node "$CODEX_DIR"

echo "=== Codex CLI Configuration Complete ==="</code></pre>
                        </div>
                    </details>

                    <details>
                        <summary>init-claude-hooks.sh - Deploy session start hooks</summary>
                        <div class="code-block has-header">
                            <div class="code-header">
                                <span class="code-filename">.devcontainer/init-claude-hooks.sh</span>
                                <button class="copy-btn" onclick="copyCode(this)" aria-label="Copy code">Copy</button>
                            </div>
                            <pre><code>#!/bin/bash
# Claude Code hook deployment script
set -e

echo "=== Claude Code Hooks Setup ==="

TEMPLATE_DIR="/usr/local/share/claude-defaults/hooks"
WORKSPACE_HOOKS="/workspaces/$(basename $PWD)/.claude/hooks"

mkdir -p "$WORKSPACE_HOOKS"

# Only deploy if hook doesn't exist (preserves user customizations)
if [ ! -f "$WORKSPACE_HOOKS/session-start.sh" ]; then
    cp "$TEMPLATE_DIR/session-start.sh" "$WORKSPACE_HOOKS/session-start.sh"
    chmod +x "$WORKSPACE_HOOKS/session-start.sh"
    echo "‚úÖ Deployed session-start.sh"
else
    echo "‚ÑπÔ∏è  session-start.sh already exists (skipping)"
fi

echo "=== Hooks Setup Complete ==="</code></pre>
                        </div>
                    </details>

                    <details>
                        <summary>init-gemini-config.sh - Configure Gemini CLI</summary>
                        <div class="code-block has-header">
                            <div class="code-header">
                                <span class="code-filename">.devcontainer/init-gemini-config.sh</span>
                                <button class="copy-btn" onclick="copyCode(this)" aria-label="Copy code">Copy</button>
                            </div>
                            <pre><code>#!/bin/bash
# Gemini CLI configuration deployment script
set -e

echo "=== Gemini CLI Configuration Setup ==="

GEMINI_DIR="/home/node/.gemini"

# Create .gemini directory if it doesn't exist
mkdir -p "$GEMINI_DIR"

# Ensure proper ownership
chown -R node:node "$GEMINI_DIR"

echo "‚úÖ Gemini CLI directory configured"
echo "‚ÑπÔ∏è  Run '/auth' in Gemini CLI to authenticate"
echo "=== Gemini CLI Configuration Complete ==="</code></pre>
                        </div>
                    </details>

                    <details>
                        <summary>init-python.sh - Install Python 3.14 via uv</summary>
                        <div class="code-block has-header">
                            <div class="code-header">
                                <span class="code-filename">.devcontainer/init-python.sh</span>
                                <button class="copy-btn" onclick="copyCode(this)" aria-label="Copy code">Copy</button>
                            </div>
                            <pre><code>#!/bin/bash
set -e

echo "=== Python 3.14 Setup ==="

# Install Python 3.14 via uv
echo "Installing Python 3.14..."
/home/node/.local/bin/uv python install 3.14

# Pin Python 3.14 for the project
echo "Pinning Python 3.14..."
cd /workspaces/$(basename $PWD)
/home/node/.local/bin/uv python pin 3.14

# Get Python 3.14 path
PYTHON314_PATH=$(/home/node/.local/bin/uv python find 3.14)
echo "Python 3.14 installed at: $PYTHON314_PATH"

# Create system symlink and update alternatives (requires sudo)
sudo ln -sf "$PYTHON314_PATH" /usr/local/bin/python3.14
sudo update-alternatives --install /usr/bin/python python /usr/local/bin/python3.14 100
sudo update-alternatives --install /usr/bin/python3 python3 /usr/local/bin/python3.14 100

# Verify installation
echo "Verifying Python installation..."
python --version
python3 --version
echo ""
echo "Available Python versions:"
/home/node/.local/bin/uv python list

echo "‚úÖ Python 3.14 configured as default"</code></pre>
                        </div>
                        <div class="callout callout-info">
                            <span class="callout-icon">üí°</span>
                            <strong>Why use init-python.sh?</strong>
                            <ul>
                                <li><strong>Runs during postCreateCommand:</strong> Executes after volume mounts, ensuring proper persistence</li>
                                <li><strong>Volume persistence:</strong> Python 3.14 installation saved in /home/node/.local volume</li>
                                <li><strong>System Python 3.11 retained:</strong> Keeps Python 3.11 for node-gyp compatibility</li>
                                <li><strong>Reproducible setup:</strong> Same Python version across container rebuilds</li>
                                <li><strong>update-alternatives integration:</strong> Sets Python 3.14 as default python command</li>
                            </ul>
                        </div>
                    </details>

                    <details>
                        <summary>init-opencode-config.sh - Configure OpenCode CLI</summary>
                        <div class="code-block has-header">
                            <div class="code-header">
                                <span class="code-filename">.devcontainer/init-opencode-config.sh</span>
                                <button class="copy-btn" onclick="copyCode(this)" aria-label="Copy code">Copy</button>
                            </div>
                            <pre><code>#!/bin/bash
# OpenCode CLI configuration deployment script
set -e

echo "=== OpenCode CLI Configuration Setup ==="

OPENCODE_DIR="/home/node/.opencode"

# Create .opencode directory if it doesn't exist
mkdir -p "$OPENCODE_DIR"

# Ensure proper ownership
chown -R node:node "$OPENCODE_DIR"

echo "‚úÖ OpenCode CLI directory configured"
echo "‚ÑπÔ∏è  Configure provider: opencode config set provider <anthropic|openai|google>"
echo "=== OpenCode CLI Configuration Complete ==="</code></pre>
                        </div>
                    </details>
                </div>
            </div>
        </section>

        <!-- Session Start Hook Section (RESTORED) -->
        <section id="session-start-hook" class="section section-alt">
            <h2>ü™ù Session Start Hook Configuration</h2>

            <div class="tldr">
                <div class="tldr-header">
                    <span>üìã</span>
                    <span>TL;DR - Session Start Automation</span>
                </div>
                <ul class="tldr-list">
                    <li>Session hook runs automated checks when Claude Code starts</li>
                    <li>Verifies devcontainer environment, volumes, MCP servers, tools</li>
                    <li>Warns if on main/master branch</li>
                    <li>Deploys automatically via postCreateCommand</li>
                    <li>Survives container rebuilds (mounted as Docker volume)</li>
                </ul>
            </div>

            <div class="card">
                <h3 class="card-title">What the Session Hook Does</h3>
                <p>Session hooks allow you to run automated checks and setup tasks when Claude Code starts. This project includes a SessionStart hook that verifies your devcontainer environment on every session.</p>

                <div class="callout callout-info" style="margin-top: 1rem;">
                    <div class="callout-header">
                        <span class="callout-icon">üí°</span>
                        <span>Automatic Checks Performed</span>
                    </div>
                    <ul style="margin-top: 0.5rem;">
                        <li>Confirms devcontainer environment detection</li>
                        <li>Verifies mounted volumes (.claude, .codex, .gemini, .opencode, etc.)</li>
                        <li>Lists configured MCP servers</li>
                        <li>Checks tool availability (claude, codex, gemini, opencode, gh, etc.)</li>
                        <li>Displays network configuration</li>
                        <li>Shows current git branch and warns if on main/master</li>
                    </ul>
                </div>
            </div>

            <div class="card">
                <h3 class="card-title">Configuration Format</h3>
                <p>Add this to your <code>~/.claude/settings.json</code> (user-level) or <code>.claude/settings.json</code> (workspace-level):</p>

                <details open>
                    <summary>View correct settings.json format</summary>
                    <div class="code-block">
                        <div class="code-header">
                            <span class="code-filename">~/.claude/settings.json</span>
                            <button class="copy-btn" onclick="copyCode(this)" aria-label="Copy code">Copy</button>
                        </div>
                        <pre><code class="language-json">{
  "$schema": "https://json.schemastore.org/claude-code-settings.json",
  "hooks": {
    "SessionStart": [
      {
        "hooks": [
          {
            "type": "command",
            "command": "\"$CLAUDE_PROJECT_DIR\"/.claude/hooks/session-start.sh"
          }
        ]
      }
    ]
  }
}</code></pre>
                    </div>
                </details>

                <div class="callout callout-success" style="margin-top: 1rem;">
                    <div class="callout-header">
                        <span class="callout-icon">‚úÖ</span>
                        <span>Correct Format - Key Points</span>
                    </div>
                    <ul style="margin-top: 0.5rem;">
                        <li><strong>Capitalized event name:</strong> Use <code>"SessionStart"</code>, not <code>"sessionStart"</code></li>
                        <li><strong>Array format:</strong> <code>"SessionStart": [{ "hooks": [...] }]</code></li>
                        <li><strong>No matcher field:</strong> SessionStart hooks don't use matchers (unlike PreToolUse/PostToolUse)</li>
                        <li><strong>$CLAUDE_PROJECT_DIR variable:</strong> Use instead of absolute paths for portability</li>
                        <li><strong>Double quotes around path:</strong> Required for paths with environment variables</li>
                    </ul>
                </div>

                <div class="callout callout-danger" style="margin-top: 1rem;">
                    <div class="callout-header">
                        <span class="callout-icon">‚ö†Ô∏è</span>
                        <span>Common Mistakes to Avoid</span>
                    </div>

                    <details style="margin-top: 0.5rem;">
                        <summary>‚ùå Old format (will fail validation)</summary>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyCode(this)" aria-label="Copy code">Copy</button>
                            <pre><code class="language-json">{
  "hooks": {
    "sessionStart": {
      "command": ".claude/hooks/session-start.sh"
    }
  }
}</code></pre>
                        </div>
                    </details>

                    <details style="margin-top: 0.5rem;">
                        <summary>‚ùå With matcher field (SessionStart doesn't use matchers)</summary>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyCode(this)" aria-label="Copy code">Copy</button>
                            <pre><code class="language-json">{
  "hooks": {
    "SessionStart": [{
      "matcher": {},
      "hooks": [...]
    }]
  }
}</code></pre>
                        </div>
                    </details>
                </div>
            </div>

            <div class="card">
                <h3 class="card-title">Hook Deployment Process</h3>
                <p>The session hook is deployed automatically when the devcontainer is first created, using a 4-step process:</p>

                <div style="display: grid; gap: 1rem; margin-top: 1rem;">
                    <div class="callout callout-info">
                        <div style="display: flex; align-items: center; gap: 1rem; margin-bottom: 0.5rem;">
                            <span style="background-color: var(--color-primary); color: white; width: 2rem; height: 2rem; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: bold; flex-shrink: 0;">1</span>
                            <strong>BUILD - Template Inclusion</strong>
                        </div>
                        <p style="margin-left: 3rem;">Dockerfile copies <code>session-start.sh.template</code> and <code>init-claude-hooks.sh</code> into the container image at build time.</p>
                    </div>

                    <div class="callout callout-info">
                        <div style="display: flex; align-items: center; gap: 1rem; margin-bottom: 0.5rem;">
                            <span style="background-color: var(--color-primary); color: white; width: 2rem; height: 2rem; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: bold; flex-shrink: 0;">2</span>
                            <strong>CREATE - Deployment Script Execution</strong>
                        </div>
                        <p style="margin-left: 3rem;"><code>postCreateCommand</code> runs <code>init-claude-hooks.sh</code> on first container creation.</p>
                    </div>

                    <div class="callout callout-info">
                        <div style="display: flex; align-items: center; gap: 1rem; margin-bottom: 0.5rem;">
                            <span style="background-color: var(--color-primary); color: white; width: 2rem; height: 2rem; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: bold; flex-shrink: 0;">3</span>
                            <strong>DEPLOY - Template Copy to Workspace</strong>
                        </div>
                        <p style="margin-left: 3rem;">Script copies template to <code>.claude/hooks/session-start.sh</code> (only if file doesn't exist, preserving user customizations).</p>
                    </div>

                    <div class="callout callout-info">
                        <div style="display: flex; align-items: center; gap: 1rem; margin-bottom: 0.5rem;">
                            <span style="background-color: var(--color-primary); color: white; width: 2rem; height: 2rem; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: bold; flex-shrink: 0;">4</span>
                            <strong>PERSIST - Volume Survival</strong>
                        </div>
                        <p style="margin-left: 3rem;"><code>.claude/</code> directory is mounted as a Docker volume, so your customizations survive container rebuilds.</p>
                    </div>
                </div>

                <details style="margin-top: 2rem;">
                    <summary>View init-claude-hooks.sh deployment script</summary>
                    <div class="code-block">
                        <div class="code-header">
                            <span class="code-filename">.devcontainer/init-claude-hooks.sh</span>
                            <button class="copy-btn" onclick="copyCode(this)" aria-label="Copy code">Copy</button>
                        </div>
                        <pre><code class="language-bash">#!/bin/bash
# Claude Code hook deployment script
set -e

echo "=== Claude Code Hooks Setup ==="

TEMPLATE_DIR="/usr/local/share/claude-defaults/hooks"
WORKSPACE_HOOKS="/workspaces/$(basename $PWD)/.claude/hooks"

mkdir -p "$WORKSPACE_HOOKS"

# Only deploy if hook doesn't exist (preserves user customizations)
if [ ! -f "$WORKSPACE_HOOKS/session-start.sh" ]; then
    cp "$TEMPLATE_DIR/session-start.sh" "$WORKSPACE_HOOKS/session-start.sh"
    chmod +x "$WORKSPACE_HOOKS/session-start.sh"
    echo "‚úÖ Deployed session-start.sh"
else
    echo "‚ÑπÔ∏è  session-start.sh already exists (skipping)"
fi

echo "=== Hooks Setup Complete ==="</code></pre>
                    </div>
                </details>

                <div class="callout callout-success" style="margin-top: 1rem;">
                    <div class="callout-header">
                        <span class="callout-icon">üí°</span>
                        <span>Key Benefits</span>
                    </div>
                    <ul style="margin-top: 0.5rem;">
                        <li><strong>Automatic deployment:</strong> No manual copying required</li>
                        <li><strong>Preserves customizations:</strong> Won't overwrite existing hooks</li>
                        <li><strong>Survives rebuilds:</strong> Volume persistence keeps your changes</li>
                        <li><strong>Template versioning:</strong> Template stays in container for reference</li>
                    </ul>
                </div>
            </div>

            <div class="card">
                <h3 class="card-title">Verifying the Hook</h3>
                <p>To verify your hook configuration is correct:</p>

                <div class="code-block">
                    <div class="code-header">
                        <span class="code-filename">Check for validation errors</span>
                        <button class="copy-btn" onclick="copyCode(this)" aria-label="Copy code">Copy</button>
                    </div>
                    <pre><code class="language-bash"># Check for validation errors
claude /doctor

# Should show no errors in "Invalid Settings" section
# If you see errors about hooks format, the configuration is incorrect</code></pre>
                </div>
            </div>

            <div class="card">
                <h3 class="card-title">üìö Additional Resources</h3>
                <ul>
                    <li>‚Ä¢ Official hooks documentation: <a href="https://docs.claude.com/en/docs/claude-code/hooks" target="_blank" rel="noopener noreferrer">docs.claude.com/hooks</a></li>
                    <li>‚Ä¢ Hook examples: <a href="https://github.com/anthropics/claude-cookbooks/tree/main/skills/.claude/hooks" target="_blank" rel="noopener noreferrer">Claude Cookbooks</a></li>
                    <li>‚Ä¢ Session hook script: Located at <code>.devcontainer/session-start.sh.template</code></li>
                </ul>
            </div>
        </section>

        <!-- Claude Code Configuration & MCP Section (RESTORED) - CRITICAL -->
        <section id="claude-config" class="section">
            <h2>‚öôÔ∏è Claude Code Configuration & MCP</h2>

            <p>Automatically configure Claude Code settings and MCP (Model Context Protocol) servers on container startup. This provides enhanced functionality like library documentation lookup and Cloudflare-specific help.</p>

            <div class="callout callout-info" style="margin-top: 1.5rem;">
                <div class="callout-header">
                    <span class="callout-icon">üí°</span>
                    <span>What is MCP?</span>
                </div>
                <p style="margin-top: 0.5rem;">Model Context Protocol (MCP) extends Claude Code with specialized capabilities through remote servers. Think of it like installing plugins that give Claude instant access to documentation and APIs.</p>
                <ul style="margin-top: 0.5rem;">
                    <li><strong>context7</strong>: Look up up-to-date library documentation (React, Next.js, Supabase, MongoDB, etc.)</li>
                    <li><strong>cf-docs</strong>: Search Cloudflare documentation (Workers, Pages, R2, D1, etc.)</li>
                </ul>
            </div>

            <div class="card" style="margin-top: 2rem;">
                <h3 class="card-title">The init-claude-config.sh Script</h3>
                <p>This script automatically sets up Claude Code configuration on container startup by:</p>
                <ul>
                    <li>Creating <code>.claude</code> directory if it doesn't exist</li>
                    <li>Copying MCP server configuration for context7 and cf-docs</li>
                    <li>Copying settings template with optimized environment variables</li>
                    <li>Ensuring npm global directory structure exists (required for npx with MCP)</li>
                    <li>Preserving user settings if they already exist (won't overwrite)</li>
                </ul>
            </div>

            <div class="card" style="margin-top: 2rem;">
                <h3 class="card-title">1. Create init-claude-config.sh</h3>
                <p>Save this script in your <code>.devcontainer</code> directory:</p>

                <details open>
                    <summary>View complete init-claude-config.sh script</summary>
                    <div class="code-block">
                        <div class="code-header">
                            <span class="code-filename">.devcontainer/init-claude-config.sh</span>
                            <button class="copy-btn" onclick="copyCode(this)" aria-label="Copy code">Copy</button>
                        </div>
                        <pre><code class="language-bash">#!/bin/bash
set -euo pipefail

CLAUDE_HOME="/home/node/.claude"
MCP_FILE="$CLAUDE_HOME/mcp.json"
MCP_TEMPLATE="/usr/local/share/claude-defaults/mcp.json"
SETTINGS_TEMPLATE="/usr/local/share/claude-defaults/settings.json"

echo "Initializing Claude Code configuration..."

# Create .claude directory if it doesn't exist
if [ ! -d "$CLAUDE_HOME" ]; then
    echo "Creating $CLAUDE_HOME directory..."
    mkdir -p "$CLAUDE_HOME"
    chown node:node "$CLAUDE_HOME"
fi

# Copy MCP configuration if it doesn't exist
if [ ! -f "$MCP_FILE" ]; then
    if [ -f "$MCP_TEMPLATE" ]; then
        echo "Copying MCP server configuration..."
        cp "$MCP_TEMPLATE" "$MCP_FILE"
        chown node:node "$MCP_FILE"
        echo "‚úì MCP servers configured:"
        echo "  - context7 (npx @upstash/context7-mcp with API key)"
        echo "  - cf-docs (npx mcp-remote with OAuth)"
    else
        echo "Warning: MCP template not found at $MCP_TEMPLATE"
    fi
else
    echo "MCP configuration already exists, preserving user settings"
fi

# Copy settings.json template if it doesn't exist
if [ ! -f "$CLAUDE_HOME/settings.json" ]; then
    if [ -f "$SETTINGS_TEMPLATE" ]; then
        echo "Copying Claude Code settings from template..."
        cp "$SETTINGS_TEMPLATE" "$CLAUDE_HOME/settings.json"
        chown node:node "$CLAUDE_HOME/settings.json"
        echo "‚úì Environment variables configured (MAX_MCP_OUTPUT_TOKENS, timeouts)"
    fi
else
    echo "Settings already exist, preserving user settings"
fi

# Ensure npm global directory structure exists (required for npx with MCP servers)
if [ ! -d "/home/node/.npm-global/lib" ]; then
    echo "Creating npm global directory structure..."
    mkdir -p /home/node/.npm-global/lib
    chown -R node:node /home/node/.npm-global
    echo "‚úì npm global directory initialized"
fi

echo "Claude Code configuration complete"</code></pre>
                    </div>
                </details>
            </div>

            <div class="card" style="margin-top: 2rem;">
                <h3 class="card-title">2. Create settings.json.template</h3>
                <p>This template configures Claude Code with optimized settings:</p>

                <h4 style="margin-top: 1.5rem; font-size: 1.125rem; font-weight: 600;">Basic Configuration (Recommended)</h4>
                <details open>
                    <summary>View basic settings.json template</summary>
                    <div class="code-block">
                        <div class="code-header">
                            <span class="code-filename">.devcontainer/settings.json.template</span>
                            <button class="copy-btn" onclick="copyCode(this)" aria-label="Copy code">Copy</button>
                        </div>
                        <pre><code class="language-json">{
  "$schema": "https://json.schemastore.org/claude-code-settings.json",
  "dangerously_skip_permissions": true,
  "verbose": true,
  "env": {
    "MAX_MCP_OUTPUT_TOKENS": "60000",
    "BASH_DEFAULT_TIMEOUT_MS": "300000",
    "BASH_MAX_TIMEOUT_MS": "600000",
    "MAX_THINKING_TOKENS": "8192"
  },
  "includeCoAuthoredBy": false
}</code></pre>
                    </div>
                </details>

                <div class="callout callout-info" style="margin-top: 1rem;">
                    <p><strong>üìù Note:</strong> MCP servers are now configured separately in <code>mcp.json</code> at the project root (see section 3 below).</p>
                </div>

                <h4 style="margin-top: 1.5rem; font-size: 1.125rem; font-weight: 600;">Optional: With OpenTelemetry</h4>
                <p style="margin-top: 0.5rem; color: var(--color-text-secondary); font-size: 0.875rem;">Use this version if you have OpenTelemetry infrastructure (otel-collector service):</p>

                <details style="margin-top: 0.5rem;">
                    <summary>View settings.json with OpenTelemetry</summary>
                    <div class="code-block">
                        <div class="code-header">
                            <span class="code-filename">settings.json with OpenTelemetry</span>
                            <button class="copy-btn" onclick="copyCode(this)" aria-label="Copy code">Copy</button>
                        </div>
                        <pre><code class="language-json">{
  "$schema": "https://json.schemastore.org/claude-code-settings.json",
  "dangerously_skip_permissions": true,
  "verbose": true,
  "env": {
    "MAX_MCP_OUTPUT_TOKENS": "60000",
    "BASH_DEFAULT_TIMEOUT_MS": "300000",
    "BASH_MAX_TIMEOUT_MS": "600000",
    "MAX_THINKING_TOKENS": "8192",
    "CLAUDE_CODE_ENABLE_TELEMETRY": "1",
    "OTEL_LOG_USER_PROMPTS": "1",
    "OTEL_METRICS_EXPORTER": "otlp",
    "OTEL_LOGS_EXPORTER": "otlp",
    "OTEL_EXPORTER_OTLP_PROTOCOL": "grpc",
    "OTEL_EXPORTER_OTLP_ENDPOINT": "http://otel-collector:4317",
    "OTEL_RESOURCE_ATTRIBUTES": "deployment.environment=devcontainer,service.name=claude-code"
  },
  "includeCoAuthoredBy": false
}</code></pre>
                    </div>
                </details>

                <div class="callout callout-success" style="margin-top: 1rem;">
                    <div class="callout-header">
                        <span class="callout-icon">üîß</span>
                        <span>Key Settings Explained</span>
                    </div>
                    <ul style="margin-top: 0.5rem;">
                        <li><strong>MAX_MCP_OUTPUT_TOKENS:</strong> Allows larger documentation responses (60,000 tokens)</li>
                        <li><strong>BASH_*_TIMEOUT_MS:</strong> Extended timeouts for long-running commands</li>
                        <li><strong>MAX_THINKING_TOKENS:</strong> Enables deeper reasoning (8,192 tokens)</li>
                        <li><strong>dangerously_skip_permissions:</strong> Skips tool execution prompts for 50-80% faster responses (‚ö†Ô∏è ONLY safe in isolated devcontainers)</li>
                        <li><strong>verbose:</strong> Enables detailed logging for easier debugging (no performance impact)</li>
                    </ul>
                </div>

                <div class="callout callout-warning" style="margin-top: 1rem;">
                    <div class="callout-header">
                        <span class="callout-icon">üìä</span>
                        <span>Optional OpenTelemetry Variables</span>
                    </div>
                    <p style="margin-top: 0.5rem;">Only include these if you have OpenTelemetry infrastructure (otel-collector service):</p>
                    <ul style="margin-top: 0.5rem;">
                        <li><strong>CLAUDE_CODE_ENABLE_TELEMETRY:</strong> Enables telemetry collection in Claude Code</li>
                        <li><strong>OTEL_LOG_USER_PROMPTS:</strong> Logs user prompts for debugging and analysis</li>
                        <li><strong>OTEL_METRICS_EXPORTER:</strong> Sets metrics export protocol (otlp)</li>
                        <li><strong>OTEL_LOGS_EXPORTER:</strong> Sets logs export protocol (otlp)</li>
                        <li><strong>OTEL_EXPORTER_OTLP_PROTOCOL:</strong> Communication protocol for OTLP (grpc or http)</li>
                        <li><strong>OTEL_EXPORTER_OTLP_ENDPOINT:</strong> URL of your OpenTelemetry collector endpoint</li>
                        <li><strong>OTEL_RESOURCE_ATTRIBUTES:</strong> Service identification metadata for distributed tracing</li>
                    </ul>
                </div>
            </div>

            <div class="card" style="margin-top: 2rem;">
                <h3 class="card-title">3. Create mcp.json.template</h3>
                <p>MCP configuration with stdio transport using npx for package execution:</p>

                <details open>
                    <summary>View mcp.json.template</summary>
                    <div class="code-block">
                        <div class="code-header">
                            <span class="code-filename">.devcontainer/mcp.json.template</span>
                            <button class="copy-btn" onclick="copyCode(this)" aria-label="Copy code">Copy</button>
                        </div>
                        <pre><code class="language-json">{
  "mcpServers": {
    "context7": {
      "command": "npx",
      "args": ["-y", "@upstash/context7-mcp"],
      "env": {
        "CONTEXT7_API_KEY": "${CONTEXT7_API_KEY}"
      }
    },
    "cf-docs": {
      "command": "npx",
      "args": ["mcp-remote", "https://docs.mcp.cloudflare.com/mcp"]
    },
    "chrome-devtools": {
      "command": "npx",
      "args": [
        "-y",
        "chrome-devtools-mcp@latest",
        "--executablePath=/usr/bin/chromium",
        "--headless",
        "--chromeArg=--no-sandbox",
        "--chromeArg=--disable-setuid-sandbox",
        "--chromeArg=--disable-dev-shm-usage"
      ],
      "transport": {
        "type": "stdio"
      }
    }
  }
}</code></pre>
                    </div>
                </details>

                <div class="callout callout-info" style="margin-top: 1rem;">
                    <p><strong>üí° Chrome DevTools Note:</strong> The <code>--executablePath=/usr/bin/chromium</code> argument is required in containers because Chromium (not Google Chrome) is installed at <code>/usr/bin/chromium</code>. The <code>--no-sandbox</code> and related flags are required for running Chromium in Docker containers.</p>
                </div>
            </div>

            <div class="card" style="margin-top: 2rem;">
                <h3 class="card-title">4. Create config.toml.template (Codex CLI)</h3>
                <p>This template configures Codex CLI for Docker containers by disabling the Landlock sandbox (not supported in LinuxKit kernel):</p>

                <details open>
                    <summary>View config.toml.template</summary>
                    <div class="code-block">
                        <div class="code-header">
                            <span class="code-filename">.devcontainer/config.toml.template</span>
                            <button class="copy-btn" onclick="copyCode(this)" aria-label="Copy code">Copy</button>
                        </div>
                        <pre><code class="language-toml"># Codex CLI configuration template for Docker containers
# Auto-copied to ~/.codex/config.toml by init-codex-config.sh

model = "gpt-5"
model_reasoning_effort = "medium"

# CRITICAL: Disable Landlock sandbox (not supported in Docker's LinuxKit kernel)
# OpenAI's official recommendation for containerized environments
# Security is provided by Docker isolation, network firewall, and non-root user
sandbox_mode = "danger-full-access"
approval_policy = "never"</code></pre>
                    </div>
                </details>

                <div class="callout callout-danger" style="margin-top: 1rem;">
                    <div class="callout-header">
                        <span class="callout-icon">üîí</span>
                        <span>Why Disable Sandbox?</span>
                    </div>
                    <ul style="margin-top: 0.5rem;">
                        <li>Docker's LinuxKit kernel doesn't support Landlock security module</li>
                        <li>Container already provides isolation via Docker, firewall, non-root user</li>
                        <li>OpenAI's official recommendation for containerized environments</li>
                        <li>See <a href="#troubleshooting">Troubleshooting ‚Üí Codex CLI Landlock Error</a> for details</li>
                    </ul>
                </div>
            </div>

            <div class="card" style="margin-top: 2rem;">
                <h3 class="card-title">5. Create init-codex-config.sh</h3>
                <p>This script automatically configures Codex CLI on container startup:</p>

                <details>
                    <summary>View init-codex-config.sh script</summary>
                    <div class="code-block">
                        <div class="code-header">
                            <span class="code-filename">.devcontainer/init-codex-config.sh</span>
                            <button class="copy-btn" onclick="copyCode(this)" aria-label="Copy code">Copy</button>
                        </div>
                        <pre><code class="language-bash">#!/bin/bash
set -euo pipefail

CODEX_HOME="/home/node/.codex"
CONFIG_FILE="$CODEX_HOME/config.toml"
CONFIG_TEMPLATE="/usr/local/share/codex-defaults/config.toml"

echo "Initializing Codex CLI configuration..."

# Create .codex directory if it doesn't exist
if [ ! -d "$CODEX_HOME" ]; then
    echo "Creating $CODEX_HOME directory..."
    mkdir -p "$CODEX_HOME"
    chown node:node "$CODEX_HOME"
fi

# Copy config template if it doesn't exist
if [ ! -f "$CONFIG_FILE" ]; then
    if [ -f "$CONFIG_TEMPLATE" ]; then
        echo "Copying Codex CLI configuration from template..."
        cp "$CONFIG_TEMPLATE" "$CONFIG_FILE"
        chown node:node "$CONFIG_FILE"
        echo "‚úì Codex sandbox disabled (Docker container isolation used instead)"
        echo "  sandbox_mode: danger-full-access"
        echo "  approval_policy: never"
    else
        echo "Warning: Codex config template not found at $CONFIG_TEMPLATE"
    fi
else
    echo "Codex config already exists, preserving user settings"
fi

echo "Codex CLI configuration complete"</code></pre>
                    </div>
                </details>

                <div class="callout callout-success" style="margin-top: 1rem;">
                    <div class="callout-header">
                        <span class="callout-icon">üí°</span>
                        <span>Key Features</span>
                    </div>
                    <ul style="margin-top: 0.5rem;">
                        <li><strong>Idempotent:</strong> Only creates config if it doesn't exist</li>
                        <li><strong>Preserves user settings:</strong> Won't overwrite existing configuration</li>
                        <li><strong>Proper ownership:</strong> Uses chown to ensure node user can access files</li>
                        <li><strong>Informative output:</strong> Logs what it's doing for debugging</li>
                    </ul>
                </div>
            </div>

            <div class="card" style="margin-top: 2rem;">
                <h3 class="card-title">6. Integrate into Dockerfile</h3>
                <p>Add these sections to your Dockerfile to enable automatic configuration:</p>

                <div class="code-block">
                    <div class="code-header">
                        <span class="code-filename">Dockerfile additions</span>
                        <button class="copy-btn" onclick="copyCode(this)" aria-label="Copy code">Copy</button>
                    </div>
                    <pre><code class="language-dockerfile"># Switch to root for setup
USER root

# Create directories for Claude Code and Codex defaults
RUN mkdir -p /usr/local/share/claude-defaults /usr/local/share/codex-defaults

# Copy init scripts and templates
COPY init-claude-config.sh /usr/local/bin/
COPY init-codex-config.sh /usr/local/bin/
COPY --chown=node:node settings.json.template /usr/local/share/claude-defaults/settings.json
COPY --chown=node:node mcp.json.template /usr/local/share/claude-defaults/mcp.json
COPY --chown=node:node config.toml.template /usr/local/share/codex-defaults/config.toml

# Set permissions and configure sudoers for all init scripts
RUN chmod +x /usr/local/bin/init-claude-config.sh && \
    chmod +x /usr/local/bin/init-codex-config.sh && \
    echo "node ALL=(root) NOPASSWD: /usr/local/bin/init-claude-config.sh" > /etc/sudoers.d/node-claude-config && \
    echo "node ALL=(root) NOPASSWD: /usr/local/bin/init-codex-config.sh" > /etc/sudoers.d/node-codex-config && \
    chmod 0440 /etc/sudoers.d/node-claude-config && \
    chmod 0440 /etc/sudoers.d/node-codex-config

# Switch back to node user
USER node</code></pre>
                </div>
            </div>

            <div class="card" style="margin-top: 2rem;">
                <h3 class="card-title">7. Update devcontainer.json</h3>
                <p>Run all initialization scripts on container startup:</p>

                <div class="code-block">
                    <div class="code-header">
                        <span class="code-filename">devcontainer.json</span>
                        <button class="copy-btn" onclick="copyCode(this)" aria-label="Copy code">Copy</button>
                    </div>
                    <pre><code class="language-json">{
  "postStartCommand": "sudo /usr/local/bin/init-claude-config.sh && sudo /usr/local/bin/init-codex-config.sh && sudo /usr/local/bin/init-firewall.sh"
}</code></pre>
                </div>

                <div class="callout callout-info" style="margin-top: 1rem;">
                    <div class="callout-header">
                        <span class="callout-icon">üìù</span>
                        <span>Init Script Order</span>
                    </div>
                    <ol style="margin-top: 0.5rem; padding-left: 1.5rem;">
                        <li><strong>init-claude-config.sh</strong> - Configure Claude Code & MCP servers</li>
                        <li><strong>init-codex-config.sh</strong> - Configure Codex CLI (disable Landlock sandbox)</li>
                        <li><strong>init-firewall.sh</strong> - Apply network security rules (runs last)</li>
                    </ol>
                    <p style="margin-top: 0.5rem;">Config scripts run before the firewall to ensure npm/npx can download packages if needed. All scripts run automatically each time the container starts.</p>
                </div>
            </div>

            <div class="callout callout-success" style="margin-top: 2rem;">
                <div class="callout-header">
                    <span class="callout-icon">‚úÖ</span>
                    <span>Benefits</span>
                </div>
                <ul style="margin-top: 0.5rem;">
                    <li><strong>Zero manual setup:</strong> MCP servers configured automatically on first run</li>
                    <li><strong>Instant documentation access:</strong> Ask Claude about any library and get current docs</li>
                    <li><strong>Preserves customization:</strong> Won't overwrite if you modify settings manually</li>
                    <li><strong>Team consistency:</strong> Everyone gets the same optimized configuration</li>
                    <li><strong>Extensible:</strong> Easy to add more MCP servers or environment variables</li>
                </ul>
            </div>
        </section>

        <!-- Templates Section (NEW - COMPLETE TEMPLATES) -->
        <section id="templates" class="section">
            <h2>üìù Configuration Templates</h2>

            <div class="tldr">
                <div class="tldr-header">
                    <span>üìã</span>
                    <span>TL;DR</span>
                </div>
                <ul class="tldr-list">
                    <li>settings.json - Claude Code settings (basic + OpenTelemetry versions)</li>
                    <li>mcp.json - MCP server configuration (context7, cf-docs, chrome-devtools)</li>
                    <li>config.toml - Codex CLI configuration with Landlock workaround</li>
                    <li>All templates are deployed automatically by init scripts</li>
                </ul>
            </div>

            <div class="card">
                <div class="card-header">
                    <span class="card-icon">‚öôÔ∏è</span>
                    <h3 class="card-title">settings.json - Claude Code Settings</h3>
                </div>
                <div class="card-body">
                    <details>
                        <summary>Basic configuration (recommended)</summary>
                        <div class="code-block has-header">
                            <div class="code-header">
                                <span class="code-filename">.claude/settings.json</span>
                                <button class="copy-btn" onclick="copyCode(this)" aria-label="Copy code">Copy</button>
                            </div>
                            <pre><code>{
  "$schema": "https://json.schemastore.org/claude-code-settings.json",
  "dangerously_skip_permissions": true,
  "verbose": true,
  "env": {
    "MAX_MCP_OUTPUT_TOKENS": "60000",
    "BASH_DEFAULT_TIMEOUT_MS": "300000",
    "BASH_MAX_TIMEOUT_MS": "600000",
    "MAX_THINKING_TOKENS": "8192"
  },
  "includeCoAuthoredBy": false
}</code></pre>
                        </div>
                    </details>

                    <details>
                        <summary>With OpenTelemetry (observability)</summary>
                        <div class="code-block has-header">
                            <div class="code-header">
                                <span class="code-filename">.claude/settings.json</span>
                                <button class="copy-btn" onclick="copyCode(this)" aria-label="Copy code">Copy</button>
                            </div>
                            <pre><code>{
  "$schema": "https://json.schemastore.org/claude-code-settings.json",
  "dangerously_skip_permissions": true,
  "verbose": true,
  "env": {
    "MAX_MCP_OUTPUT_TOKENS": "60000",
    "BASH_DEFAULT_TIMEOUT_MS": "300000",
    "BASH_MAX_TIMEOUT_MS": "600000",
    "MAX_THINKING_TOKENS": "8192",
    "CLAUDE_CODE_ENABLE_TELEMETRY": "1",
    "OTEL_LOG_USER_PROMPTS": "1",
    "OTEL_METRICS_EXPORTER": "otlp",
    "OTEL_LOGS_EXPORTER": "otlp",
    "OTEL_EXPORTER_OTLP_PROTOCOL": "grpc",
    "OTEL_EXPORTER_OTLP_ENDPOINT": "http://otel-collector:4317",
    "OTEL_RESOURCE_ATTRIBUTES": "deployment.environment=devcontainer,service.name=claude-code"
  },
  "includeCoAuthoredBy": false
}</code></pre>
                        </div>
                    </details>

                    <div class="callout callout-info">
                        <span class="callout-icon">üí°</span>
                        <strong>Key Settings:</strong>
                        <ul>
                            <li><code>dangerously_skip_permissions</code>: Safe in devcontainers (isolated environment)</li>
                            <li><code>MAX_MCP_OUTPUT_TOKENS</code>: Allows larger MCP server responses</li>
                            <li><code>BASH_DEFAULT_TIMEOUT_MS</code>: Default command timeout (5 minutes)</li>
                            <li><code>MAX_THINKING_TOKENS</code>: Extended thinking for complex problems</li>
                        </ul>
                    </div>
                </div>
            </div>

            <div class="card">
                <div class="card-header">
                    <span class="card-icon">üîå</span>
                    <h3 class="card-title">mcp.json - MCP Server Configuration</h3>
                </div>
                <div class="card-body">
                    <details>
                        <summary>Complete MCP server configuration</summary>
                        <div class="code-block has-header">
                            <div class="code-header">
                                <span class="code-filename">.claude/mcp.json</span>
                                <button class="copy-btn" onclick="copyCode(this)" aria-label="Copy code">Copy</button>
                            </div>
                            <pre><code>{
  "mcpServers": {
    "context7": {
      "command": "npx",
      "args": ["-y", "@upstash/context7-mcp"],
      "env": {
        "CONTEXT7_API_KEY": "${CONTEXT7_API_KEY}"
      }
    },
    "cf-docs": {
      "command": "npx",
      "args": ["mcp-remote", "https://docs.mcp.cloudflare.com/mcp"]
    },
    "chrome-devtools": {
      "command": "npx",
      "args": [
        "-y",
        "chrome-devtools-mcp@latest",
        "--executablePath=/usr/bin/chromium",
        "--headless",
        "--chromeArg=--no-sandbox",
        "--chromeArg=--disable-setuid-sandbox",
        "--chromeArg=--disable-dev-shm-usage"
      ],
      "transport": {
        "type": "stdio"
      }
    }
  }
}</code></pre>
                        </div>
                    </details>

                    <div class="callout callout-warning">
                        <span class="callout-icon">‚ö†Ô∏è</span>
                        <strong>Chrome DevTools in Docker:</strong> The sandbox flags (<code>--no-sandbox</code>, <code>--disable-setuid-sandbox</code>) are required because Docker's security model conflicts with Chrome's sandbox. The container's isolation provides equivalent security.
                    </div>
                </div>
            </div>

            <div class="card">
                <div class="card-header">
                    <span class="card-icon">üõ†Ô∏è</span>
                    <h3 class="card-title">config.toml - Codex CLI Configuration</h3>
                </div>
                <div class="card-body">
                    <details>
                        <summary>Codex CLI config with Landlock workaround</summary>
                        <div class="code-block has-header">
                            <div class="code-header">
                                <span class="code-filename">.codex/config.toml</span>
                                <button class="copy-btn" onclick="copyCode(this)" aria-label="Copy code">Copy</button>
                            </div>
                            <pre><code># Codex CLI configuration template for Docker containers
model = "gpt-4.0"
model_reasoning_effort = "medium"

# CRITICAL: Disable Landlock sandbox (not supported in Docker's LinuxKit kernel)
sandbox_mode = "danger-full-access"
approval_policy = "never"</code></pre>
                        </div>
                    </details>

                    <div class="callout callout-error">
                        <span class="callout-icon">‚ö†Ô∏è</span>
                        <strong>Why disable Landlock?</strong> Docker uses LinuxKit kernel which doesn't support Landlock LSM. OpenAI officially recommends <code>sandbox_mode = "danger-full-access"</code> for Docker environments. The container's isolation provides security instead.
                    </div>
                </div>
            </div>
        </section>

        <!-- Continue with examples... Due to length, I'll show the pattern for the Multi-AI example -->
        <section id="examples" class="section">
            <h2>üí° Examples</h2>

            <div class="tldr">
                <div class="tldr-header">
                    <span>üìã</span>
                    <span>TL;DR</span>
                </div>
                <ul class="tldr-list">
                    <li>Complete production examples with all 13 volume mounts</li>
                    <li>Multi-AI: Claude Code + Codex + Gemini + OpenCode in one container</li>
                    <li>React: Complete with BuildKit optimization and init scripts</li>
                    <li>Python: Basic (pip) and Advanced (uv with Python 3.14)</li>
                    <li>All examples include security runArgs and firewall setup</li>
                </ul>
            </div>

            <div class="card">
                <div class="card-header">
                    <span class="card-icon">ü§ñ</span>
                    <h3 class="card-title">Multi-AI DevContainer - Production Setup</h3>
                    <span class="badge badge-advanced">‚ö° Complete</span>
                </div>
                <div class="card-body">
                    <div class="callout callout-info">
                        <span class="callout-icon">üéØ</span>
                        <strong>Why Multiple AI Assistants?</strong>
                        <ul>
                            <li><strong>Claude Code:</strong> Excellent for complex reasoning, refactoring, architectural decisions</li>
                            <li><strong>Codex:</strong> Great for code completion and quick code generation</li>
                            <li><strong>Gemini:</strong> Strong at multimodal tasks and Google ecosystem integration</li>
                            <li><strong>OpenCode:</strong> Open-source, terminal-native agent with multi-model support</li>
                        </ul>
                    </div>

                    <details open>
                        <summary>Complete devcontainer.json with all 13 volumes</summary>
                        <div class="code-block has-header">
                            <div class="code-header">
                                <span class="code-filename">.devcontainer/devcontainer.json</span>
                                <button class="copy-btn" onclick="copyCode(this)" aria-label="Copy code">Copy</button>
                            </div>
                            <pre><code>{
  "name": "Multi-AI Dev Container",
  "build": {
    "dockerfile": "Dockerfile"
  },
  "customizations": {
    "vscode": {
      "extensions": [
        "anthropic.claude-code",
        "openai.codex-vscode",
        "sst-dev.opencode",
        "google.gemini-cli-vscode-ide-companion",
        "google.geminicodeassist",
        "dbaeumer.vscode-eslint",
        "esbenp.prettier-vscode",
        "kilocode.kilo-code",
        "tamasfe.even-better-toml",
        "ms-toolsai.jupyter-keymap",
        "ms-vscode.sublime-keybindings",
        "grapecity.gc-excelviewer",
        "imgildev.vscode-json-flow",
        "redhat.vscode-yaml"
      ],
      "settings": {
        "editor.formatOnSave": true
      }
    }
  },
  "runArgs": [
    "--cap-drop=ALL",
    "--cap-add=NET_ADMIN",
    "--cap-add=NET_RAW",
    "--cap-add=SETUID",
    "--cap-add=SETGID",
    "--cap-add=SYS_ADMIN",
    "--sysctl=net.ipv6.conf.all.disable_ipv6=1",
    "--sysctl=net.ipv6.conf.default.disable_ipv6=1",
    "--sysctl=net.ipv6.conf.lo.disable_ipv6=1"
  ],
  "forwardPorts": [3000, 5000, 8000],
  "postCreateCommand": "npm install -g @anthropic-ai/claude-code@latest && npm install -g @openai/codex && npm install -g @google/gemini-cli && npm install -g opencode-ai@latest && npm install -g wrangler@latest && npm install -g vercel@latest && (npm install || pip install -r requirements.txt || echo 'No dependencies to install') && /usr/local/bin/init-claude-config.sh && /usr/local/bin/init-codex-config.sh && /usr/local/bin/init-opencode-config.sh && /usr/local/bin/init-python.sh && /usr/local/bin/init-claude-hooks.sh",
  "postStartCommand": "sudo /usr/local/bin/init-firewall.sh",
  "remoteUser": "node",
  "mounts": [
    "source=claude-code-bashhistory-${devcontainerId},target=/commandhistory,type=volume",
    "source=claude-config-${devcontainerId},target=/home/node/.claude,type=volume",
    "source=codex-config-${devcontainerId},target=/home/node/.codex,type=volume",
    "source=gemini-config-${devcontainerId},target=/home/node/.gemini,type=volume",
    "source=opencode-config-${devcontainerId},target=/home/node/.opencode,type=volume",
    "source=ghub-config-${devcontainerId},target=/home/node/.config/gh,type=volume",
    "source=npm-global-${devcontainerId},target=/home/node/.npm-global,type=volume",
    "source=cargo-${devcontainerId},target=/home/node/.cargo,type=volume",
    "source=bun-${devcontainerId},target=/home/node/.bun,type=volume",
    "source=local-bin-${devcontainerId},target=/home/node/.local,type=volume",
    "source=aws-config-${devcontainerId},target=/home/node/.aws,type=volume",
    "source=wrangler-config-${devcontainerId},target=/home/node/.wrangler,type=volume",
    "source=vercel-config-${devcontainerId},target=/home/node/.vercel,type=volume"
  ]
}</code></pre>
                        </div>
                    </details>

                    <div class="callout callout-success">
                        <span class="callout-icon">üí°</span>
                        <strong>What's happening here:</strong>
                        <ul>
                            <li><strong>Complete volume setup:</strong> All 13 volumes for full production capabilities</li>
                            <li><strong>Multiple extensions:</strong> Install all AI assistant VS Code extensions at once</li>
                            <li><strong>Security runArgs:</strong> Minimal capabilities for firewall with three-layer IPv6 protection</li>
                            <li><strong>Flexible postCreateCommand:</strong> Works with npm, pip, or no dependencies</li>
                            <li><strong>Infrastructure tools:</strong> Includes wrangler (Cloudflare), vercel (Vercel), AWS CLI, cargo (Rust/uv), bun</li>
                        </ul>
                    </div>

                    <div class="callout callout-info">
                        <span class="callout-icon">üîß</span>
                        <strong>Customize for Your Infrastructure:</strong> Add more volumes for your specific tools:
                        <ul>
                            <li>Docker: <code>~/.docker</code></li>
                            <li>Kubernetes: <code>~/.kube</code></li>
                            <li>Terraform: <code>~/.terraform.d</code></li>
                            <li>Google Cloud: <code>~/.config/gcloud</code></li>
                            <li>Azure CLI: <code>~/.azure</code></li>
                        </ul>
                    </div>

                    <details open>
                        <summary>Complete Multi-AI Dockerfile</summary>
                        <div class="code-block has-header">
                            <div class="code-header">
                                <span class="code-filename">.devcontainer/Dockerfile</span>
                                <button class="copy-btn" onclick="copyCode(this)" aria-label="Copy code">Copy</button>
                            </div>
                            <pre><code class="language-dockerfile">FROM node:22

ARG TZ
ENV TZ="$TZ"

ARG CLAUDE_CODE_VERSION=latest

# Upgrade npm to latest version (ensures security patches and latest features)
RUN npm install -g npm@latest

# Install development tools, compilers, and utilities with BuildKit cache mounts
# BuildKit cache mounts provide 5-10x faster rebuilds
RUN --mount=type=cache,target=/var/cache/apt,sharing=locked \
  --mount=type=cache,target=/var/lib/apt/lists,sharing=locked \
  apt-get update && apt-get install -y --no-install-recommends \
  # Core utilities
  less curl wget ca-certificates gnupg2 software-properties-common \
  apt-transport-https lsb-release \
  # Version control
  git git-lfs gh \
  # Shell and terminal tools
  zsh fzf man-db \
  # Process and system tools
  procps htop tree sudo \
  # Network tools
  dnsutils net-tools iputils-ping telnet netcat-openbsd \
  iptables ipset iproute2 aggregate \
  # Archive and compression
  unzip zip bzip2 xz-utils \
  # Text processing and data
  jq yq sed gawk \
  # Fast search tools (modern replacements)
  ripgrep fd-find \
  # Build essentials (for native npm modules)
  build-essential gcc g++ make cmake pkg-config \
  # Python (for node-gyp and AI CLIs)
  python3 python3-pip python3-venv python3-dev \
  # Text editors
  nano vim tmux \
  # OpenSSL and crypto
  openssl libssl-dev \
  # Additional development libraries
  libz-dev libffi-dev libbz2-dev libreadline-dev libsqlite3-dev \
  libncurses5-dev libncursesw5-dev liblzma-dev \
  # Locales for proper encoding
  locales \
  # Browser automation (Chromium for Chrome DevTools MCP)
  chromium fonts-liberation libatk-bridge2.0-0 libatk1.0-0 \
  libatspi2.0-0 libcups2 libdbus-1-3 libdrm2 libgbm1 libgtk-3-0 \
  libnspr4 libnss3 libxcomposite1 libxdamage1 libxfixes3 \
  libxkbcommon0 libxrandr2 xdg-utils \
  && apt-get clean && rm -rf /var/lib/apt/lists/*

# Set up locale (prevents encoding issues with AI CLIs)
RUN sed -i -e 's/# en_US.UTF-8 UTF-8/en_US.UTF-8 UTF-8/' /etc/locale.gen && \
  locale-gen
ENV LANG=en_US.UTF-8 \
  LANGUAGE=en_US:en \
  LC_ALL=en_US.UTF-8

# Ensure default node user has access to /usr/local/share
RUN chown -R node:node /usr/local/share

ARG USERNAME=node

# Persist bash history and configure PATH for npm global packages
RUN SNIPPET="export PROMPT_COMMAND='history -a' && export HISTFILE=/commandhistory/.bash_history" \
  && mkdir /commandhistory \
  && touch /commandhistory/.bash_history \
  && chown -R $USERNAME /commandhistory \
  && echo 'export PATH=$PATH:/home/node/.npm-global/bin:/home/node/.local/bin' >> /home/node/.bashrc \
  && chown node:node /home/node/.bashrc

# Set `DEVCONTAINER` environment variable to help with orientation
ENV DEVCONTAINER=true

# Create config directories and set permissions
RUN mkdir -p /home/node/.config/gh /home/node/.claude /home/node/.codex /home/node/.gemini /home/node/.npm-global/lib /home/node/.aws /home/node/.wrangler /home/node/.vercel /home/node/.local/bin && \
  chown -R node:node /home/node/.config/gh /home/node/.claude /home/node/.codex /home/node/.gemini /home/node/.npm-global /home/node/.aws /home/node/.wrangler /home/node/.vercel /home/node/.local

# Default working directory
WORKDIR /workspaces

# Install git-delta for better diffs
ARG GIT_DELTA_VERSION=0.18.2
RUN ARCH=$(dpkg --print-architecture) && \
  wget "https://github.com/dandavison/delta/releases/download/${GIT_DELTA_VERSION}/git-delta_${GIT_DELTA_VERSION}_${ARCH}.deb" && \
  dpkg -i "git-delta_${GIT_DELTA_VERSION}_${ARCH}.deb" && \
  rm "git-delta_${GIT_DELTA_VERSION}_${ARCH}.deb"

# Set up non-root user
USER node

# Install global packages
ENV NPM_CONFIG_PREFIX=/home/node/.npm-global
ENV PATH=$PATH:/home/node/.npm-global/bin

# Set the default shell to zsh rather than sh
ENV SHELL=/bin/zsh

# Set the default editor and visual
ENV EDITOR=nano
ENV VISUAL=nano

# Install zsh with powerline10k theme
ARG ZSH_IN_DOCKER_VERSION=1.2.0
RUN sh -c "$(wget -O- https://github.com/deluan/zsh-in-docker/releases/download/v${ZSH_IN_DOCKER_VERSION}/zsh-in-docker.sh)" -- \
  -p git \
  -p fzf \
  -a "source /usr/share/doc/fzf/examples/key-bindings.zsh" \
  -a "source /usr/share/doc/fzf/examples/completion.zsh" \
  -a "export PROMPT_COMMAND='history -a' && export HISTFILE=/commandhistory/.bash_history" \
  -a "export PATH=\$PATH:/home/node/.npm-global/bin:/home/node/.local/bin" \
  -a "alias fd=fdfind" \
  -a "alias rg='rg --smart-case'" \
  -x

# npm CLI packages (Claude Code, OpenCode, Codex, Gemini, Wrangler, Vercel) installed via postCreateCommand
# This ensures packages install AFTER npm-global volume mounts, preventing version conflicts
# See devcontainer.json postCreateCommand for installation details

# Install AWS CLI v2 to volume-persisted location
RUN curl "https://awscli.amazonaws.com/awscli-exe-linux-$(uname -m).zip" -o "awscliv2.zip" && \
    unzip awscliv2.zip && \
    ./aws/install --install-dir /home/node/.local/aws-cli --bin-dir /home/node/.local/bin && \
    rm -rf awscliv2.zip aws

# Add .local/bin to PATH for AWS CLI
ENV PATH="/home/node/.local/bin:$PATH"

# Install uv (fast Python package manager - 10-100x faster than pip)
# uv installer places binary at /home/node/.local/bin/uv
RUN curl -LsSf https://astral.sh/uv/install.sh | sh && \
    echo 'export PATH="$HOME/.local/bin:$PATH"' >> /home/node/.bashrc && \
    echo 'export PATH="$HOME/.local/bin:$PATH"' >> /home/node/.zshrc
# Note: .local/bin already in PATH via ENV declaration above

# Install bun (fast JavaScript runtime for hybrid Python/JS projects)
RUN curl -fsSL https://bun.sh/install | bash && \
    echo 'export BUN_INSTALL="$HOME/.bun"' >> /home/node/.bashrc && \
    echo 'export PATH="$BUN_INSTALL/bin:$PATH"' >> /home/node/.bashrc && \
    echo 'export BUN_INSTALL="$HOME/.bun"' >> /home/node/.zshrc && \
    echo 'export PATH="$BUN_INSTALL/bin:$PATH"' >> /home/node/.zshrc
ENV BUN_INSTALL="/home/node/.bun"
ENV PATH="$BUN_INSTALL/bin:$PATH"

# Configure git to ignore Claude's local settings (Anthropic best practice)
RUN git config --global core.excludesfile ~/.gitignore_global && \
  echo ".claude/settings.local.json" > /home/node/.gitignore_global && \
  chown node:node /home/node/.gitignore_global

# Switch to root for final setup (scripts, sudoers, templates)
USER root

# Create directories for Claude Code and Codex defaults
RUN mkdir -p /usr/local/share/claude-defaults /usr/local/share/codex-defaults

# Copy all scripts and templates
COPY init-firewall.sh /usr/local/bin/
COPY init-claude-config.sh /usr/local/bin/
COPY init-codex-config.sh /usr/local/bin/
COPY --chown=node:node settings.json.template /usr/local/share/claude-defaults/settings.json
COPY --chown=node:node mcp.json.template /usr/local/share/claude-defaults/mcp.json
COPY --chown=node:node config.toml.template /usr/local/share/codex-defaults/config.toml

# Set permissions and configure sudoers for all init scripts
RUN chmod +x /usr/local/bin/init-firewall.sh && \
  chmod +x /usr/local/bin/init-claude-config.sh && \
  chmod +x /usr/local/bin/init-codex-config.sh && \
  chmod +x /usr/local/bin/init-opencode-config.sh && \
  echo "node ALL=(root) NOPASSWD: /usr/local/bin/init-firewall.sh" > /etc/sudoers.d/node-firewall && \
  echo "node ALL=(root) NOPASSWD: /usr/local/bin/init-claude-config.sh" > /etc/sudoers.d/node-claude-config && \
  echo "node ALL=(root) NOPASSWD: /usr/local/bin/init-codex-config.sh" > /etc/sudoers.d/node-codex-config && \
  echo "node ALL=(root) NOPASSWD: /usr/local/bin/init-opencode-config.sh" > /etc/sudoers.d/node-opencode-config && \
  chmod 0440 /etc/sudoers.d/node-firewall && \
  chmod 0440 /etc/sudoers.d/node-claude-config && \
  chmod 0440 /etc/sudoers.d/node-codex-config && \
  chmod 0440 /etc/sudoers.d/node-opencode-config

# Final switch to node user for container runtime
USER node</code></pre>
                        </div>

                        <div class="callout callout-success">
                            <span class="callout-icon">‚ú®</span>
                            <strong>Dockerfile Highlights:</strong>
                            <ul>
                                <li><strong>BuildKit Cache Mounts:</strong> 5-10x faster rebuilds with persistent apt cache</li>
                                <li><strong>Comprehensive Tooling:</strong> ripgrep, fd-find, fzf, git-delta, zsh with powerline10k</li>
                                <li><strong>Multi-Language Support:</strong> Node.js 22 + Python 3 + build essentials for native modules</li>
                                <li><strong>Multiple Runtimes:</strong> AWS CLI v2, uv (Python), bun (JavaScript/TypeScript)</li>
                                <li><strong>Browser Automation:</strong> Chromium + dependencies for Chrome DevTools MCP server</li>
                                <li><strong>Security Best Practices:</strong> Non-root user, sudoers for specific init scripts only</li>
                                <li><strong>Volume Optimization:</strong> npm packages installed via postCreateCommand (after volume mounts)</li>
                            </ul>
                        </div>

                        <div class="callout callout-info">
                            <span class="callout-icon">üîç</span>
                            <strong>Key Design Decisions:</strong>
                            <ul>
                                <li><strong>Node 22 Base:</strong> Latest LTS with modern JavaScript features and performance improvements</li>
                                <li><strong>Locale Configuration:</strong> UTF-8 encoding prevents issues with AI CLI output rendering</li>
                                <li><strong>Path Configuration:</strong> Multiple PATH additions ensure tools work in both bash and zsh</li>
                                <li><strong>Git Delta:</strong> Better diff viewing with syntax highlighting and side-by-side diffs</li>
                                <li><strong>Zsh + fzf:</strong> Enhanced terminal experience with fuzzy finding and git integration</li>
                                <li><strong>Installation Order:</strong> System tools (root) ‚Üí user tools (node) ‚Üí config scripts (root)</li>
                            </ul>
                        </div>
                    </details>

                    <details open>
                        <summary>Step 3: Authentication Setup</summary>
                        <div class="code-block has-header">
                            <div class="code-header">
                                <span class="code-filename">Terminal - After container builds</span>
                                <button class="copy-btn" onclick="copyCode(this)" aria-label="Copy code">Copy</button>
                            </div>
                            <pre><code class="language-bash"># Authenticate Claude Code
# Claude /login slash command
/login

# Authenticate Codex
codex auth login

# Authenticate Gemini (3 options)

# Option 1: .env file (recommended for devcontainers)
cp .env.example .env
# Edit .env and add: GEMINI_API_KEY=your_key_here

# Option 2: Environment variable
export GEMINI_API_KEY=YOUR_GOOGLE_API_KEY

# Option 3: Settings file
mkdir -p ~/.gemini
echo '{"apiKey": "YOUR_GOOGLE_API_KEY"}' > ~/.gemini/settings.json

# Authenticate OpenCode (if installed)
opencode auth login</code></pre>
                        </div>

                        <div class="callout callout-info">
                            <span class="callout-icon">üîë</span>
                            <strong>Getting API Keys:</strong>
                            <ul>
                                <li><strong>Claude/Anthropic:</strong> Visit <a href="https://console.anthropic.com/" target="_blank" rel="noopener noreferrer">console.anthropic.com</a></li>
                                <li><strong>OpenAI Codex:</strong> Visit <a href="https://platform.openai.com/api-keys" target="_blank" rel="noopener noreferrer">platform.openai.com/api-keys</a></li>
                                <li><strong>Google Gemini:</strong> Visit <a href="https://makersuite.google.com/app/apikey" target="_blank" rel="noopener noreferrer">makersuite.google.com/app/apikey</a></li>
                                <li><strong>OpenCode:</strong> Multi-provider (uses Claude/OpenAI/Gemini credentials)</li>
                            </ul>
                        </div>

                        <div class="callout callout-warning">
                            <span class="callout-icon">‚ö†Ô∏è</span>
                            <strong>Important Notes:</strong>
                            <ul>
                                <li>You'll need valid API keys for each service to authenticate</li>
                                <li>For Claude Code and Codex CLI, you can also use your paid Claude AI Pro/Max or ChatGPT Plus/Pro accounts</li>
                                <li>Each AI assistant authenticates independently</li>
                                <li>Consider your API usage costs across multiple services</li>
                            </ul>
                        </div>

                        <div class="callout callout-error">
                            <span class="callout-icon">üîí</span>
                            <strong>Security:</strong> .env is git-ignored. Never commit API keys to version control. Volume mounts keep credentials secure and persistent across rebuilds.
                        </div>
                    </details>

                    <details open>
                        <summary>Step 4: Verify Installation</summary>
                        <div class="code-block has-header">
                            <div class="code-header">
                                <span class="code-filename">Test all CLI tools</span>
                                <button class="copy-btn" onclick="copyCode(this)" aria-label="Copy code">Copy</button>
                            </div>
                            <pre><code class="language-bash"># Check Claude Code
claude --version

# Check Codex
codex --version

# Check Gemini
gemini --version

# Check OpenCode
opencode --version

# Check Wrangler
wrangler --version

# Check gh
gh --version

# Check AWS CLI
aws --version

# Check Vercel CLI
vercel --version</code></pre>
                        </div>

                        <div class="callout callout-success">
                            <span class="callout-icon">üéâ</span>
                            <strong>Success!</strong> All AI assistants should now be ready to use. If any command fails, check the postCreateCommand output in VS Code terminal for errors.
                        </div>
                    </details>

                    <details open>
                        <summary>Best Practices for Multi-AI Setup</summary>
                        <div class="callout callout-success">
                            <span class="callout-icon">‚úÖ</span>
                            <strong>Optimization Tips:</strong>
                            <ul>
                                <li><strong>Task-specific usage:</strong> Use Claude for complex reasoning, Codex for quick completions, Gemini for multimodal work, OpenCode for terminal-native workflows</li>
                                <li><strong>API cost awareness:</strong> Monitor your usage across all services to manage costs effectively</li>
                                <li><strong>Config persistence:</strong> Volume mounts ensure you don't need to re-authenticate when rebuilding containers</li>
                                <li><strong>Security:</strong> Never commit API keys to your repository - keep them in the volume-mounted config directories</li>
                                <li><strong>Extension conflicts:</strong> If you experience conflicts, you can disable individual extensions in VS Code settings</li>
                                <li><strong>Tool selection:</strong> Start with just Claude Code, then add other tools as needed - no need to run all at once</li>
                            </ul>
                        </div>
                    </details>

                    <div class="callout callout-info" style="margin-top: 2rem;">
                        <span class="callout-icon">üîó</span>
                        <strong>Need More Details?</strong> See the comprehensive documentation in <a href="../README.md" target="_blank">README.md</a> or <a href="./llms.txt" target="_blank">llms.txt</a> for alternative authentication methods, troubleshooting, and security best practices.
                    </div>
                </div>
            </div>
        </section>

        <!-- Multi-AI Collaboration Example -->
        <section id="multi-ai-collaboration" class="section section-alt">
            <h2>üì∑ Multi-AI Collaboration Example</h2>

            <p class="text-lg">This example demonstrates the power of running multiple AI assistants (Claude Code, OpenAI Codex CLI, and Google Gemini CLI) within a single dev container. Using a custom AI cross-verifier skill, we can leverage each model's unique strengths for comprehensive code analysis and evaluation.</p>

            <div class="callout callout-info">
                <span class="callout-icon">ü§ñ</span>
                <strong>AI Cross Verifier Skill:</strong> The AI Cross Verifier skill enables Claude to coordinate with OpenAI Codex and Google Gemini CLI to provide independent code reviews, plan validation, and comparative analysis for cross-verification of technical decisions.
            </div>

            <div class="callout callout-success">
                <span class="callout-icon">üí°</span>
                <strong>What This Demonstrates:</strong>
                <ul>
                    <li><strong>Multi-AI orchestration:</strong> Claude coordinates with Codex and Gemini CLIs for cross-verification</li>
                    <li><strong>Unified environment:</strong> All three AI assistants working seamlessly in one container</li>
                    <li><strong>Custom skills:</strong> AI cross-verifier skill automates multi-model evaluation workflows</li>
                    <li><strong>Real-world task:</strong> Analyzing and summarizing the <a href="./llms.txt" target="_blank">llms.txt</a> documentation file</li>
                </ul>
            </div>

            <h3 style="margin-top: 2rem; font-size: 1.5rem; font-weight: 600;">Scenario: llms.txt Summarization & Cross-Evaluation</h3>

            <p>In this workflow, we ask Claude Code to summarize the <a href="./llms.txt" target="_blank">llms.txt</a> file and evaluate responses from both Codex CLI and Gemini CLI. This showcases how the AI cross-verifier skill enables sophisticated multi-model comparisons with a single command.</p>

            <details open>
                <summary>Workflow Screenshots (6 steps)</summary>

                <div class="card">
                    <h4 class="card-title">Step 1: Initial Request</h4>
                    <img src="screenshot-multi-ai-dev-container-demo-1.png" alt="Claude Code receiving request to summarize llms.txt file and coordinate with other AI models" style="width: 100%; border-radius: 0.5rem; border: 1px solid var(--color-border);">
                    <p class="text-muted" style="margin-top: 0.5rem; font-size: 0.875rem; text-align: center;">Initial request to Claude to summarize llms.txt and compare with other AI models</p>
                </div>

                <div class="card">
                    <h4 class="card-title">Step 2: Codex CLI Invocation</h4>
                    <img src="screenshot-multi-ai-dev-container-demo-2.png" alt="Claude Code invoking Codex CLI to get OpenAI's perspective on the llms.txt summary" style="width: 100%; border-radius: 0.5rem; border: 1px solid var(--color-border);">
                    <p class="text-muted" style="margin-top: 0.5rem; font-size: 0.875rem; text-align: center;">Claude invokes Codex CLI to get OpenAI's analysis</p>
                </div>

                <div class="card">
                    <h4 class="card-title">Step 3: Gemini CLI Invocation</h4>
                    <img src="screenshot-multi-ai-dev-container-demo-3.png" alt="Claude Code invoking Gemini CLI to get Google's perspective on the llms.txt summary" style="width: 100%; border-radius: 0.5rem; border: 1px solid var(--color-border);">
                    <p class="text-muted" style="margin-top: 0.5rem; font-size: 0.875rem; text-align: center;">Claude invokes Gemini CLI to get Google's analysis</p>
                </div>

                <div class="card">
                    <h4 class="card-title">Step 4: Claude's Analysis</h4>
                    <img src="screenshot-multi-ai-dev-container-demo-4.png" alt="Claude Code analyzing and comparing the responses from Codex and Gemini" style="width: 100%; border-radius: 0.5rem; border: 1px solid var(--color-border);">
                    <p class="text-muted" style="margin-top: 0.5rem; font-size: 0.875rem; text-align: center;">Claude analyzes responses from both Codex and Gemini</p>
                </div>

                <div class="card">
                    <h4 class="card-title">Step 5: Detailed Comparison</h4>
                    <img src="screenshot-multi-ai-dev-container-demo-5.png" alt="Claude providing detailed comparison of each model's strengths and approach to the task" style="width: 100%; border-radius: 0.5rem; border: 1px solid var(--color-border);">
                    <p class="text-muted" style="margin-top: 0.5rem; font-size: 0.875rem; text-align: center;">Detailed comparison highlighting each model's unique strengths</p>
                </div>

                <div class="card">
                    <h4 class="card-title">Step 6: Final Summary</h4>
                    <img src="screenshot-multi-ai-dev-container-demo-6.png" alt="Claude's final summary and recommendations based on multi-model evaluation" style="width: 100%; border-radius: 0.5rem; border: 1px solid var(--color-border);">
                    <p class="text-muted" style="margin-top: 0.5rem; font-size: 0.875rem; text-align: center;">Claude context usage after session</p>
                </div>
            </details>

            <div class="callout callout-success" style="margin-top: 2rem;">
                <span class="callout-icon">üéØ</span>
                <strong>Key Takeaways:</strong>
                <ul>
                    <li><strong>Seamless integration:</strong> All three AI CLIs work together without conflicts or manual switching</li>
                    <li><strong>Automatic orchestration:</strong> AI cross-verifier skill handles the coordination logic</li>
                    <li><strong>Complementary insights:</strong> Each model contributes unique perspectives (Claude for reasoning, Codex for code focus, Gemini for multimodal understanding)</li>
                    <li><strong>Production-ready setup:</strong> Authentication persists, volumes maintain state, firewall ensures security</li>
                </ul>
            </div>
        </section>

        <!-- React Example -->
        <section id="react-example" class="section">
            <div class="container">
                <h2 class="section-title">‚öõÔ∏è React Development Container</h2>
                <p class="text-lg">A production-ready React development environment with TypeScript, modern tooling, and Claude Code integration.</p>

                <div class="space-y-6 mt-8">
                    <details class="details-card" open>
                        <summary class="details-summary">
                            <span class="details-icon">üìã</span>
                            <span class="details-title">Complete devcontainer.json Configuration</span>
                        </summary>
                        <div class="details-content">
                            <div class="code-block">
                                <button class="copy-btn" onclick="copyCode(this)" aria-label="Copy code">Copy</button>
                                <pre><code class="language-json">{
  "name": "React Dev Container",
  "build": {
    "dockerfile": "Dockerfile",
    "context": "."
  },
  "customizations": {
    "vscode": {
      "extensions": [
        "anthropic.claude-code",
        "dbaeumer.vscode-eslint",
        "esbenp.prettier-vscode",
        "bradlc.vscode-tailwindcss"
      ],
      "settings": {
        "editor.formatOnSave": true,
        "editor.defaultFormatter": "esbenp.prettier-vscode",
        "eslint.validate": ["javascript", "javascriptreact", "typescript", "typescriptreact"],
        "tailwindCSS.experimental.classRegex": [
          ["cva\\(([^)]*)\\)", "[\"'`]([^\"'`]*).*?[\"'`]"]
        ]
      }
    }
  },
  "runArgs": [
    "--cap-drop=ALL",
    "--cap-add=NET_ADMIN",
    "--cap-add=NET_RAW",
    "--cap-add=SETUID",
    "--cap-add=SETGID",
    "--cap-add=SYS_ADMIN",
    "--sysctl=net.ipv6.conf.all.disable_ipv6=1",
    "--sysctl=net.ipv6.conf.default.disable_ipv6=1",
    "--sysctl=net.ipv6.conf.lo.disable_ipv6=1"
  ],
  "forwardPorts": [3000, 5173, 8080],
  "postCreateCommand": "npm install && /usr/local/bin/init-claude-config.sh && /usr/local/bin/init-claude-hooks.sh",
  "postStartCommand": "sudo /usr/local/bin/init-firewall.sh",
  "remoteUser": "node",
  "mounts": [
    "source=claude-code-bashhistory-${devcontainerId},target=/commandhistory,type=volume",
    "source=claude-config-${devcontainerId},target=/home/node/.claude,type=volume",
    "source=codex-config-${devcontainerId},target=/home/node/.codex,type=volume",
    "source=gemini-config-${devcontainerId},target=/home/node/.gemini,type=volume",
    "source=opencode-config-${devcontainerId},target=/home/node/.opencode,type=volume",
    "source=ghub-config-${devcontainerId},target=/home/node/.config/gh,type=volume",
    "source=npm-global-${devcontainerId},target=/home/node/.npm-global,type=volume",
    "source=cargo-${devcontainerId},target=/home/node/.cargo,type=volume",
    "source=bun-${devcontainerId},target=/home/node/.bun,type=volume",
    "source=local-bin-${devcontainerId},target=/home/node/.local,type=volume",
    "source=aws-config-${devcontainerId},target=/home/node/.aws,type=volume",
    "source=wrangler-config-${devcontainerId},target=/home/node/.wrangler,type=volume",
    "source=vercel-config-${devcontainerId},target=/home/node/.vercel,type=volume"
  ]
}</code></pre>
                            </div>

                            <div class="callout callout-success">
                                <span class="callout-icon">üí°</span>
                                <strong>What's configured:</strong>
                                <ul>
                                    <li><strong>All 13 volumes:</strong> Complete persistence for configs, caches, and tools</li>
                                    <li><strong>Port forwarding:</strong> 3000 (CRA/Next.js), 5173 (Vite), 8080 (custom)</li>
                                    <li><strong>VS Code extensions:</strong> ESLint, Prettier, Tailwind CSS IntelliSense</li>
                                    <li><strong>Format on save:</strong> Automatic code formatting with Prettier</li>
                                    <li><strong>Security runArgs:</strong> Minimal capabilities for firewall operation</li>
                                </ul>
                            </div>
                        </div>
                    </details>

                    <details class="details-card">
                        <summary class="details-summary">
                            <span class="details-icon">üê≥</span>
                            <span class="details-title">Complete Dockerfile</span>
                        </summary>
                        <div class="details-content">
                            <div class="code-block">
                                <button class="copy-btn" onclick="copyCode(this)" aria-label="Copy code">Copy</button>
                                <pre><code class="language-dockerfile"># Start from Node.js 22 base (LTS with modern features)
FROM mcr.microsoft.com/devcontainers/javascript-node:22-bookworm

# Install system dependencies and firewall tools
RUN apt-get update && apt-get install -y \
    git \
    curl \
    build-essential \
    iptables \
    ipset \
    dnsutils \
    aggregate \
    jq \
    sudo \
    && rm -rf /var/lib/apt/lists/*

# Install Claude Code CLI
RUN curl -fsSL https://claude.ai/install.sh | bash

# Create directory for Claude Code defaults
RUN mkdir -p /usr/local/share/claude-defaults

# Copy initialization scripts and templates
COPY init-firewall.sh /usr/local/bin/
COPY init-claude-config.sh /usr/local/bin/
COPY init-claude-hooks.sh /usr/local/bin/
COPY --chown=node:node settings.json.template /usr/local/share/claude-defaults/settings.json
COPY --chown=node:node mcp.json.template /usr/local/share/claude-defaults/mcp.json

# Set permissions and configure sudoers for scripts
RUN chmod +x /usr/local/bin/init-firewall.sh && \
    chmod +x /usr/local/bin/init-claude-config.sh && \
    chmod +x /usr/local/bin/init-claude-hooks.sh && \
    echo "node ALL=(root) NOPASSWD: /usr/local/bin/init-firewall.sh" > /etc/sudoers.d/node-firewall && \
    echo "node ALL=(root) NOPASSWD: /usr/local/bin/init-claude-config.sh" > /etc/sudoers.d/node-claude-config && \
    chmod 0440 /etc/sudoers.d/node-firewall && \
    chmod 0440 /etc/sudoers.d/node-claude-config

# Set working directory
WORKDIR /workspaces

# Switch to non-root user
USER node

# Install global npm packages for React development
RUN npm install -g typescript @types/node vite create-react-app

# Set npm to use the npm-global volume for global packages
ENV NPM_CONFIG_PREFIX=/home/node/.npm-global
ENV PATH="/home/node/.npm-global/bin:$PATH"</code></pre>
                            </div>

                            <div class="callout callout-info">
                                <span class="callout-icon">üîç</span>
                                <strong>Key features:</strong>
                                <ul>
                                    <li><strong>Node.js 22 LTS:</strong> Latest long-term support version with modern JavaScript features</li>
                                    <li><strong>Firewall tools:</strong> Complete iptables + ipset + domain resolution for security</li>
                                    <li><strong>Global tools:</strong> TypeScript, Vite, Create React App pre-installed</li>
                                    <li><strong>Init scripts:</strong> Automated firewall setup + Claude config deployment</li>
                                    <li><strong>npm-global volume:</strong> Persists globally installed packages across rebuilds</li>
                                </ul>
                            </div>
                        </div>
                    </details>

                    <details class="details-card">
                        <summary class="details-summary">
                            <span class="details-icon">üöÄ</span>
                            <span class="details-title">Quick Start Guide</span>
                        </summary>
                        <div class="details-content">
                            <h4 class="font-semibold mb-3">Create a new React project:</h4>

                            <p class="mb-2"><strong>Using Vite (recommended - fastest):</strong></p>
                            <div class="code-block">
                                <button class="copy-btn" onclick="copyCode(this)" aria-label="Copy code">Copy</button>
                                <pre><code class="language-bash">npm create vite@latest my-app -- --template react-ts
cd my-app
npm install
npm run dev</code></pre>
                            </div>

                            <p class="mb-2 mt-4"><strong>Using Create React App:</strong></p>
                            <div class="code-block">
                                <button class="copy-btn" onclick="copyCode(this)" aria-label="Copy code">Copy</button>
                                <pre><code class="language-bash">npx create-react-app my-app --template typescript
cd my-app
npm start</code></pre>
                            </div>

                            <p class="mb-2 mt-4"><strong>Using Next.js:</strong></p>
                            <div class="code-block">
                                <button class="copy-btn" onclick="copyCode(this)" aria-label="Copy code">Copy</button>
                                <pre><code class="language-bash">npx create-next-app@latest my-app --typescript --tailwind --app
cd my-app
npm run dev</code></pre>
                            </div>

                            <div class="callout callout-success mt-4">
                                <span class="callout-icon">üéâ</span>
                                <strong>Your app is now running!</strong> Open <code>http://localhost:3000</code> (CRA/Next.js) or <code>http://localhost:5173</code> (Vite) in your browser.
                            </div>
                        </div>
                    </details>
                </div>
            </div>
        </section>

        <!-- Next.js Example -->
        <section id="nextjs-example" class="section section-alt">
            <div class="container">
                <h2 class="section-title">‚ö° Next.js Development Container</h2>
                <p class="text-lg">A production-ready Next.js development environment with TypeScript, Tailwind CSS, and modern tooling.</p>

                <div class="space-y-6 mt-8">
                    <details class="details-card" open>
                        <summary class="details-summary">
                            <span class="details-icon">üìã</span>
                            <span class="details-title">Complete devcontainer.json Configuration</span>
                        </summary>
                        <div class="details-content">
                            <div class="code-block">
                                <button class="copy-btn" onclick="copyCode(this)" aria-label="Copy code">Copy</button>
                                <pre><code class="language-json">{
  "name": "Next.js Dev Container",
  "build": {
    "dockerfile": "Dockerfile"
  },
  "customizations": {
    "vscode": {
      "extensions": [
        "anthropic.claude-code",
        "dbaeumer.vscode-eslint",
        "esbenp.prettier-vscode",
        "bradlc.vscode-tailwindcss"
      ],
      "settings": {
        "editor.formatOnSave": true,
        "editor.defaultFormatter": "esbenp.prettier-vscode",
        "typescript.preferences.importModuleSpecifier": "relative"
      }
    }
  },
  "runArgs": [
    "--cap-drop=ALL",
    "--cap-add=NET_ADMIN",
    "--cap-add=NET_RAW",
    "--cap-add=SETUID",
    "--cap-add=SETGID",
    "--cap-add=SYS_ADMIN",
    "--sysctl=net.ipv6.conf.all.disable_ipv6=1",
    "--sysctl=net.ipv6.conf.default.disable_ipv6=1",
    "--sysctl=net.ipv6.conf.lo.disable_ipv6=1"
  ],
  "forwardPorts": [3000],
  "postCreateCommand": "npm install && /usr/local/bin/init-claude-config.sh && /usr/local/bin/init-claude-hooks.sh",
  "postStartCommand": "sudo /usr/local/bin/init-firewall.sh",
  "remoteUser": "node",
  "mounts": [
    "source=claude-code-bashhistory-${devcontainerId},target=/commandhistory,type=volume",
    "source=claude-config-${devcontainerId},target=/home/node/.claude,type=volume",
    "source=codex-config-${devcontainerId},target=/home/node/.codex,type=volume",
    "source=gemini-config-${devcontainerId},target=/home/node/.gemini,type=volume",
    "source=opencode-config-${devcontainerId},target=/home/node/.opencode,type=volume",
    "source=ghub-config-${devcontainerId},target=/home/node/.config/gh,type=volume",
    "source=npm-global-${devcontainerId},target=/home/node/.npm-global,type=volume",
    "source=cargo-${devcontainerId},target=/home/node/.cargo,type=volume",
    "source=bun-${devcontainerId},target=/home/node/.bun,type=volume",
    "source=local-bin-${devcontainerId},target=/home/node/.local,type=volume",
    "source=aws-config-${devcontainerId},target=/home/node/.aws,type=volume",
    "source=wrangler-config-${devcontainerId},target=/home/node/.wrangler,type=volume",
    "source=vercel-config-${devcontainerId},target=/home/node/.vercel,type=volume"
  ]
}</code></pre>
                            </div>

                            <div class="callout callout-success">
                                <span class="callout-icon">üí°</span>
                                <strong>What's configured:</strong>
                                <ul>
                                    <li><strong>Port 3000:</strong> Next.js default development server port</li>
                                    <li><strong>All 13 volumes:</strong> Complete persistence for configs, caches, and tools</li>
                                    <li><strong>TypeScript settings:</strong> Optimized for Next.js import conventions</li>
                                    <li><strong>Tailwind CSS extension:</strong> IntelliSense for Tailwind classes in JSX/TSX</li>
                                    <li><strong>Security runArgs:</strong> Minimal capabilities for firewall operation</li>
                                </ul>
                            </div>

                            <div class="callout callout-info">
                                <span class="callout-icon">üîß</span>
                                <strong>Customize for Your Stack:</strong> Next.js projects often need additional tool persistence:
                                <ul>
                                    <li>Playwright browsers: <code>~/.cache/ms-playwright</code></li>
                                    <li>Turborepo cache: <code>~/.turbo</code></li>
                                    <li>Vercel CLI: <code>~/.vercel</code> (already included)</li>
                                    <li>Docker CLI: <code>~/.docker</code></li>
                                </ul>
                                Add volumes for your deployment and testing tools.
                            </div>
                        </div>
                    </details>

                    <details class="details-card">
                        <summary class="details-summary">
                            <span class="details-icon">üê≥</span>
                            <span class="details-title">Complete Dockerfile</span>
                        </summary>
                        <div class="details-content">
                            <div class="code-block">
                                <button class="copy-btn" onclick="copyCode(this)" aria-label="Copy code">Copy</button>
                                <pre><code class="language-dockerfile"># Start from Node.js 22 LTS for optimal Next.js performance
FROM mcr.microsoft.com/devcontainers/javascript-node:22-bookworm

# Install system dependencies and firewall tools
RUN apt-get update && apt-get install -y \
    git \
    curl \
    vim \
    iptables \
    ipset \
    dnsutils \
    aggregate \
    jq \
    sudo \
    && rm -rf /var/lib/apt/lists/*

# Install Claude Code CLI
RUN curl -fsSL https://claude.ai/install.sh | bash

# Create directory for Claude Code defaults
RUN mkdir -p /usr/local/share/claude-defaults

# Copy initialization scripts and templates
COPY init-firewall.sh /usr/local/bin/
COPY init-claude-config.sh /usr/local/bin/
COPY init-claude-hooks.sh /usr/local/bin/
COPY --chown=node:node settings.json.template /usr/local/share/claude-defaults/settings.json
COPY --chown=node:node mcp.json.template /usr/local/share/claude-defaults/mcp.json

# Set permissions and configure sudoers for scripts
RUN chmod +x /usr/local/bin/init-firewall.sh && \
    chmod +x /usr/local/bin/init-claude-config.sh && \
    chmod +x /usr/local/bin/init-claude-hooks.sh && \
    echo "node ALL=(root) NOPASSWD: /usr/local/bin/init-firewall.sh" > /etc/sudoers.d/node-firewall && \
    echo "node ALL=(root) NOPASSWD: /usr/local/bin/init-claude-config.sh" > /etc/sudoers.d/node-claude-config && \
    chmod 0440 /etc/sudoers.d/node-firewall && \
    chmod 0440 /etc/sudoers.d/node-claude-config

# Set working directory
WORKDIR /workspaces

# Switch to non-root user
USER node

# Install global npm packages for Next.js development
RUN npm install -g typescript @types/node

# Set npm to use the npm-global volume for global packages
ENV NPM_CONFIG_PREFIX=/home/node/.npm-global
ENV PATH="/home/node/.npm-global/bin:$PATH"</code></pre>
                            </div>

                            <div class="callout callout-warning">
                                <span class="callout-icon">‚ö†Ô∏è</span>
                                <strong>Note:</strong> Next.js 13+ requires Node.js 16.14 or later. We're using Node 22 LTS for the best performance and latest features.
                            </div>
                        </div>
                    </details>

                    <details class="details-card">
                        <summary class="details-summary">
                            <span class="details-icon">üöÄ</span>
                            <span class="details-title">Quick Start Guide</span>
                        </summary>
                        <div class="details-content">
                            <h4 class="font-semibold mb-3">Create a new Next.js project:</h4>

                            <p class="mb-2"><strong>Using create-next-app (recommended):</strong></p>
                            <div class="code-block">
                                <button class="copy-btn" onclick="copyCode(this)" aria-label="Copy code">Copy</button>
                                <pre><code class="language-bash">npx create-next-app@latest my-app --typescript --tailwind --app
cd my-app
npm run dev</code></pre>
                            </div>

                            <h4 class="font-semibold mb-3 mt-6">Test your setup:</h4>
                            <div class="code-block">
                                <button class="copy-btn" onclick="copyCode(this)" aria-label="Copy code">Copy</button>
                                <pre><code class="language-bash"># Check Node.js version
node --version  # Should show v22.x.x

# Check npm version
npm --version

# Check Claude Code is installed
claude --version

# Start Next.js development server
npm run dev</code></pre>
                            </div>

                            <div class="callout callout-success mt-4">
                                <span class="callout-icon">üéâ</span>
                                <strong>Your Next.js app is now running!</strong> Open <code>http://localhost:3000</code> in your browser.
                            </div>

                            <div class="callout callout-primary mt-4">
                                <span class="callout-icon">‚úÖ</span>
                                <strong>Pro Tips:</strong>
                                <ul>
                                    <li>The npm cache volume persists between container rebuilds, making installs much faster</li>
                                    <li>Hot reload works perfectly - just save your files and see changes instantly</li>
                                    <li>Use Claude Code to help scaffold new pages, components, and API routes</li>
                                </ul>
                            </div>
                        </div>
                    </details>
                </div>
            </div>
        </section>

        <!-- Python Example (Basic) -->
        <section id="python-basic-example" class="section">
            <div class="container">
                <h2 class="section-title">üêç Python Development Container (Basic)</h2>
                <p class="text-lg">A modern Python 3.14 development environment using Node.js 22 base + uv package manager for fast, reliable dependency management.</p>

                <div class="space-y-6 mt-8">
                    <details class="details-card" open>
                        <summary class="details-summary">
                            <span class="details-icon">üìã</span>
                            <span class="details-title">Complete devcontainer.json Configuration</span>
                        </summary>
                        <div class="details-content">
                            <div class="code-block">
                                <button class="copy-btn" onclick="copyCode(this)" aria-label="Copy code">Copy</button>
                                <pre><code class="language-json">{
  "name": "Python Dev Container",
  "build": {
    "dockerfile": "Dockerfile"
  },
  "customizations": {
    "vscode": {
      "extensions": [
        "anthropic.claude-code",
        "ms-python.python",
        "ms-python.vscode-pylance",
        "ms-python.debugpy",
        "charliermarsh.ruff"
      ],
      "settings": {
        "python.defaultInterpreterPath": "/usr/local/bin/python",
        "python.linting.enabled": true,
        "editor.formatOnSave": true
      }
    }
  },
  "runArgs": [
    "--cap-drop=ALL",
    "--cap-add=NET_ADMIN",
    "--cap-add=NET_RAW",
    "--cap-add=SETUID",
    "--cap-add=SETGID",
    "--cap-add=SYS_ADMIN",
    "--sysctl=net.ipv6.conf.all.disable_ipv6=1",
    "--sysctl=net.ipv6.conf.default.disable_ipv6=1",
    "--sysctl=net.ipv6.conf.lo.disable_ipv6=1"
  ],
  "forwardPorts": [5000, 8000],
  "postCreateCommand": "/usr/local/bin/init-claude-config.sh && /usr/local/bin/init-python.sh && /usr/local/bin/init-claude-hooks.sh && uv pip install -r requirements.txt",
  "postStartCommand": "sudo /usr/local/bin/init-firewall.sh",
  "remoteUser": "node",
  "mounts": [
    "source=claude-code-bashhistory-${devcontainerId},target=/commandhistory,type=volume",
    "source=claude-config-${devcontainerId},target=/home/node/.claude,type=volume",
    "source=ghub-config-${devcontainerId},target=/home/node/.config/gh,type=volume",
    "source=npm-global-${devcontainerId},target=/home/node/.npm-global,type=volume",
    "source=cargo-${devcontainerId},target=/home/node/.cargo,type=volume",
    "source=local-bin-${devcontainerId},target=/home/node/.local,type=volume",
    "source=aws-config-${devcontainerId},target=/home/node/.aws,type=volume"
  ]
}</code></pre>
                            </div>

                            <div class="callout callout-success">
                                <span class="callout-icon">üí°</span>
                                <strong>What's configured:</strong>
                                <ul>
                                    <li><strong>7 essential volumes:</strong> Bash history, Claude config, GitHub CLI, npm-global, cargo (for uv), local-bin (Python), AWS CLI</li>
                                    <li><strong>Port forwarding:</strong> 5000 (Flask), 8000 (FastAPI/Django)</li>
                                    <li><strong>VS Code extensions:</strong> Python, Pylance, debugpy, Ruff linter/formatter</li>
                                    <li><strong>uv package manager:</strong> 10-100x faster than pip for dependency installation</li>
                                    <li><strong>Python 3.14:</strong> Installed via init-python.sh in postCreateCommand</li>
                                </ul>
                            </div>
                        </div>
                    </details>

                    <details class="details-card">
                        <summary class="details-summary">
                            <span class="details-icon">üê≥</span>
                            <span class="details-title">Complete Dockerfile</span>
                        </summary>
                        <div class="details-content">
                            <div class="code-block">
                                <button class="copy-btn" onclick="copyCode(this)" aria-label="Copy code">Copy</button>
                                <pre><code class="language-dockerfile"># Start from Node.js 22 base (modern approach with Python 3.14 via uv)
FROM mcr.microsoft.com/devcontainers/javascript-node:22-bookworm

# Install system dependencies and firewall tools
RUN apt-get update && apt-get install -y \
    git \
    curl \
    build-essential \
    iptables \
    ipset \
    dnsutils \
    aggregate \
    jq \
    sudo \
    python3.11 \
    python3.11-dev \
    python3-pip \
    && rm -rf /var/lib/apt/lists/*

# Install uv (fast Python package manager)
# uv installer places binary at /home/node/.local/bin/uv
USER node
RUN curl -LsSf https://astral.sh/uv/install.sh | sh && \
    echo 'export PATH="$HOME/.local/bin:$PATH"' >> /home/node/.bashrc
ENV PATH="/home/node/.local/bin:$PATH"

# Switch back to root for system configuration
USER root

# Install Claude Code CLI
RUN curl -fsSL https://claude.ai/install.sh | bash

# Create directory for Claude Code defaults
RUN mkdir -p /usr/local/share/claude-defaults

# Copy initialization scripts and templates
COPY init-firewall.sh /usr/local/bin/
COPY init-claude-config.sh /usr/local/bin/
COPY init-python.sh /usr/local/bin/
COPY --chown=node:node settings.json.template /usr/local/share/claude-defaults/settings.json
COPY --chown=node:node mcp.json.template /usr/local/share/claude-defaults/mcp.json

# Set permissions and configure sudoers for scripts
RUN chmod +x /usr/local/bin/init-firewall.sh && \
    chmod +x /usr/local/bin/init-claude-config.sh && \
    chmod +x /usr/local/bin/init-python.sh && \
    echo "node ALL=(root) NOPASSWD: /usr/local/bin/init-firewall.sh" > /etc/sudoers.d/node-firewall && \
    echo "node ALL=(root) NOPASSWD: /usr/local/bin/init-claude-config.sh" > /etc/sudoers.d/node-claude-config && \
    echo "node ALL=(root) NOPASSWD: /usr/local/bin/init-python.sh" > /etc/sudoers.d/node-python && \
    chmod 0440 /etc/sudoers.d/node-firewall && \
    chmod 0440 /etc/sudoers.d/node-claude-config && \
    chmod 0440 /etc/sudoers.d/node-python

# Set working directory
WORKDIR /workspaces

# Switch to non-root user
USER node

# Set Python to unbuffered mode (better for logs)
ENV PYTHONUNBUFFERED=1

# NOTE: Python 3.14 is installed via init-python.sh in postCreateCommand
# This ensures installation persists in /home/node/.local volume</code></pre>
                            </div>

                            <div class="callout callout-info">
                                <span class="callout-icon">üîç</span>
                                <strong>Key differences from React setup:</strong>
                                <ul>
                                    <li><strong>Node.js 22 base:</strong> Modern approach combining Node.js and Python 3.14 via uv</li>
                                    <li><strong>Python 3.11 system package:</strong> Installed for node-gyp compatibility</li>
                                    <li><strong>uv package manager:</strong> Fast Python package manager for Python 3.14 installation</li>
                                    <li><strong>build-essential:</strong> Needed for packages that compile C extensions</li>
                                    <li><strong>init-python.sh:</strong> Installs Python 3.14 during postCreateCommand</li>
                                    <li><strong>PYTHONUNBUFFERED=1:</strong> Makes print() output appear immediately in logs</li>
                                </ul>
                            </div>
                        </div>
                    </details>

                    <details class="details-card">
                        <summary class="details-summary">
                            <span class="details-icon">üöÄ</span>
                            <span class="details-title">Quick Start Guide</span>
                        </summary>
                        <div class="details-content">
                            <h4 class="font-semibold mb-3">Create requirements.txt:</h4>

                            <p class="mb-2"><strong>For Flask:</strong></p>
                            <div class="code-block">
                                <button class="copy-btn" onclick="copyCode(this)" aria-label="Copy code">Copy</button>
                                <pre><code class="language-text">flask==3.0.0
python-dotenv==1.0.0
requests==2.31.0</code></pre>
                            </div>

                            <p class="mb-2 mt-4"><strong>For FastAPI:</strong></p>
                            <div class="code-block">
                                <button class="copy-btn" onclick="copyCode(this)" aria-label="Copy code">Copy</button>
                                <pre><code class="language-text">fastapi==0.104.0
uvicorn[standard]==0.24.0
python-dotenv==1.0.0
pydantic==2.5.0</code></pre>
                            </div>

                            <h4 class="font-semibold mb-3 mt-6">Test your setup:</h4>
                            <div class="code-block">
                                <button class="copy-btn" onclick="copyCode(this)" aria-label="Copy code">Copy</button>
                                <pre><code class="language-bash"># Check Python version
python --version  # Should show Python 3.14.x

# Check pip version
pip --version

# Verify dependencies installed
pip list

# Run Flask app (example)
python app.py

# Or run FastAPI app (example)
uvicorn main:app --reload --host 0.0.0.0 --port 8000</code></pre>
                            </div>

                            <div class="callout callout-success mt-4">
                                <span class="callout-icon">üéâ</span>
                                <strong>Your Python app is running!</strong> Open <code>http://localhost:5000</code> (Flask) or <code>http://localhost:8000</code> (FastAPI) in your browser.
                            </div>
                        </div>
                    </details>
                </div>
            </div>
        </section>

        <!-- Python Example (Advanced) -->
        <section id="python-advanced-example" class="section">
            <div class="container">
                <h2 class="section-title">‚ö° Advanced Python Development Container</h2>
                <p class="text-lg">A production-ready Python environment with extended libraries, modern tooling (uv + bun), and support for hybrid Python/JavaScript projects.</p>

                <div class="callout callout-primary mb-6">
                    <span class="callout-icon">‚ö°</span>
                    <strong>What's included:</strong>
                    <ul>
                        <li><strong>uv:</strong> Fast Python package manager (10-100x faster than pip) + version management</li>
                        <li><strong>bun:</strong> JavaScript runtime for hybrid Python/JS projects (React, Vue, Svelte frontends)</li>
                        <li><strong>Extended libraries:</strong> Development libraries for data science, web scraping, and native extensions</li>
                        <li><strong>Modern tools:</strong> ripgrep, fd-find, jq, yq for faster development</li>
                        <li><strong>Jupyter:</strong> Jupyter Lab/Notebook for data science and interactive development</li>
                    </ul>
                </div>

                <div class="space-y-6 mt-8">
                    <details class="details-card" open>
                        <summary class="details-summary">
                            <span class="details-icon">üìã</span>
                            <span class="details-title">Complete devcontainer.json Configuration</span>
                        </summary>
                        <div class="details-content">
                            <div class="code-block">
                                <button class="copy-btn" onclick="copyCode(this)" aria-label="Copy code">Copy</button>
                                <pre><code class="language-json">{
  "name": "Advanced Python Dev Container",
  "build": {
    "dockerfile": "Dockerfile"
  },
  "customizations": {
    "vscode": {
      "extensions": [
        "anthropic.claude-code",
        "ms-python.python",
        "ms-python.vscode-pylance",
        "ms-python.debugpy",
        "ms-python.black-formatter",
        "charliermarsh.ruff"
      ],
      "settings": {
        "python.defaultInterpreterPath": "/usr/local/bin/python",
        "python.linting.enabled": true,
        "python.formatting.provider": "black",
        "editor.formatOnSave": true
      }
    }
  },
  "runArgs": [
    "--cap-drop=ALL",
    "--cap-add=NET_ADMIN",
    "--cap-add=NET_RAW",
    "--cap-add=SETUID",
    "--cap-add=SETGID",
    "--cap-add=SYS_ADMIN",
    "--sysctl=net.ipv6.conf.all.disable_ipv6=1",
    "--sysctl=net.ipv6.conf.default.disable_ipv6=1",
    "--sysctl=net.ipv6.conf.lo.disable_ipv6=1"
  ],
  "forwardPorts": [5000, 8000, 8888],
  "postCreateCommand": "uv pip install -r requirements.txt && /usr/local/bin/init-claude-config.sh && /usr/local/bin/init-python.sh && /usr/local/bin/init-claude-hooks.sh",
  "postStartCommand": "sudo /usr/local/bin/init-firewall.sh",
  "remoteUser": "node",
  "mounts": [
    "source=claude-code-bashhistory-${devcontainerId},target=/commandhistory,type=volume",
    "source=claude-config-${devcontainerId},target=/home/node/.claude,type=volume",
    "source=codex-config-${devcontainerId},target=/home/node/.codex,type=volume",
    "source=gemini-config-${devcontainerId},target=/home/node/.gemini,type=volume",
    "source=opencode-config-${devcontainerId},target=/home/node/.opencode,type=volume",
    "source=ghub-config-${devcontainerId},target=/home/node/.config/gh,type=volume",
    "source=cargo-${devcontainerId},target=/home/node/.cargo,type=volume",
    "source=bun-${devcontainerId},target=/home/node/.bun,type=volume",
    "source=local-bin-${devcontainerId},target=/home/node/.local,type=volume"
  ]
}</code></pre>
                            </div>

                            <div class="callout callout-success">
                                <span class="callout-icon">üí°</span>
                                <strong>What's different from basic setup:</strong>
                                <ul>
                                    <li><strong>Port 8888:</strong> Added for Jupyter Lab/Notebook</li>
                                    <li><strong>uv pip install:</strong> Uses uv for 10-100x faster package installation</li>
                                    <li><strong>cargo volume:</strong> Persists uv installation and Rust tools</li>
                                    <li><strong>bun volume:</strong> Persists bun installation for hybrid projects</li>
                                    <li><strong>Black formatter:</strong> Python code formatting with Black</li>
                                </ul>
                            </div>

                            <div class="callout callout-info">
                                <span class="callout-icon">üîß</span>
                                <strong>Customize for your infrastructure:</strong> This advanced setup already includes cargo (for uv/Rust tools) and bun. Add more volumes as needed:
                                <ul>
                                    <li>PostgreSQL CLI: <code>~/.psqlrc</code></li>
                                    <li>Redis CLI: <code>~/.redisclirc</code></li>
                                    <li>Docker: <code>~/.docker</code></li>
                                    <li>Kubernetes: <code>~/.kube</code></li>
                                </ul>
                            </div>
                        </div>
                    </details>

                    <details class="details-card">
                        <summary class="details-summary">
                            <span class="details-icon">üê≥</span>
                            <span class="details-title">Complete Dockerfile (Advanced)</span>
                        </summary>
                        <div class="details-content">
                            <div class="code-block">
                                <button class="copy-btn" onclick="copyCode(this)" aria-label="Copy code">Copy</button>
                                <pre><code class="language-dockerfile"># Start from Node.js 22 base (modern approach with Python 3.14 via uv)
FROM mcr.microsoft.com/devcontainers/javascript-node:22-bookworm

# Install extended system dependencies (organized by category)
RUN apt-get update && apt-get install -y \
    # Version control
    git \
    git-lfs \
    # Core utilities
    curl \
    wget \
    ca-certificates \
    # Build tools for native extensions
    build-essential \
    gcc \
    g++ \
    make \
    cmake \
    pkg-config \
    # Development libraries (for data science, web scraping, crypto)
    libffi-dev \
    libssl-dev \
    libz-dev \
    libbz2-dev \
    libreadline-dev \
    libsqlite3-dev \
    libncurses5-dev \
    libncursesw5-dev \
    liblzma-dev \
    # Text processing and data tools
    jq \
    yq \
    sed \
    gawk \
    # Modern search tools (faster alternatives)
    ripgrep \
    fd-find \
    # System utilities
    htop \
    tree \
    procps \
    # Network tools
    net-tools \
    iputils-ping \
    dnsutils \
    # Firewall tools
    iptables \
    ipset \
    aggregate \
    sudo \
    # Text editors
    vim \
    nano \
    # Locales for proper encoding
    locales \
    # Python 3.11 (system Python for node-gyp compatibility)
    python3.11 \
    python3.11-dev \
    python3-pip \
    && rm -rf /var/lib/apt/lists/*

# Set up locale (prevents encoding issues)
RUN sed -i -e 's/# en_US.UTF-8 UTF-8/en_US.UTF-8 UTF-8/' /etc/locale.gen && \
    locale-gen
ENV LANG=en_US.UTF-8 \
    LANGUAGE=en_US:en \
    LC_ALL=en_US.UTF-8

# NOTE: Using 'node' user from base image (no need to create vscode user)

# Install Claude Code CLI
RUN curl -fsSL https://claude.ai/install.sh | bash

# Create directory for Claude Code defaults
RUN mkdir -p /usr/local/share/claude-defaults

# Copy initialization scripts and templates
COPY init-firewall.sh /usr/local/bin/
COPY init-claude-config.sh /usr/local/bin/
COPY init-python.sh /usr/local/bin/
COPY --chown=node:node settings.json.template /usr/local/share/claude-defaults/settings.json
COPY --chown=node:node mcp.json.template /usr/local/share/claude-defaults/mcp.json

# Set permissions and configure sudoers for scripts
RUN chmod +x /usr/local/bin/init-firewall.sh && \
    chmod +x /usr/local/bin/init-claude-config.sh && \
    chmod +x /usr/local/bin/init-python.sh && \
    echo "node ALL=(root) NOPASSWD: /usr/local/bin/init-firewall.sh" > /etc/sudoers.d/node-firewall && \
    echo "node ALL=(root) NOPASSWD: /usr/local/bin/init-claude-config.sh" > /etc/sudoers.d/node-claude-config && \
    echo "node ALL=(root) NOPASSWD: /usr/local/bin/init-python.sh" > /etc/sudoers.d/node-python && \
    chmod 0440 /etc/sudoers.d/node-firewall && \
    chmod 0440 /etc/sudoers.d/node-claude-config && \
    chmod 0440 /etc/sudoers.d/node-python

# Set working directory
WORKDIR /workspaces

# Install Python dev tools globally
RUN pip install --no-cache-dir \
    black \
    pylint \
    pytest \
    ipython \
    jupyter \
    jupyterlab

# Switch to non-root user
USER node

# Install uv (fast Python package manager + version management)
# uv installer places binary at /home/node/.local/bin/uv
RUN curl -LsSf https://astral.sh/uv/install.sh | sh && \
    echo 'export PATH="$HOME/.local/bin:$PATH"' >> /home/node/.bashrc
ENV PATH="/home/node/.local/bin:$PATH"

# Install bun (for Python projects with JS/TS frontends)
RUN curl -fsSL https://bun.sh/install | bash && \
    echo 'export BUN_INSTALL="$HOME/.bun"' >> /home/node/.bashrc && \
    echo 'export PATH="$BUN_INSTALL/bin:$PATH"' >> /home/node/.bashrc
ENV BUN_INSTALL="/home/node/.bun"
ENV PATH="$BUN_INSTALL/bin:$PATH"

# Set Python to unbuffered mode (better for logs)
ENV PYTHONUNBUFFERED=1

# NOTE: Python 3.14 is installed via init-python.sh in postCreateCommand
# This ensures installation persists in /home/node/.local volume</code></pre>
                            </div>

                            <div class="callout callout-info">
                                <span class="callout-icon">üîç</span>
                                <strong>Key additions for advanced setup:</strong>
                                <ul>
                                    <li><strong>Extended libraries:</strong> Support SQLite, compression (lzma), SSL, foreign function interface</li>
                                    <li><strong>Modern tools:</strong> ripgrep (rg) and fd-find for faster code/file search than grep/find</li>
                                    <li><strong>uv:</strong> Installed as non-root user, 10-100x faster than pip</li>
                                    <li><strong>bun:</strong> For hybrid Python/JavaScript projects (Django + React, Flask + Vue, etc.)</li>
                                    <li><strong>Jupyter/JupyterLab:</strong> For data science and interactive development</li>
                                    <li><strong>Locale configuration:</strong> Prevents encoding issues with UTF-8</li>
                                </ul>
                            </div>
                        </div>
                    </details>

                    <details class="details-card">
                        <summary class="details-summary">
                            <span class="details-icon">üöÄ</span>
                            <span class="details-title">Usage & Verification</span>
                        </summary>
                        <div class="details-content">
                            <h4 class="font-semibold mb-3">Install dependencies:</h4>

                            <p class="mb-2"><strong>Using traditional pip:</strong></p>
                            <div class="code-block">
                                <button class="copy-btn" onclick="copyCode(this)" aria-label="Copy code">Copy</button>
                                <pre><code class="language-bash">pip install -r requirements.txt
pip list</code></pre>
                            </div>

                            <p class="mb-2 mt-4"><strong>Using uv (10-100x faster):</strong></p>
                            <div class="code-block">
                                <button class="copy-btn" onclick="copyCode(this)" aria-label="Copy code">Copy</button>
                                <pre><code class="language-bash">uv pip install -r requirements.txt
uv pip list</code></pre>
                            </div>

                            <div class="callout callout-primary mt-4">
                                <span class="callout-icon">‚ö°</span>
                                <strong>Why uv is faster:</strong>
                                <ul>
                                    <li>Written in Rust (compiled language vs Python)</li>
                                    <li>Parallel package downloads and installations</li>
                                    <li>Better dependency resolution algorithm</li>
                                    <li>Drop-in replacement for pip - same commands, faster execution</li>
                                </ul>
                            </div>

                            <h4 class="font-semibold mb-3 mt-6">Verify installation:</h4>
                            <div class="code-block">
                                <button class="copy-btn" onclick="copyCode(this)" aria-label="Copy code">Copy</button>
                                <pre><code class="language-bash"># Verify Python
python --version  # Should show Python 3.14.x

# Verify pip
pip --version

# Verify uv
uv --version

# Verify bun (for hybrid projects)
bun --version

# Verify modern tools
rg --version    # ripgrep (fast search)
fdfind --version # fd (fast find)
jq --version    # JSON processor

# Test your Flask/FastAPI app
python app.py
# or
uvicorn main:app --reload --host 0.0.0.0 --port 8000</code></pre>
                            </div>

                            <div class="callout callout-success mt-4">
                                <span class="callout-icon">üéâ</span>
                                <strong>Your advanced Python environment is ready!</strong> All tools are installed and configured for production development.
                            </div>
                        </div>
                    </details>
                </div>
            </div>
        </section>

        <!-- Launching Your Dev Container Section (RESTORED) -->
        <section id="launching-container" class="section">
            <h2>üöÄ Launching Your Dev Container</h2>

            <p>Now that you understand dev containers and have configured your setup, here's how to launch and use them:</p>

            <div style="display: grid; gap: 1rem; margin-top: 2rem;">
                <div class="card">
                    <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 0.5rem;">
                        <h3 style="margin: 0; font-size: 1.125rem; font-weight: 600;">First Time Setup</h3>
                        <span style="font-size: 0.75rem; padding: 0.25rem 0.5rem; background-color: rgba(249, 115, 22, 0.1); color: var(--color-warning); border-radius: 0.25rem; font-weight: 500;">
                            Slower (5-10 min)
                        </span>
                    </div>
                    <div style="margin-top: 0.5rem;">
                        <div style="display: flex; align-items: center; gap: 0.5rem; font-size: 0.875rem; margin-bottom: 0.5rem;">
                            <kbd style="background-color: var(--color-bg-secondary); padding: 0.25rem 0.5rem; border-radius: 0.25rem; font-size: 0.75rem;">Cmd+Shift+P</kbd>
                            <span style="color: var(--color-text-secondary);">(Mac)</span>
                            <span style="color: var(--color-text-tertiary);">or</span>
                            <kbd style="background-color: var(--color-bg-secondary); padding: 0.25rem 0.5rem; border-radius: 0.25rem; font-size: 0.75rem;">Ctrl+Shift+P</kbd>
                            <span style="color: var(--color-text-secondary);">(Windows/Linux)</span>
                        </div>
                        <div style="display: flex; align-items: center; gap: 0.5rem; font-size: 0.875rem;">
                            <span style="color: var(--color-text-secondary);">‚Üí</span>
                            <code style="background-color: var(--color-bg-secondary); padding: 0.25rem 0.5rem; border-radius: 0.25rem; font-size: 0.75rem;">Dev Containers: Open Folder in Container</code>
                        </div>
                    </div>
                </div>

                <div class="card">
                    <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 0.5rem;">
                        <h3 style="margin: 0; font-size: 1.125rem; font-weight: 600;">Subsequent Launches</h3>
                        <span style="font-size: 0.75rem; padding: 0.25rem 0.5rem; background-color: rgba(34, 197, 94, 0.1); color: var(--color-success); border-radius: 0.25rem; font-weight: 500;">
                            Fast (&lt;30 sec)
                        </span>
                    </div>
                    <div style="margin-top: 0.5rem;">
                        <div style="display: flex; align-items: center; gap: 0.5rem; font-size: 0.875rem; margin-bottom: 0.5rem;">
                            <kbd style="background-color: var(--color-bg-secondary); padding: 0.25rem 0.5rem; border-radius: 0.25rem; font-size: 0.75rem;">Cmd+Shift+P</kbd>
                            <span style="color: var(--color-text-secondary);">(Mac)</span>
                            <span style="color: var(--color-text-tertiary);">or</span>
                            <kbd style="background-color: var(--color-bg-secondary); padding: 0.25rem 0.5rem; border-radius: 0.25rem; font-size: 0.75rem;">Ctrl+Shift+P</kbd>
                            <span style="color: var(--color-text-secondary);">(Windows/Linux)</span>
                        </div>
                        <div style="display: flex; align-items: center; gap: 0.5rem; font-size: 0.875rem;">
                            <span style="color: var(--color-text-secondary);">‚Üí</span>
                            <code style="background-color: var(--color-bg-secondary); padding: 0.25rem 0.5rem; border-radius: 0.25rem; font-size: 0.75rem;">Dev Containers: Reopen in Container</code>
                        </div>
                    </div>
                </div>
            </div>

            <div class="callout callout-info" style="margin-top: 1.5rem;">
                <p><strong>üí° Tip:</strong> VS Code will automatically prompt you with "Reopen in Container" when you open a folder containing a <code>.devcontainer</code> directory.</p>
            </div>
        </section>

        <!-- AI CLI Authentication -->
        <section id="ai-cli-auth" class="section section-alt">
            <div class="container">
                <h2 class="section-title">ü§ñ AI CLI Authentication</h2>
                <p class="text-lg mb-6">Before using Claude Code, Codex CLI, Gemini CLI, or OpenCode within your dev container, you need to authenticate each tool with its respective API service. Authentication is a one-time setup that persists across container rebuilds thanks to Docker volume mounts.</p>

                <div class="callout callout-info mb-8">
                    <span class="callout-icon">üí°</span>
                    <strong>Why AI CLI Authentication Matters:</strong>
                    <ul>
                        <li>Enables AI assistants to access their respective APIs for code generation and assistance</li>
                        <li>Credentials are stored in <code>~/.config/</code> directories that persist via Docker volumes</li>
                        <li>One-time setup per container - authentication survives container rebuilds</li>
                        <li>Each CLI uses different authentication methods (OAuth, API keys) suited to their service</li>
                    </ul>
                </div>

                <div class="space-y-8">
                    <!-- Claude Code Authentication -->
                    <details class="details-card" open>
                        <summary class="details-summary">
                            <span class="details-icon">üî∑</span>
                            <span class="details-title">1. Claude Code Authentication</span>
                        </summary>
                        <div class="details-content">
                            <p class="mb-4">Claude Code uses the <code>/login</code> slash command to authenticate with your Anthropic account. This opens a browser-based OAuth flow where you can choose between using your Claude subscription (Pro, Max, Team, Enterprise) or Anthropic Console account for API usage billing.</p>

                            <div class="code-block">
                                <button class="copy-btn" onclick="copyCode(this)" aria-label="Copy code">Copy</button>
                                <pre><code>/login</code></pre>
                            </div>

                            <div class="callout callout-success mt-4">
                                <span class="callout-icon">‚úÖ</span>
                                <strong>Authentication Persistence:</strong> Claude Code stores authentication tokens in <code>~/.config/claude/</code>, which is mounted as a Docker volume. Your login persists across container rebuilds, eliminating the need to re-authenticate after <code>devcontainer.json</code> changes.
                            </div>

                            <div class="callout callout-warning mt-4">
                                <span class="callout-icon">üîß</span>
                                <strong>Troubleshooting:</strong>
                                <ul>
                                    <li>If login fails, ensure Docker Desktop is forwarding ports correctly</li>
                                    <li>Browser may block popup - check for blocked popup notifications</li>
                                    <li>If already logged in elsewhere, you may need to sign out first</li>
                                </ul>
                            </div>
                        </div>
                    </details>

                    <!-- Codex CLI Authentication -->
                    <details class="details-card">
                        <summary class="details-summary">
                            <span class="details-icon">üî∑</span>
                            <span class="details-title">2. Codex CLI Authentication</span>
                        </summary>
                        <div class="details-content">
                            <p class="mb-4">Codex CLI uses OpenAI's authentication system via the <code>codex auth login</code> command. This starts a local server and opens your browser to authenticate with your OpenAI account. The CLI supports standard OpenAI authentication flow.</p>

                            <div class="code-block">
                                <button class="copy-btn" onclick="copyCode(this)" aria-label="Copy code">Copy</button>
                                <pre><code>codex auth login</code></pre>
                            </div>

                            <div class="callout callout-success mt-4">
                                <span class="callout-icon">‚úÖ</span>
                                <strong>Authentication Persistence:</strong> Codex CLI stores OAuth tokens in <code>~/.config/codex/</code>, mounted as a Docker volume. After initial authentication, the CLI maintains session across container rebuilds automatically.
                            </div>

                            <div class="callout callout-warning mt-4">
                                <span class="callout-icon">üîß</span>
                                <strong>Troubleshooting:</strong>
                                <ul>
                                    <li>Browser must be able to access localhost:1455 - check firewall settings</li>
                                    <li>If authentication fails, try clearing <code>~/.config/codex/</code> and re-authenticating</li>
                                    <li>Port forwarding may need to be configured in <code>devcontainer.json</code> for remote development</li>
                                </ul>
                            </div>
                        </div>
                    </details>

                    <!-- Gemini CLI Authentication -->
                    <details class="details-card">
                        <summary class="details-summary">
                            <span class="details-icon">üî∑</span>
                            <span class="details-title">3. Gemini CLI Authentication</span>
                        </summary>
                        <div class="details-content">
                            <p class="mb-4">Gemini CLI offers multiple authentication options via the <code>/auth</code> slash command. While OAuth with Google is available, using an API key is the <strong>recommended approach</strong> for dev container environments as it provides more reliable authentication without browser dependencies.</p>

                            <div class="code-block">
                                <button class="copy-btn" onclick="copyCode(this)" aria-label="Copy code">Copy</button>
                                <pre><code>/auth</code></pre>
                            </div>

                            <div class="callout callout-success mt-4">
                                <span class="callout-icon">‚úÖ</span>
                                <strong>Authentication Persistence:</strong> Gemini CLI stores API keys and OAuth tokens in <code>~/.config/gemini/</code>, mounted as a Docker volume. Configuration persists across container rebuilds.
                                <br><br>
                                <strong>API Key Recommendation:</strong> Select "Use Gemini API Key" option for most reliable container experience. Get your API key from <a href="https://aistudio.google.com/app/apikey" target="_blank" rel="noopener noreferrer" class="underline">Google AI Studio</a>.
                            </div>

                            <div class="callout callout-warning mt-4">
                                <span class="callout-icon">üîß</span>
                                <strong>Troubleshooting:</strong>
                                <ul>
                                    <li>If OAuth login fails, switch to API key authentication method</li>
                                    <li>API keys can be created and managed at <a href="https://aistudio.google.com/app/apikey" target="_blank" rel="noopener noreferrer" class="underline">Google AI Studio</a></li>
                                    <li>Verify API key has necessary permissions for Gemini models</li>
                                </ul>
                            </div>
                        </div>
                    </details>

                    <!-- OpenCode Authentication -->
                    <details class="details-card">
                        <summary class="details-summary">
                            <span class="details-icon">üî∑</span>
                            <span class="details-title">4. OpenCode Authentication</span>
                        </summary>
                        <div class="details-content">
                            <p class="mb-4">OpenCode is provider-agnostic and supports multiple AI providers. Configure your preferred provider using environment variables or the config command.</p>

                            <h4 class="font-semibold mb-3">Option 1: Anthropic (Claude)</h4>
                            <div class="code-block">
                                <button class="copy-btn" onclick="copyCode(this)" aria-label="Copy code">Copy</button>
                                <pre><code class="language-bash">export ANTHROPIC_API_KEY=YOUR_ANTHROPIC_API_KEY
opencode config set provider anthropic
opencode config set apiKey YOUR_ANTHROPIC_API_KEY</code></pre>
                            </div>

                            <h4 class="font-semibold mb-3 mt-6">Option 2: OpenAI</h4>
                            <div class="code-block">
                                <button class="copy-btn" onclick="copyCode(this)" aria-label="Copy code">Copy</button>
                                <pre><code class="language-bash">export OPENAI_API_KEY=YOUR_OPENAI_API_KEY
opencode config set provider openai</code></pre>
                            </div>

                            <h4 class="font-semibold mb-3 mt-6">Option 3: Google (Gemini)</h4>
                            <div class="code-block">
                                <button class="copy-btn" onclick="copyCode(this)" aria-label="Copy code">Copy</button>
                                <pre><code class="language-bash">export GOOGLE_API_KEY=YOUR_GOOGLE_API_KEY
opencode config set provider google</code></pre>
                            </div>

                            <div class="callout callout-info mt-4">
                                <span class="callout-icon">‚ö°</span>
                                <strong>Multi-Model Flexibility:</strong> OpenCode stores API keys in <code>~/.opencode/config</code> (persists via Docker volume). You can switch providers anytime without re-authentication using <code>opencode config set provider &lt;name&gt;</code>.
                            </div>

                            <h4 class="font-semibold mb-3 mt-6">Verify Configuration</h4>
                            <div class="code-block">
                                <button class="copy-btn" onclick="copyCode(this)" aria-label="Copy code">Copy</button>
                                <pre><code class="language-bash">opencode config list
opencode --version</code></pre>
                            </div>
                        </div>
                    </details>
                </div>

                <!-- Security Note -->
                <div class="callout callout-error mt-8">
                    <span class="callout-icon">üîí</span>
                    <strong>Security Note:</strong>
                    <ul>
                        <li>All credentials persist in <code>/home/node/.config/</code> directories mounted as Docker volumes</li>
                        <li>Volumes survive container rebuilds but are deleted if you remove the container completely</li>
                        <li>Never commit <code>.config/</code> directories or API keys to git repositories</li>
                        <li>Use <code>.gitignore</code> to exclude sensitive configuration files</li>
                        <li>For team environments, use environment variables or secret management tools</li>
                    </ul>
                </div>

                <!-- Best Practices -->
                <div class="callout callout-primary mt-6">
                    <span class="callout-icon">‚ú®</span>
                    <strong>Best Practices:</strong>
                    <ul>
                        <li><strong>Prefer API keys for Gemini:</strong> More reliable than OAuth in containerized environments</li>
                        <li><strong>Verify authentication after rebuilds:</strong> Quick test with each CLI ensures credentials persisted correctly</li>
                        <li><strong>Document required credentials:</strong> Update your project README with authentication requirements</li>
                        <li><strong>Use named volumes:</strong> Explicitly name your config volumes in <code>devcontainer.json</code> for easier management</li>
                        <li><strong>Backup important configurations:</strong> Export API keys to secure password manager before major container changes</li>
                    </ul>
                </div>
            </div>
        </section>

        <!-- GitHub CLI Authentication -->
        <section id="github-cli-auth" class="section">
            <div class="container">
                <h2 class="section-title">üîë GitHub CLI Authentication</h2>
                <p class="text-lg mb-6">The GitHub CLI (<code>gh</code>) is pre-installed for creating pull requests and managing repositories. One-time authentication setup is required and persists across container rebuilds.</p>

                <div class="callout callout-info mb-8">
                    <span class="callout-icon">üí°</span>
                    <strong>Why GitHub CLI Matters:</strong>
                    <ul>
                        <li>Create pull requests: <code>gh pr create</code></li>
                        <li>Required for git-pr-helper skill workflows</li>
                        <li>Integrates with CLAUDE.md Git Safety Protocol</li>
                    </ul>
                </div>

                <details class="details-card" open>
                    <summary class="details-summary">
                        <span class="details-icon">üöÄ</span>
                        <span class="details-title">Quick Setup Guide</span>
                    </summary>
                    <div class="details-content">
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyCode(this)" aria-label="Copy code">Copy</button>
                            <pre><code>gh auth login</code></pre>
                        </div>

                        <h4 class="font-semibold mt-4 mb-2">Follow the prompts:</h4>
                        <ol class="list-decimal list-inside space-y-1 ml-4">
                            <li>Choose GitHub.com</li>
                            <li>Select HTTPS protocol</li>
                            <li>Authenticate Git credentials: Yes</li>
                            <li>Choose "Login with a web browser"</li>
                            <li>Copy the one-time code and press Enter</li>
                            <li>Authorize in your browser</li>
                        </ol>

                        <div class="callout callout-success mt-6">
                            <span class="callout-icon">‚úÖ</span>
                            <strong>One-Time Setup:</strong> Authentication is stored in <code>/home/node/.config/gh</code> and backed by a Docker volume. It persists across container rebuilds and only needs to be done once per devcontainer volume.
                        </div>

                        <h4 class="font-semibold mt-6 mb-2">Verify Setup:</h4>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyCode(this)" aria-label="Copy code">Copy</button>
                            <pre><code>gh auth status</code></pre>
                        </div>
                        <p class="text-sm text-muted mt-2">Should show: ‚úì Logged in to github.com as your-username</p>
                    </div>
                </details>
            </div>
        </section>

        <!-- Troubleshooting Section -->
        <section id="troubleshooting" class="section">
            <div class="container">
                <h2 class="section-title">üîß Troubleshooting</h2>
                <p class="text-lg mb-8">Common issues and their solutions when working with DevContainers.</p>

                <div class="space-y-6">
                    <!-- Docker Daemon Error -->
                    <div class="callout callout-error">
                        <span class="callout-icon">‚ùå</span>
                        <div>
                            <strong>Error: "Cannot connect to Docker daemon"</strong>
                            <p class="mt-2"><strong>Cause:</strong> Docker Desktop isn't running.</p>
                            <p class="mt-2"><strong>Solution:</strong></p>
                            <ol class="list-decimal list-inside mt-2 space-y-1">
                                <li>Start Docker Desktop from your Applications folder</li>
                                <li>Wait for the whale icon in your menu bar/system tray to show it's running</li>
                                <li>Retry in VS Code: Cmd+Shift+P ‚Üí "Dev Containers: Rebuild Container"</li>
                            </ol>
                        </div>
                    </div>

                    <!-- Command Not Found -->
                    <div class="callout callout-warning">
                        <span class="callout-icon">‚ùå</span>
                        <div>
                            <strong>Error: "Command not found" (npm, python, etc.)</strong>
                            <p class="mt-2"><strong>Cause:</strong> Tool not installed in the container, or PATH not set correctly.</p>
                            <p class="mt-2"><strong>Solution:</strong></p>
                            <ol class="list-decimal list-inside mt-2 space-y-1">
                                <li>Check your Dockerfile has the correct base image (e.g., <code>FROM node:22</code>)</li>
                                <li>Rebuild the container: Cmd+Shift+P ‚Üí "Dev Containers: Rebuild Container"</li>
                                <li>If still failing, check you're using the correct terminal (should say "Dev Container" in bottom-left)</li>
                            </ol>
                        </div>
                    </div>

                    <!-- Container Slow Performance -->
                    <div class="callout callout-warning">
                        <span class="callout-icon">‚ö†Ô∏è</span>
                        <div>
                            <strong>Container is very slow</strong>
                            <p class="mt-2"><strong>Cause:</strong> Docker performance issues, especially on Mac/Windows.</p>
                            <p class="mt-2"><strong>Solutions:</strong></p>
                            <ul class="list-disc list-inside mt-2 space-y-1">
                                <li><strong>Mac:</strong> Enable VirtioFS in Docker Desktop ‚Üí Settings ‚Üí Experimental Features</li>
                                <li><strong>Windows:</strong> Ensure project is in WSL2 filesystem, not /mnt/c/</li>
                                <li>Use named volumes for node_modules: <code>"source=node-modules,target=/workspace/node_modules,type=volume"</code></li>
                                <li>Create .dockerignore file to exclude node_modules, .git from build context</li>
                            </ul>
                        </div>
                    </div>

                    <!-- Port Already in Use -->
                    <div class="callout callout-info">
                        <span class="callout-icon">‚ÑπÔ∏è</span>
                        <div>
                            <strong>Port already in use</strong>
                            <p class="mt-2"><strong>Cause:</strong> Another process is using the port (e.g., 3000, 5000).</p>
                            <p class="mt-2"><strong>Solutions:</strong></p>
                            <ol class="list-decimal list-inside mt-2 space-y-1">
                                <li>Find what's using the port: <code>lsof -i :3000</code> (Mac/Linux) or <code>netstat -ano | findstr :3000</code> (Windows)</li>
                                <li>Kill the process or change your app's port</li>
                                <li>Update forwardPorts in devcontainer.json to match new port</li>
                            </ol>
                        </div>
                    </div>

                    <!-- Codex Landlock Error (CRITICAL) -->
                    <details class="details-card">
                        <summary class="details-summary">
                            <span class="details-icon">üî¥</span>
                            <span class="details-title">CRITICAL: Codex CLI Landlock Sandbox Error</span>
                        </summary>
                        <div class="details-content">
                            <div class="callout callout-error mb-4">
                                <span class="callout-icon">‚ùå</span>
                                <strong>Error Message:</strong>
                                <pre class="mt-2 bg-gray-900 text-red-400 p-3 rounded">thread 'main' panicked at linux-sandbox/src/linux_run_main.rs:30:9:
error running landlock: Sandbox(LandlockRestrict)</pre>
                            </div>

                            <p class="mb-4"><strong>Cause:</strong> Docker's LinuxKit kernel doesn't support Landlock (Linux security module). This is a known limitation of containerized environments.</p>

                            <p class="mb-2"><strong>Solution:</strong> Disable Codex sandboxing (safe in containers):</p>

                            <div class="code-block">
                                <button class="copy-btn" onclick="copyCode(this)" aria-label="Copy code">Copy</button>
                                <pre><code class="language-toml"># ~/.codex/config.toml
sandbox_mode = "danger-full-access"
approval_policy = "never"</code></pre>
                            </div>

                            <div class="callout callout-success mt-4">
                                <span class="callout-icon">‚úÖ</span>
                                <strong>Why This Is Safe:</strong>
                                <ul>
                                    <li>Docker container provides process isolation</li>
                                    <li>Network firewall restricts connections</li>
                                    <li>Non-root user execution (node)</li>
                                    <li>OpenAI's official recommendation for Docker</li>
                                </ul>
                            </div>

                            <p class="mt-4"><strong>Verify it works:</strong></p>
                            <div class="code-block">
                                <button class="copy-btn" onclick="copyCode(this)" aria-label="Copy code">Copy</button>
                                <pre><code class="language-bash">codex --version
codex exec "echo 'Hello from Codex'"</code></pre>
                            </div>

                            <div class="callout callout-info mt-4">
                                <span class="callout-icon">üìù</span>
                                <strong>Note:</strong> This repository's devcontainer automatically applies this fix via <code>init-codex-config.sh</code>. Configuration persists across container rebuilds.
                            </div>

                            <div class="callout callout-error mt-4">
                                <span class="callout-icon">‚ö†Ô∏è</span>
                                <strong>IMPORTANT: VSCode Extension Limitation</strong>
                                <p class="mt-2">The above configuration <strong>only works for Codex CLI</strong>, not the VSCode extension.</p>
                                <ul class="mt-2">
                                    <li>Extension ignores <code>sandbox_mode</code> in config.toml</li>
                                    <li>Only reads <code>model</code> and <code>model_reasoning_effort</code></li>
                                    <li>Always tries to use Landlock sandbox (fails in Docker)</li>
                                    <li>Tracked as <a href="https://github.com/openai/codex/issues/5041" target="_blank" class="underline">GitHub Issue #5041</a></li>
                                </ul>
                                <p class="mt-2"><strong>Workaround:</strong> Use <strong>Codex CLI</strong> instead of VSCode extension: <code>codex exec "your prompt here"</code></p>
                            </div>
                        </div>
                    </details>

                    <!-- OpenCode TUI Crashes (CRITICAL) -->
                    <details class="details-card">
                        <summary class="details-summary">
                            <span class="details-icon">üî¥</span>
                            <span class="details-title">CRITICAL: OpenCode TUI Crashes When Loading Models</span>
                        </summary>
                        <div class="details-content">
                            <div class="callout callout-error mb-4">
                                <span class="callout-icon">‚ùå</span>
                                <strong>Error Message:</strong>
                                <pre class="mt-2 bg-gray-900 text-red-400 p-3 rounded">TypeError: undefined is not an object (evaluating 'flat().length')
at &lt;anonymous&gt; (src/cli/cmd/tui/ui/dialog-select.tsx:49:49)</pre>
                            </div>

                            <p class="mb-4"><strong>Cause:</strong> OpenCode's auth.json contains provider configurations incompatible with AI SDK v5. The cloudflare-workers-ai provider doesn't support specification v2 required by SDK v5, and expired OAuth tokens (github-copilot) return undefined when queried, causing the dialog component to crash when attempting to flatten provider data.</p>

                            <p class="mb-2"><strong>Solution:</strong></p>

                            <h4 class="font-semibold mb-2">1. Backup current configuration</h4>
                            <div class="code-block">
                                <button class="copy-btn" onclick="copyCode(this)" aria-label="Copy code">Copy</button>
                                <pre><code class="language-bash">cp ~/.local/share/opencode/auth.json \
   ~/.local/share/opencode/auth.json.backup</code></pre>
                            </div>

                            <h4 class="font-semibold mb-2 mt-4">2. Remove incompatible providers from auth.json</h4>
                            <div class="code-block">
                                <button class="copy-btn" onclick="copyCode(this)" aria-label="Copy code">Copy</button>
                                <pre><code class="language-bash">nano ~/.local/share/opencode/auth.json</code></pre>
                            </div>
                            <p class="text-sm text-muted mt-2">Keep only: anthropic, openrouter, nvidia, openai, google</p>

                            <h4 class="font-semibold mb-2 mt-4">3. Clear stale cache</h4>
                            <div class="code-block">
                                <button class="copy-btn" onclick="copyCode(this)" aria-label="Copy code">Copy</button>
                                <pre><code class="language-bash">rm -rf ~/.cache/opencode/*</code></pre>
                            </div>

                            <h4 class="font-semibold mb-2 mt-4">4. Verify operation</h4>
                            <div class="code-block">
                                <button class="copy-btn" onclick="copyCode(this)" aria-label="Copy code">Copy</button>
                                <pre><code class="language-bash">opencode models  # Should display 180+ models
opencode         # TUI should start without errors</code></pre>
                            </div>

                            <div class="callout callout-info mt-4">
                                <span class="callout-icon">üí°</span>
                                <strong>Why This Works:</strong>
                                <ul>
                                    <li>Removes provider entries that return undefined when queried</li>
                                    <li>Clears cached model metadata referencing removed providers</li>
                                    <li>Allows OpenCode to rebuild provider list from scratch</li>
                                </ul>
                            </div>

                            <div class="callout callout-success mt-4">
                                <span class="callout-icon">‚úÖ</span>
                                <strong>Compatible Providers:</strong>
                                <ul>
                                    <li>anthropic, openai, google (primary providers)</li>
                                    <li>openrouter, nvidia (third-party aggregators)</li>
                                </ul>
                            </div>

                            <div class="callout callout-error mt-4">
                                <span class="callout-icon">‚ùå</span>
                                <strong>Known Incompatible Providers:</strong>
                                <ul>
                                    <li>cloudflare-workers-ai (doesn't support AI SDK v5)</li>
                                    <li>requesty (similar SDK incompatibility - <a href="https://github.com/sst/opencode/issues/2468" target="_blank" class="underline">Issue #2468</a>)</li>
                                    <li>github-copilot (OAuth flow incompatible with devcontainers)</li>
                                </ul>
                            </div>

                            <div class="callout callout-warning mt-4">
                                <span class="callout-icon">üîß</span>
                                <strong>Prevention Tips:</strong>
                                <ul>
                                    <li>Only authenticate with actively maintained providers</li>
                                    <li>Periodically review auth.json and remove unused/expired providers</li>
                                    <li>Keep OpenCode updated: <code>npm update -g opencode-ai</code></li>
                                </ul>
                            </div>
                        </div>
                    </details>

                    <!-- Docker Build Permission Errors (CRITICAL) -->
                    <details class="details-card">
                        <summary class="details-summary">
                            <span class="details-icon">üî¥</span>
                            <span class="details-title">CRITICAL: Docker Build Permission Denied in .config Directory</span>
                        </summary>
                        <div class="details-content">
                            <div class="callout callout-error mb-4">
                                <span class="callout-icon">‚ùå</span>
                                <strong>Error Message:</strong>
                                <pre class="mt-2 bg-gray-900 text-red-400 p-3 rounded">mkdir: cannot create directory '/home/node/.config/fish': Permission denied
ERROR: command failed: mkdir -p /home/node/.config/fish</pre>
                            </div>

                            <p class="mb-4"><strong>Cause:</strong> Setting ownership on a subdirectory (like <code>.config/gh</code>) instead of the parent directory (<code>.config</code>) leaves the parent owned by root. When installers (uv, fish, zsh) try to create their own subdirectories, they fail due to permission errors.</p>

                            <p class="mb-2"><strong>Root Cause Explanation:</strong></p>
                            <ul class="list-disc list-inside mb-4">
                                <li><code>mkdir -p /home/node/.config/gh</code> creates both parent and subdirectory</li>
                                <li>Parent directory <code>.config</code> is owned by root</li>
                                <li><code>chown</code> on subdirectory only affects that subdirectory</li>
                                <li>Later installers cannot create new subdirectories in root-owned parent</li>
                            </ul>

                            <div class="callout callout-error mb-4">
                                <span class="callout-icon">‚ùå</span>
                                <strong>Incorrect (in Dockerfile):</strong>
                                <pre class="mt-2 bg-gray-900 text-gray-100 p-3 rounded">RUN mkdir -p /home/node/.config/gh /home/node/.claude && \
  chown -R node:node /home/node/.config/gh  # Only owns subdirectory!</pre>
                            </div>

                            <div class="callout callout-success mb-4">
                                <span class="callout-icon">‚úÖ</span>
                                <strong>Correct (in Dockerfile):</strong>
                                <pre class="mt-2 bg-gray-900 text-gray-100 p-3 rounded">RUN mkdir -p /home/node/.config/gh /home/node/.claude && \
  chown -R node:node /home/node/.config  # Owns entire .config tree!</pre>
                            </div>

                            <div class="callout callout-info mt-4">
                                <span class="callout-icon">üí°</span>
                                <strong>Pattern to remember:</strong>
                                <ul>
                                    <li>‚ùå <code>chown -R user /path/parent/child</code> (only owns child)</li>
                                    <li>‚úÖ <code>chown -R user /path/parent</code> (owns parent + all children)</li>
                                </ul>
                            </div>

                            <p class="mt-4"><strong>Verification commands:</strong></p>
                            <div class="code-block">
                                <button class="copy-btn" onclick="copyCode(this)" aria-label="Copy code">Copy</button>
                                <pre><code class="language-bash"># Check parent directory ownership
ls -ld /home/node/.config
# Should show: drwxr-xr-x node node

# Test creating new subdirectory as node user
su - node -c "mkdir -p /home/node/.config/test"
# Should succeed without permission errors</code></pre>
                            </div>

                            <div class="callout callout-warning mt-4">
                                <span class="callout-icon">‚ö†Ô∏è</span>
                                <strong>When you see this:</strong> Permission errors during RUN commands that create files in <code>~/.config</code>, installers like uv/fish/zsh failing, or build succeeding up to a point then failing on config directory creation.
                            </div>
                        </div>
                    </details>

                    <!-- Quick Debug Commands -->
                    <details class="details-card">
                        <summary class="details-summary">
                            <span class="details-icon">üõ†Ô∏è</span>
                            <span class="details-title">Quick Debug Commands</span>
                        </summary>
                        <div class="details-content">
                            <div class="code-block">
                                <button class="copy-btn" onclick="copyCode(this)" aria-label="Copy code">Copy</button>
                                <pre><code class="language-bash"># Check Docker is running
docker ps

# Check container logs
docker logs &lt;container-name&gt;

# View Docker disk usage
docker system df

# Clean up unused images/containers (frees space)
docker system prune -a

# Restart Docker Desktop
# Mac: Click whale icon ‚Üí Quit ‚Üí Relaunch
# Windows: Right-click whale icon ‚Üí Quit ‚Üí Relaunch</code></pre>
                            </div>
                        </div>
                    </details>
                </div>
            </div>
        </section>

        <!-- Resources Section -->
        <section id="resources" class="section section-alt">
            <div class="container">
                <h2 class="section-title">üìö Resources & Further Learning</h2>

                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div class="card">
                        <div class="card-header">
                            <span class="card-icon">üìñ</span>
                            <h3 class="card-title">Official Documentation</h3>
                        </div>
                        <div class="card-body">
                            <ul class="space-y-2">
                                <li><a href="https://claude-devcontainers.centminmod.com/llms.txt" target="_blank" rel="noopener noreferrer" class="link">Comprehensive Dev Containers Guide (llms.txt)</a></li>
                                <li><a href="https://docs.claude.com/en/docs/claude-code/devcontainer" target="_blank" rel="noopener noreferrer" class="link">Claude Code Dev Container Docs</a></li>
                                <li><a href="https://containers.dev/implementors/spec/" target="_blank" rel="noopener noreferrer" class="link">Dev Container Specification</a></li>
                                <li><a href="https://containers.dev/implementors/json_reference/" target="_blank" rel="noopener noreferrer" class="link">devcontainer.json Reference</a></li>
                            </ul>
                        </div>
                    </div>

                    <div class="card">
                        <div class="card-header">
                            <span class="card-icon">üîß</span>
                            <h3 class="card-title">Tools & Downloads</h3>
                        </div>
                        <div class="card-body">
                            <ul class="space-y-2">
                                <li><a href="https://code.visualstudio.com/" target="_blank" rel="noopener noreferrer" class="link">Visual Studio Code</a></li>
                                <li><a href="https://www.docker.com/products/docker-desktop/" target="_blank" rel="noopener noreferrer" class="link">Docker Desktop</a></li>
                                <li><a href="https://docs.docker.com/" target="_blank" rel="noopener noreferrer" class="link">Docker Documentation</a></li>
                                <li><a href="https://cli.github.com/" target="_blank" rel="noopener noreferrer" class="link">GitHub CLI</a></li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </section>

    </main>
      </div>  <!-- End flex container -->
    </div>  <!-- End max-w-7xl container -->

    <!-- Footer -->
    <footer class="footer">
        <p>Built with ‚ù§Ô∏è for developers using Claude Code and DevContainers</p>
        <p class="text-muted">Last updated: 2025-11-09</p>
        <p class="text-muted">
            <a href="https://github.com/centminmod/claude-code-devcontainer-guide" target="_blank">View on GitHub</a> |
            <a href="https://docs.anthropic.com/claude/docs" target="_blank">Claude Documentation</a> |
            <a href="https://code.visualstudio.com/docs/devcontainers/containers" target="_blank">DevContainers Docs</a>
        </p>
    </footer>

    <!-- Back to Top Button -->
    <button id="backToTop"
            aria-label="Back to top"
            style="position: fixed; bottom: 2rem; right: 2rem; width: 3rem; height: 3rem; border-radius: 9999px; background: linear-gradient(135deg, var(--color-primary), var(--color-accent)); color: white; border: none; cursor: pointer; opacity: 0; transform: translateY(100px); transition: opacity 0.3s ease, transform 0.3s ease; box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1); z-index: 1000; display: flex; align-items: center; justify-content: center; font-size: 1.5rem;">
        ‚Üë
    </button>


    <!-- JavaScript for Copy Buttons -->
    <script>
        // ====================================
        // DOM Element References
        // ====================================
        const mobileMenuToggle = document.getElementById('mobileMenuToggle');
        const tocSidebar = document.getElementById('tocSidebar');
        const tocOverlay = document.getElementById('tocOverlay');
        const tocLinks = document.querySelectorAll('.toc-link');
        const sections = document.querySelectorAll('section[id]');

        // ====================================
        // Mobile Menu Toggle
        // ====================================
        function closeMobileMenu() {
            if (mobileMenuToggle) {
                mobileMenuToggle.setAttribute('aria-expanded', 'false');
            }
            if (tocSidebar) {
                tocSidebar.classList.add('-translate-x-full');
            }
            if (tocOverlay) {
                tocOverlay.classList.add('opacity-0', 'pointer-events-none');
                tocOverlay.classList.remove('opacity-100', 'pointer-events-auto');
            }
        }

        function openMobileMenu() {
            if (mobileMenuToggle) {
                mobileMenuToggle.setAttribute('aria-expanded', 'true');
            }
            if (tocSidebar) {
                tocSidebar.classList.remove('-translate-x-full');
            }
            if (tocOverlay) {
                tocOverlay.classList.remove('opacity-0', 'pointer-events-none');
                tocOverlay.classList.add('opacity-100', 'pointer-events-auto');
            }
        }

        // Mobile menu toggle button click
        if (mobileMenuToggle) {
            mobileMenuToggle.addEventListener('click', () => {
                const isExpanded = mobileMenuToggle.getAttribute('aria-expanded') === 'true';
                if (isExpanded) {
                    closeMobileMenu();
                } else {
                    openMobileMenu();
                }
            });
        }

        // Close mobile menu when clicking overlay
        if (tocOverlay) {
            tocOverlay.addEventListener('click', closeMobileMenu);
        }

        // Handle TOC link clicks with manual scroll offset
        tocLinks.forEach(link => {
            link.addEventListener('click', (e) => {
                e.preventDefault(); // Prevent default anchor behavior

                // Get target section ID from href
                const targetId = link.getAttribute('href');
                if (!targetId || !targetId.startsWith('#')) return;

                const targetElement = document.querySelector(targetId);
                if (!targetElement) return;

                // Calculate header height dynamically
                const header = document.querySelector('.header');
                const headerHeight = header ? header.offsetHeight : 150;

                // Add breathing room (30px below header)
                const offset = headerHeight + 30;

                // Calculate target position
                const elementPosition = targetElement.getBoundingClientRect().top;
                const offsetPosition = elementPosition + window.pageYOffset - offset;

                // Smooth scroll to position
                window.scrollTo({
                    top: offsetPosition,
                    behavior: 'smooth'
                });

                // Close mobile menu after scroll starts
                if (window.innerWidth < 768) {
                    closeMobileMenu();
                }

                // Update URL hash without jumping
                history.pushState(null, null, targetId);
            });
        });

        // Handle direct anchor navigation on page load
        window.addEventListener('load', () => {
            if (window.location.hash) {
                // Small delay to ensure page is fully rendered
                setTimeout(() => {
                    const targetElement = document.querySelector(window.location.hash);
                    if (targetElement) {
                        const header = document.querySelector('.header');
                        const headerHeight = header ? header.offsetHeight : 150;
                        const offset = headerHeight + 30;
                        const elementPosition = targetElement.getBoundingClientRect().top;
                        const offsetPosition = elementPosition + window.pageYOffset - offset;

                        window.scrollTo({
                            top: offsetPosition,
                            behavior: 'smooth'
                        });
                    }
                }, 100);
            }
        });

        // Close mobile menu on Escape key
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape') {
                closeMobileMenu();
            }
        });

        // ====================================
        // Code Copy Functionality with Fallback
        // ====================================

        // Textarea fallback for older browsers/restricted contexts
        function fallbackCopyTextToClipboard(text, button) {
            const textArea = document.createElement("textarea");
            textArea.value = text;
            textArea.style.position = "fixed"; // Avoid scrolling
            textArea.style.top = "0";
            textArea.style.left = "0";
            document.body.appendChild(textArea);
            textArea.focus();
            textArea.select();
            try {
                document.execCommand("copy");
                showCopiedState(button);
            } catch (err) {
                console.error("Fallback copy failed", err);
                button.textContent = 'Failed';
                setTimeout(() => {
                    button.textContent = 'Copy';
                }, 2000);
            }
            document.body.removeChild(textArea);
        }

        // Show copied state feedback
        function showCopiedState(button) {
            const originalText = button.textContent;
            button.textContent = "Copied!";
            button.style.backgroundColor = 'var(--color-success)';
            button.classList.add("copied");

            setTimeout(() => {
                button.textContent = originalText;
                button.style.backgroundColor = '';
                button.classList.remove("copied");
            }, 2000);
        }

        // Main copy function with try-catch and fallback
        function copyCode(button) {
            const codeBlock = button.closest('.code-block').querySelector('pre code');
            const text = codeBlock.textContent;

            // Try Clipboard API with fallback
            try {
                navigator.clipboard
                    .writeText(text)
                    .then(() => {
                        showCopiedState(button);
                    })
                    .catch(() => {
                        fallbackCopyTextToClipboard(text, button);
                    });
            } catch (err) {
                fallbackCopyTextToClipboard(text, button);
            }
        }

        // ====================================
        // Smooth Scroll - Using Native CSS
        // ====================================
        // Removed JavaScript smooth scroll in favor of native CSS scroll-behavior
        // CSS handles this via: html { scroll-behavior: smooth; scroll-padding-top: 12rem; }

        // ====================================
        // Scrollspy - Highlight Active Section
        // ====================================
        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    const id = entry.target.getAttribute('id');

                    // Remove active state from all TOC links
                    tocLinks.forEach(link => {
                        link.classList.remove('bg-indigo-100', 'dark:bg-indigo-900', 'text-indigo-900', 'dark:text-indigo-100', 'font-semibold');
                    });

                    // Add active state to current section link
                    const activeLink = document.querySelector(`.toc-link[href="#${id}"]`);
                    if (activeLink) {
                        activeLink.classList.add('bg-indigo-100', 'dark:bg-indigo-900', 'text-indigo-900', 'dark:text-indigo-100', 'font-semibold');
                    }
                }
            });
        }, {
            rootMargin: '-20% 0px -70% 0px',
            threshold: 0
        });

        // Observe all sections
        sections.forEach(section => {
            observer.observe(section);
        });

        // ====================================
        // Scroll Progress Bar
        // ====================================
        function updateScrollProgress() {
            const scrollProgress = document.getElementById('scrollProgress');
            const scrollTop = window.pageYOffset || document.documentElement.scrollTop;
            const scrollHeight = document.documentElement.scrollHeight - document.documentElement.clientHeight;
            const scrollPercent = (scrollTop / scrollHeight) * 100;
            scrollProgress.style.width = scrollPercent + '%';
        }

        window.addEventListener('scroll', updateScrollProgress);
        // Initialize on page load
        updateScrollProgress();

        // ====================================
        // Back to Top Button
        // ====================================
        const backToTopButton = document.getElementById('backToTop');

        function toggleBackToTop() {
            const scrollTop = window.pageYOffset || document.documentElement.scrollTop;

            if (scrollTop > 300) {
                backToTopButton.style.opacity = '1';
                backToTopButton.style.transform = 'translateY(0)';
            } else {
                backToTopButton.style.opacity = '0';
                backToTopButton.style.transform = 'translateY(100px)';
            }
        }

        // Show/hide button on scroll
        window.addEventListener('scroll', toggleBackToTop);

        // Scroll to top on click
        backToTopButton.addEventListener('click', () => {
            window.scrollTo({
                top: 0,
                behavior: 'smooth'
            });
        });

        // Initialize on page load
        toggleBackToTop();

    </script>
</body>
</html>